# –ë—Ä–∏—Ñ–∏–Ω–≥ –º–∏—Å—Å–∏–∏: –ü—Ä–æ—Ü–µ—Å—Å—ã & –î–µ–º–æ–Ω—ã
## Episode 25 ‚Äî –í–æ–π–Ω–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–º —É—Ä–æ–≤–Ω–µ

---

## üéØ –¶–µ–ª—å –º–∏—Å—Å–∏–∏

**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø:** –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –≤—Ä–∞–∂–µ—Å–∫–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ (PIDs 3012, 3156).  
**–ú–ò–°–°–ò–Ø:** –°–æ–∑–¥–∞—Ç—å counter-surveillance daemon, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—Ä–∞–≥–∞, —Å–æ–±—Ä–∞—Ç—å intelligence.  
**–î–ï–î–õ–ê–ô–ù:** 6-12 —á–∞—Å–æ–≤ –¥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è  
**–°–¢–ê–¢–£–°:** Season 7 –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è ‚Äî –≤–æ–π–Ω–∞ –≤ —Ç–µ–Ω—è—Ö

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –º–∏—Å—Å–∏–∏

### 1. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–∞–∂–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (./tracker, surveillance_d)
- ‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (fork, exec, orphans)
- ‚úÖ –ü–æ–Ω—è—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É daemon
- ‚úÖ –û—Ç—Å–ª–µ–¥–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ C2 —Å–µ—Ä–≤–µ—Ä—É

### 2. –°–æ–∑–¥–∞–Ω–∏–µ Daemon
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π UNIX daemon (double fork, setsid)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PID —Ñ–∞–π–ª–æ–º (/var/run/moonlight_monitor.pid)
- ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ (close stdin/stdout/stderr)
- ‚úÖ –§–æ–Ω–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (no controlling TTY)

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- ‚úÖ SIGTERM handler (graceful shutdown + cleanup)
- ‚úÖ SIGHUP handler (reload configuration)
- ‚úÖ SIGUSR1/SIGUSR2 (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ verbosity)
- ‚úÖ SIGCHLD handler (reap zombie processes)
- ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å SIGINT, SIGPIPE (robustness)

### 4. –°—Ç–µ–ª—Å-–æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω)
- ‚úÖ CPU usage < 0.5% (–∏–∑–±–µ–≥–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è)
- ‚úÖ –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –°–º–µ—à–∏–≤–∞–Ω–∏–µ —Å —Å–µ—Ç–µ–≤—ã–º —Ç—Ä–∞—Ñ–∏–∫–æ–º

### 5. –°–±–æ—Ä Intelligence
- ‚úÖ –ü–µ—Ä–µ—Ö–≤–∞—Ç —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (324+ –ø–∞–∫–µ—Ç–æ–≤)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤—Ä–∞–≥–∞ (system_processes.log)
- ‚úÖ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è C2 —Å–µ—Ä–≤–µ—Ä–∞ (185.220.101.42:8080)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ intelligence –æ—Ç—á—ë—Ç–∞

---

## üß™ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
```bash
# –°–æ–∑–¥–∞—Ç—å daemon
./moonlight_daemon start

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—â–µ–Ω –ª–∏ daemon
ps aux | grep moonlight_monitor

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞–ª—ã
kill -USR1 <PID>   # –£–≤–µ–ª–∏—á–∏—Ç—å verbosity
kill -HUP <PID>    # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å config
kill -TERM <PID>   # Graceful shutdown

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ zombie
ps aux | grep defunct
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–µ–ª—Å–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CPU usage (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å < 0.5%)
top -p <PID>

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
watch -n 10 'ps aux | grep <PID>'

# –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
tcpdump -i eth0 host 185.220.101.42
```

---

## üì¶ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏—Å—Å–∏–∏

### –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (3 —Ñ–∞–π–ª–∞, 785 —Å—Ç—Ä–æ–∫):
- ‚úÖ `system_processes.log` (281 —Å—Ç—Ä–æ–∫)
  - –ü–æ–ª–Ω—ã–π –ª–æ–≥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (14:00-17:30)
  - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—Ä–∞–∂–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (PID 3012, 3156)
  - –¢–∞–π–º–ª–∞–π–Ω —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è counter-daemon
  - –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—è Mexican standoff
  
- ‚úÖ `signal_traces.txt` (374 —Å—Ç—Ä–æ–∫–∏)
  - –ü–æ–ª–Ω—ã–µ —Ç—Ä–µ–π—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ (47 —Å–∏–≥–Ω–∞–ª–æ–≤)
  - –ü—Ä–∏–º–µ—Ä—ã SIGTERM, SIGHUP, SIGUSR1/2, SIGCHLD
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ race condition —Å —Å–∏–≥–Ω–∞–ª–∞–º–∏
  - SIGKILL –∞—Ç–∞–∫–∞ + –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
  - Best practices & –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã
  
- ‚úÖ `daemon_config.conf` (130 —Å—Ç—Ä–æ–∫)
  - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è daemon
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–ª–µ–π
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã stealth mode
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è logging, alerting, watchdog

### –ö–æ–¥:
- ‚úÖ `solution/processes_daemons.c` (440 —Å—Ç—Ä–æ–∫)
- ‚úÖ `starter.c` (105 —Å—Ç—Ä–æ–∫)
- ‚úÖ `solution/Makefile` + –∫–æ—Ä–Ω–µ–≤–æ–π `Makefile`

---

## üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

- [x] –í—Ä–∞–∂–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- [x] Counter-daemon —Å–æ–∑–¥–∞–Ω (PID 3789)
- [x] Stealth mode —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω –≤—Ä–∞–≥–æ–º)
- [x] Intelligence —Å–æ–±—Ä–∞–Ω (324 –ø–∞–∫–µ—Ç–∞, C2 –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω)
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞–¥—ë–∂–Ω–∞ (47 —Å–∏–≥–Ω–∞–ª–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ)
- [x] Zombie –ø—Ä–æ—Ü–µ—Å—Å—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω—ã (SIGCHLD handler)
- [x] –í—ã–∏–≥—Ä–∞–Ω–æ 6-12 —á–∞—Å–æ–≤ –¥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

---

## ‚ö†Ô∏è –°—Ç–∞—Ç—É—Å –º–∏—Å—Å–∏–∏

**–í–´–ü–û–õ–ù–ï–ù–ê** ‚úÖ

Counter-surveillance daemon —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç. –í—Ä–∞–≥ –ø–æ–¥ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ–º, –Ω–æ –Ω–µ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω.  
–í—Ä–µ–º–µ–Ω–∏ –¥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è: 6-12 —á–∞—Å–æ–≤.

**–°–†–û–ß–ù–û:** –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ Episode 26.  
–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ (threads, producer-consumer).

---

**–°–ª–µ–¥—É—é—â–∞—è –º–∏—Å—Å–∏—è:** [Episode 26: Threads & Parallelism ‚Üí](../episode-26-threads-parallelism/)

---

*MOONLIGHT Protocol: –ü—Ä–∏–∑—Ä–∞–∫ –≤ –º–∞—à–∏–Ω–µ. –ù–µ–≤–∏–¥–∏–º—ã–π. –ù–µ—Å–ª—ã—à–∏–º—ã–π. –ù–µ–æ—Å—Ç–∞–Ω–æ–≤–∏–º—ã–π.* üîß
