# MOONLIGHT MONITOR DAEMON CONFIGURATION
# Episode 25: Processes & Daemons
# Purpose: Counter-surveillance daemon to monitor enemy process
# Location: /etc/moonlight/monitor.conf
# Date: December 24, 2024

[general]
# Daemon identification
name = moonlight_monitor
version = 1.0.0
description = Counter-surveillance daemon for Operation MOONLIGHT

# Process settings
pid_file = /var/run/moonlight_monitor.pid
working_directory = /
umask = 0027

[target]
# Enemy process to monitor (from Season 6 Episode 24)
target_pid = 3156
target_name = surveillance_d
target_description = Competitor surveillance daemon
priority = CRITICAL

# Monitoring parameters
monitor_interval = 60          # Check every 60 seconds
network_capture = enabled      # Capture network traffic
process_tree = enabled         # Monitor child processes
resource_usage = enabled       # Track CPU/memory usage

[logging]
# Log configuration
log_level = 3                  # 0=OFF, 1=ERROR, 2=WARN, 3=INFO, 4=DEBUG, 5=TRACE
log_file = /var/log/moonlight/monitor.log
log_max_size = 104857600       # 100MB
log_rotation = enabled
log_keep_count = 5             # Keep 5 old logs

# Syslog integration
syslog_enabled = yes
syslog_facility = daemon
syslog_identity = moonlight_monitor

[stealth]
# Stealth operation mode
stealth_mode = enabled
process_name_randomize = yes   # Change process name every 5 minutes
cpu_limit = 0.5                # Max 0.5% CPU usage
network_mimic = system         # Mimic system process traffic patterns
hide_from_ps = no              # Don't hide (too suspicious)

# Process name rotation
process_names = [kworker/0:1], [ksoftirqd/0], [migration/0], [systemd-journal]
rotation_interval = 300        # 5 minutes

[network]
# Network monitoring
capture_interface = eth0
capture_filter = host 185.220.101.42  # C2 server from logs
capture_snaplen = 1500
capture_timeout = 1000

# Packet analysis
protocol_analysis = enabled
dns_lookups = disabled         # Avoid detection
packet_storage = /var/lib/moonlight/packets

[resources]
# Resource limits (prevent detection via high resource usage)
max_cpu_percent = 0.5
max_memory_mb = 50
max_file_descriptors = 64
max_threads = 2

[security]
# Security settings
drop_privileges = no           # Need root for packet capture
chroot = no                    # Need full system access

# Signal handling
handle_sigterm = yes           # Graceful shutdown
handle_sighup = yes            # Reload config
handle_sigusr1 = yes           # Increase verbosity
handle_sigusr2 = yes           # Decrease verbosity
ignore_sigint = yes            # Don't terminate on Ctrl+C
ignore_sigpipe = yes           # Don't die on broken pipe

[watchdog]
# Watchdog timer (auto-restart if killed)
enabled = yes
timeout = 300                  # 5 minutes
supervisor_pid = 4377          # Supervisor process

[alerts]
# Alert conditions
alert_on_target_exit = yes
alert_on_new_connections = yes
alert_on_data_exfiltration = yes
alert_on_anomaly = yes

# Alert methods
alert_log = yes
alert_syslog = yes
alert_file = /var/lib/moonlight/alerts.txt

[intelligence]
# Intelligence gathering
gather_network_data = yes
gather_process_data = yes
gather_file_activity = yes
gather_system_calls = no       # Too noisy

# Data storage
intelligence_dir = /var/lib/moonlight/intel
max_storage_mb = 500
auto_cleanup = yes
cleanup_age_days = 7

[periodic_tasks]
# Tasks to run periodically (triggered by SIGALRM)
check_target_alive = yes
capture_packets = yes
log_statistics = yes
rotate_process_name = yes
check_disk_space = yes
update_intelligence = yes

# Task interval (seconds)
task_interval = 60

[emergency]
# Emergency actions
kill_target_on_discovery = no  # Too risky, they'll know
hide_on_detection = yes
self_destruct = no             # Preserve evidence
alert_operator = yes

[compatibility]
# System compatibility
os_type = linux
kernel_minimum = 3.10.0
required_capabilities = CAP_NET_RAW, CAP_NET_ADMIN

[metadata]
# Deployment metadata
created_by = Agent [YOUR_CALLSIGN]
created_date = 2024-12-24
mission = Operation MOONLIGHT Season 7
episode = 25
purpose = Monitor enemy surveillance daemon
threat_level = HIGH
authorization = V. (encrypted authorization code: 7A3F9B2E)

# End of configuration

