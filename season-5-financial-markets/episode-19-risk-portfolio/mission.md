# ĞœĞ¸ÑÑĞ¸Ñ 19: Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ€Ğ¸ÑĞºĞ°Ğ¼Ğ¸ Ğ¸ Ğ¿Ğ¾Ñ€Ñ‚Ñ„ĞµĞ»ĞµĞ¼

## ğŸ¯ Ğ¦ĞµĞ»ÑŒ

ĞŸÑ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€Ğ¸ÑĞº Ğ¿Ğ¾Ñ€Ñ‚Ñ„ĞµĞ»Ñ $50M. Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Value at Risk (VaR), Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ correlation matrix Ğ¸ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ñ€Ñ‚Ñ„ĞµĞ»ÑŒ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ Ñ‚ĞµĞ¾Ñ€Ğ¸Ñ ĞœĞ°Ñ€ĞºĞ¾Ğ²Ğ¸Ñ†Ğ°.

## ğŸ“‹ Ğ‘Ñ€Ğ¸Ñ„Ğ¸Ğ½Ğ³ Ğ¼Ğ¸ÑÑĞ¸Ğ¸

**Ğ”Ğ°Ñ‚Ğ°:** 19 Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ, 18:45 GMT  
**Ğ›Ğ¾ĞºĞ°Ñ†Ğ¸Ñ:** City of London, Ğ›Ğ¾Ğ½Ğ´Ğ¾Ğ½ (51.5074Â°N, 0.1278Â°W)  
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** ğŸ”´ğŸ”´ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ

ĞŸĞ¾Ñ€Ñ‚Ñ„ĞµĞ»ÑŒ Ğ¾Ñ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ ($50M) Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ¿Ğ¾Ğ´ ÑĞºÑÑ‚Ñ€ĞµĞ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ñ€Ğ¸ÑĞºĞ¾Ğ¼:
- 70% Ğ² ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ²Ğ°Ğ»ÑÑ‚Ğ°Ñ… (Ğ²Ñ‹ÑĞ¾ĞºĞ°Ñ Ğ²Ğ¾Ğ»Ğ°Ñ‚Ğ¸Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ)
- Leverage 3:1 (ÑƒÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ğ°Ñ ÑĞºÑĞ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ = $150M)
- ĞšĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ñ 0.95 (Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ´Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸!)

V. Ğ½ÑƒĞ¶ĞµĞ½ Ğ¿Ñ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ñ€Ğ¸ÑĞºĞ¾Ğ² ĞĞ•ĞœĞ•Ğ”Ğ›Ğ•ĞĞĞ.

**Ğ’Ğ°ÑˆĞ° Ğ¼Ğ¸ÑÑĞ¸Ñ:**
1. Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Value at Risk (VaR) Ñ‚Ñ€ĞµĞ¼Ñ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ°Ğ¼Ğ¸
2. ĞŸĞ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ correlation matrix
3. Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Sharpe Ğ¸ Sortino ratios
4. ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ñ€Ñ‚Ñ„ĞµĞ»Ñ (Markowitz)
5. Stress testing (ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸ 2008, 2020, Flash Crash)

**Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚:** Ğ”Ğ¾ 23:30 GMT (4 Ñ‡Ğ°ÑĞ° 45 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

## ğŸ“‚ ĞŸÑ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹

- `artifacts/portfolio_holdings.csv` â€” Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ ($50M)
- `artifacts/historical_returns.csv` â€” 2 Ğ³Ğ¾Ğ´Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸
- `artifacts/stress_scenarios.txt` â€” ĞšÑ€Ğ¸Ğ·Ğ¸ÑĞ½Ñ‹Ğµ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸
- `artifacts/correlation_matrix.dat` â€” ĞŸÑ€ĞµĞ´Ñ€Ğ°ÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¸

## âœ… ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸ ÑƒÑĞ¿ĞµÑ…Ğ°

Ğ’Ğ°ÑˆĞ° Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ°:
- Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ VaR (Historical, Parametric, Monte Carlo)
- Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Sharpe ratio Ğ¸ Sortino ratio
- ĞŸÑ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ correlation matrix
- ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ€Ñ‚Ñ„ĞµĞ»ÑŒ ÑĞ½Ğ¸Ğ¶Ğ°ĞµÑ‚ VaR Ğ½Ğ° >60%
- Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ stress test Ğ¿Ğ¾ 3 ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ÑĞ¼

## ğŸ’¡ ĞŸĞ¾Ğ´ÑĞºĞ°Ğ·ĞºĞ¸

**VaR (Value at Risk) Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹:**

**1. Historical VaR:**
```c
// Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ returns Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ°Ğ½Ğ¸Ñ
qsort(returns, n, sizeof(double), compare);

// VaR(95%) = 5-Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ¸Ğ»ÑŒ
int index = (int)((1.0 - 0.95) * n);
double var_95 = -returns[index];
```

**2. Parametric VaR (Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ):**
```c
double mean = calculate_mean(returns, n);
double std_dev = calculate_std_dev(returns, n);

// VaR(95%) = mean - 1.645 * std_dev (one-tailed)
double var_95 = -(mean - 1.645 * std_dev);
```

**3. Monte Carlo VaR:**
```c
// Ğ¡Ğ¸Ğ¼ÑƒĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ 10,000 ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ĞµĞ²
for (int i = 0; i < 10000; i++) {
    double sim_return = mean + std_dev * random_normal();
    simulated_returns[i] = sim_return;
}
// Ğ—Ğ°Ñ‚ĞµĞ¼ Historical VaR Ğ½Ğ° ÑĞ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸ÑÑ…
```

**Sharpe Ratio:**
```c
// Annualized Sharpe Ratio
double annual_return = mean_return * 252;  // 252 Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ñ‹Ñ… Ğ´Ğ½Ñ
double annual_vol = std_dev * sqrt(252);
double sharpe = (annual_return - risk_free_rate) / annual_vol;
```

**Sortino Ratio** (ÑƒÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ downside volatility):
```c
// Ğ¡Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ negative returns Ğ´Ğ»Ñ downside deviation
double downside_dev = calculate_downside_deviation(returns, n);
double sortino = (annual_return - risk_free_rate) / downside_dev;
```

**Correlation Matrix:**
```c
double correlation(double *x, double *y, int n) {
    double cov = covariance(x, y, n);
    double std_x = std_dev(x, n);
    double std_y = std_dev(y, n);
    return cov / (std_x * std_y);
}
```

**Portfolio Optimization (ÑƒĞ¿Ñ€Ğ¾Ñ‰Ñ‘Ğ½Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ):**
```
Ğ¦ĞµĞ»ÑŒ: ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€Ğ¸ÑĞº Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸
ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ:
â€¢ sum(weights) = 1.0
â€¢ weights >= 0 (no short selling)
â€¢ portfolio_return >= target_return
```

**Stress Test ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸:**
- **2008 Crisis:** -37% Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ Ñ€Ñ‹Ğ½ĞºĞ°
- **2020 COVID:** -34% Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ Ğ·Ğ° Ğ¼ĞµÑÑÑ†
- **Flash Crash 2010:** -9% Ğ·Ğ° Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹

## ğŸ” ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğ¹ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  PORTFOLIO RISK ANALYSIS                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Portfolio Value: $50,000,000                         â•‘
â•‘  Leverage: 3:1 ($150M exposure)                       â•‘
â•‘                                                       â•‘
â•‘  VALUE AT RISK (95%, 1 day):                          â•‘
â•‘  â€¢ Historical VaR:  $14.7M (29.4%)                    â•‘
â•‘  â€¢ Parametric VaR:  $16.2M (32.4%)                    â•‘
â•‘  â€¢ Monte Carlo VaR: $15.8M (31.6%)                    â•‘
â•‘  â€¢ Average VaR:     $15.6M (31.2%) âš ï¸ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ!      â•‘
â•‘                                                       â•‘
â•‘  RISK METRICS:                                        â•‘
â•‘  â€¢ Sharpe Ratio:    0.87 (Ğ½Ğ¸Ğ¶Ğµ 1 â€” Ğ¿Ğ»Ğ¾Ñ…Ğ¾)            â•‘
â•‘  â€¢ Sortino Ratio:   1.12 (Ğ¿Ñ€Ğ¸ĞµĞ¼Ğ»ĞµĞ¼Ğ¾)                 â•‘
â•‘  â€¢ Max Drawdown:    -38% (ĞºĞ°Ñ‚Ğ°ÑÑ‚Ñ€Ğ¾Ñ„Ğ¸Ñ‡Ğ½Ğ¾)             â•‘
â•‘  â€¢ Avg Correlation: 0.94 (Ğ½ĞµÑ‚ Ğ´Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸)        â•‘
â•‘                                                       â•‘
â•‘  STRESS TEST:                                         â•‘
â•‘  â€¢ 2008 Scenario:   -$42M (-84%) ğŸ’€                  â•‘
â•‘  â€¢ 2020 COVID:      -$28M (-56%) ğŸ’€                  â•‘
â•‘  â€¢ Flash Crash:     -$19M (-38%) ğŸ’€                  â•‘
â•‘                                                       â•‘
â•‘  âœ… OPTIMIZED PORTFOLIO (Markowitz):                  â•‘
â•‘  â€¢ VaR(95%):        $4.2M (8.4%) â€” ÑĞ½Ğ¸Ğ¶ĞµĞ½ Ğ² 3.7x!    â•‘
â•‘  â€¢ Sharpe Ratio:    1.95 (Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾)                   â•‘
â•‘  â€¢ Max Drawdown:    -12% (Ğ¿Ñ€Ğ¸ĞµĞ¼Ğ»ĞµĞ¼Ğ¾)                 â•‘
â•‘  â€¢ Diversification: 15 Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¾Ğ², correlation avg 0.35 â•‘
â•‘                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## ğŸ† Ğ”Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ

**"Risk Master"** â€” Ğ¡Ğ¿Ğ°ÑĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ñ€Ñ‚Ñ„ĞµĞ»Ñ $50M Ğ¾Ñ‚ ĞºĞ°Ñ‚Ğ°ÑÑ‚Ñ€Ğ¾Ñ„Ñ‹ VaR $15.6M

---

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑĞ¿Ğ¸Ğ·Ğ¾Ğ´:** [Episode 20: Crypto & DeFi â€” FINALE](../episode-20-crypto-defi/)