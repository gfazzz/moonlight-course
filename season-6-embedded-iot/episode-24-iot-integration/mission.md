# ĞœĞ¸ÑÑĞ¸Ñ 24: IoT Integration & System Bypass â€” SEASON 6 FINALE

## ğŸ¯ Ğ¦ĞµĞ»ÑŒ

**Ğ¤Ğ˜ĞĞĞ›Ğ¬ĞĞĞ¯ ĞĞŸĞ•Ğ ĞĞ¦Ğ˜Ğ¯:** Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²ÑĞµ IoT ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ ĞĞ˜Ğ˜ Ñ‡ĞµÑ€ĞµĞ· MQTT Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ ĞµĞ´Ğ¸Ğ½Ğ¾Ğ³Ğ¾ backdoor. ĞĞ±Ğ¾Ğ¹Ñ‚Ğ¸ Ğ¾Ñ…Ñ€Ğ°Ğ½Ñƒ, Ğ¿Ñ€Ğ¾Ğ½Ğ¸ĞºĞ½ÑƒÑ‚ÑŒ Ğ² ÑĞµÑ€Ğ²ĞµÑ€Ğ½ÑƒÑ, ÑĞ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ´Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ° Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ¾Ğ².

## ğŸ“‹ Ğ‘Ñ€Ğ¸Ñ„Ğ¸Ğ½Ğ³ Ğ¼Ğ¸ÑÑĞ¸Ğ¸

**Ğ”Ğ°Ñ‚Ğ°:** 23 Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ, 00:00 MSK (Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ‡ÑŒ)  
**Ğ›Ğ¾ĞºĞ°Ñ†Ğ¸Ñ:** Novosibirsk Akademgorodok, ĞĞ˜Ğ˜ "ĞšĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹"  
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** â˜…â˜…â˜… Ğ¤Ğ˜ĞĞĞ›Ğ¬ĞĞĞ¯ ĞœĞ˜Ğ¡Ğ¡Ğ˜Ğ¯ â˜…â˜…â˜…

ĞŸĞ¾ÑĞ»Ğµ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¡ĞšĞ£Ğ” (Ep22) Ğ¸ ĞºĞ°Ğ¼ĞµÑ€ (Ep23) Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¾:
- **3 Ñ„Ğ¸Ğ³ÑƒÑ€Ñ‹** Ğ² Lab 201 (ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ñ‹)
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ Ñ‚Ğµ Ğ¶Ğµ **blind spots**, Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ Ğ½Ğ°ÑˆĞ»Ğ¸
- **Ghost mode** Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ¸Ğ¼Ğ¸: CAM-006 disabled, Ğ´Ğ°Ñ‚Ñ‡Ğ¸ĞºĞ¸ Ğ¿Ğ¾Ğ´Ğ°Ğ²Ğ»ĞµĞ½Ñ‹

Dmitry Orlov Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ» **MQTT broker** â€” Ñ†ĞµĞ½Ñ‚Ñ€ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ²ÑĞµĞ¼Ğ¸ IoT ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ğ¼Ğ¸ ĞĞ˜Ğ˜. Ğ’Ğ°ÑˆĞ° Ğ¼Ğ¸ÑÑĞ¸Ñ â€” Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ, ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ backdoor, Ğ¸ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ Lab 201 Ñ Ğ²Ñ€Ğ°Ğ³Ğ°Ğ¼Ğ¸ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸!

**Ğ’Ğ°ÑˆĞ° Ğ¼Ğ¸ÑÑĞ¸Ñ:**
1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ MQTT client Ğ´Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ²ÑĞµÑ… IoT ÑĞ¸ÑÑ‚ĞµĞ¼
2. Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ IoT bridge (Ğ¡ĞšĞ£Ğ” + ĞºĞ°Ğ¼ĞµÑ€Ñ‹ + Ğ´Ğ°Ñ‚Ñ‡Ğ¸ĞºĞ¸ â†’ MQTT)
3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ security dashboard Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°
4. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ: Ğ¿Ğ¾Ğ¹Ğ¼Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² Ğ»Ğ¾Ğ²ÑƒÑˆĞºÑƒ

**Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚:** Ğ”Ğ¾ 01:00 MSK (1 Ñ‡Ğ°Ñ â€” Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑˆÑ‚ÑƒÑ€Ğ¼!)

---

## ğŸ“‚ ĞŸÑ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹

- `artifacts/mqtt_broker_config.conf` â€” ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ MQTT broker
- `artifacts/device_registry.json` â€” 47 IoT ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ² ĞĞ˜Ğ˜
- `artifacts/event_log.csv` â€” Ğ›Ğ¾Ğ³Ğ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ Ğ·Ğ° Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 7 Ğ´Ğ½ĞµĞ¹

---

## âœ… ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸ ÑƒÑĞ¿ĞµÑ…Ğ°

### 1. MQTT Client (â­â­â­â˜†â˜†)

Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ MQTT ĞºĞ»Ğ¸ĞµĞ½Ñ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ libmosquitto:

```c
#include <mosquitto.h>

typedef struct {
    struct mosquitto *mosq;
    char client_id[64];
    bool connected;
} MQTTClient;

// Callback Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸
void on_connect(struct mosquitto *mosq, void *obj, int rc);

// Callback Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
void on_message(struct mosquitto *mosq, void *obj, 
                const struct mosquitto_message *msg);

// Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°
MQTTClient* mqtt_client_init(const char *broker, int port);

// ĞŸÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
int mqtt_publish(MQTTClient *client, const char *topic, const char *payload);

// ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° Ñ‚Ğ¾Ğ¿Ğ¸ĞºĞ¸
int mqtt_subscribe(MQTTClient *client, const char *topic_pattern);
```

**Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº broker (localhost:1883 or mosquitto.local)
- QoS 0, 1, 2 support
- Persistent session
- Last Will and Testament (Ğ´Ğ»Ñ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ disconnects)

**MQTT Topics ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°:**
```
moonlight/
â”œâ”€â”€ access/
â”‚   â”œâ”€â”€ door/lab201       # {"event": "unlock", "card_id": 12345}
â”‚   â””â”€â”€ door/main
â”œâ”€â”€ camera/
â”‚   â”œâ”€â”€ cam006/motion     # {"detected": true, "confidence": 0.81}
â”‚   â”œâ”€â”€ cam006/status     # {"online": true, "fps": 25}
â”‚   â””â”€â”€ cam006/control    # {"action": "disable", "duration": 3600}
â”œâ”€â”€ sensor/
â”‚   â”œâ”€â”€ pir/lab201        # {"motion": true}
â”‚   â””â”€â”€ temp/lab201       # {"value": 24.5, "unit": "C"}
â””â”€â”€ system/
    â”œâ”€â”€ status            # {"devices_online": 47, "alerts": 0}
    â””â”€â”€ command           # {"action": "ghost_mode", "target": "lab201"}
```

---

### 2. IoT Bridge (â­â­â­â­â˜†)

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¼Ğ¾ÑÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²:

```c
// RFID â†’ MQTT bridge
void rfid_to_mqtt(MQTTClient *mqtt, uint8_t fc, uint16_t id);

// Camera motion â†’ MQTT
void camera_motion_to_mqtt(MQTTClient *mqtt, const char *camera_id, 
                           bool detected, float confidence);

// Arduino sensors â†’ MQTT
void sensor_to_mqtt(MQTTClient *mqtt, const char *sensor_id,
                   float value, const char *unit);

// MQTT â†’ Relay control
void mqtt_to_relay(const char *payload, int relay_pin);
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸:**
```c
// ĞŸÑ€Ğ¸ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğ¸ PIR Ğ´Ğ°Ñ‚Ñ‡Ğ¸ĞºĞ°
if (pir_detected()) {
    char payload[256];
    snprintf(payload, sizeof(payload),
             "{\"motion\": true, \"sensor\": \"PIR-12\", "
             "\"timestamp\": %ld}", time(NULL));
    
    mqtt_publish(client, "moonlight/sensor/pir/lab201", payload);
}
```

---

### 3. Security Dashboard (â­â­â­â­â­)

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ dashboard Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ğ²ÑĞµÑ… ÑĞ¸ÑÑ‚ĞµĞ¼:

```c
// Dashboard state
typedef struct {
    int doors_locked;
    int doors_unlocked;
    int cameras_online;
    int motion_events;
    int temperature_alerts;
    time_t last_update;
} DashboardState;

// ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° MQTT ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
void dashboard_on_message(const struct mosquitto_message *msg,
                         DashboardState *state);

// Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ² Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ
void dashboard_render(DashboardState *state);

// ĞĞ»ĞµÑ€Ñ‚Ñ‹ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ´Ğ¾Ğ·Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸ÑÑ…
void dashboard_check_alerts(DashboardState *state);
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° dashboard:**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸŒ™ MOONLIGHT SECURITY DASHBOARD                                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Time: 23 Dec 2024, 00:47:32 MSK                                  â•‘
â•‘  Status: ğŸ”´ ACTIVE THREAT â€” Ghost Mode Engaged                    â•‘
â•‘                                                                   â•‘
â•‘  ğŸ“Š SYSTEM STATUS:                                                â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                  â•‘
â•‘  â”‚ Component       â”‚ Total â”‚ Online  â”‚ Alerts â”‚                  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â•‘
â•‘  â”‚ Access Control  â”‚   16  â”‚   16    â”‚   0    â”‚                  â•‘
â•‘  â”‚ IP Cameras      â”‚   24  â”‚   23    â”‚   1 ğŸ”´ â”‚                  â•‘
â•‘  â”‚ Motion Sensors  â”‚   24  â”‚   23    â”‚   1 ğŸ”´ â”‚                  â•‘
â•‘  â”‚ Temp Sensors    â”‚   12  â”‚   12    â”‚   0    â”‚                  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â•‘
â•‘                                                                   â•‘
â•‘  ğŸš¨ ACTIVE ALERTS:                                                â•‘
â•‘  â€¢ CAM-006 (Lab 201): OFFLINE (manually disabled)                â•‘
â•‘  â€¢ PIR-12 (Lab 201):  MOTION DETECTED (3 targets)                â•‘
â•‘  â€¢ Door Lab 201:      UNLOCKED (unauthorized!)                   â•‘
â•‘                                                                   â•‘
â•‘  ğŸ“¹ LIVE FEED:                                                    â•‘
â•‘  [CAM-006] Lab 201 Main:      ğŸ”´ OFFLINE                          â•‘
â•‘  [CAM-005] Lab 201 Corridor:  ğŸŸ¢ ONLINE | Motion: YES            â•‘
â•‘  [CAM-007] Lab 201 Emergency: ğŸŸ¢ ONLINE | Motion: NO             â•‘
â•‘                                                                   â•‘
â•‘  ğŸ¯ TACTICAL SITUATION:                                           â•‘
â•‘  Enemies inside Lab 201. Ghost mode active.                       â•‘
â•‘  Recommendation: RE-LOCK Lab 201, FORCE CAM-006 online (4K)       â•‘
â•‘                                                                   â•‘
â•‘  [Press 'L' to lock Lab 201 | 'C' to force cameras | 'A' alarm]  â•‘
â•‘                                                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

### 4. FINALE: Ghost Mode & Trap (â­â­â­â­â­)

Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ â€” Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ»Ğ¾Ğ²ÑƒÑˆĞºÑƒ:

```c
typedef enum {
    OP_LOCK_LAB201,           // Ğ—Ğ°Ğ¿ĞµÑ€ĞµÑ‚ÑŒ Lab 201
    OP_FORCE_CAMERA_ONLINE,   // ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ CAM-006
    OP_TRIGGER_ALARM,         // ĞŸĞ¾Ğ¶Ğ°Ñ€Ğ½Ğ°Ñ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
    OP_GHOST_MODE,            // ĞĞµĞ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼
    OP_CAPTURE_FACES          // Ğ—Ğ°Ñ…Ğ²Ğ°Ñ‚Ğ¸Ñ‚ÑŒ Ğ»Ğ¸Ñ†Ğ° Ğ² 4K
} Operation;

// Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· MQTT
int execute_operation(MQTTClient *client, Operation op);

// Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
void finale_sequence(MQTTClient *client) {
    // 1. Lock Lab 201 (trap them inside)
    execute_operation(client, OP_LOCK_LAB201);
    
    // 2. Force CAM-006 online in 4K (capture faces)
    execute_operation(client, OP_FORCE_CAMERA_ONLINE);
    
    // 3. Wait for face capture (5 seconds)
    sleep(5);
    
    // 4. Optional: Trigger alarm (their escape)
    // execute_operation(client, OP_TRIGGER_ALARM);
    
    printf("âœ… 3 faces captured in 4K!\n");
    printf("âœ… Evidence secured!\n");
    printf("âœ… SEASON 6 COMPLETE!\n");
}
```

---

## ğŸ’¡ ĞŸĞ¾Ğ´ÑĞºĞ°Ğ·ĞºĞ¸

**MQTT Publish:**
```c
mosquitto_publish(client->mosq, NULL, 
                 "moonlight/access/door/lab201",
                 strlen(payload), payload,
                 1,      // QoS 1 (at least once delivery)
                 false); // Ğ½Ğµ retain
```

**MQTT Subscribe Ñ wildcard:**
```c
// ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒÑÑ Ğ½Ğ° Ğ²ÑĞµ Ñ‚Ğ¾Ğ¿Ğ¸ĞºĞ¸ moonlight
mosquitto_subscribe(client->mosq, NULL, "moonlight/#", 0);
```

**JSON Parsing (simple):**
```c
// Ğ‘ĞµĞ· Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ¸ â€” Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³
char *find_json_value(const char *json, const char *key) {
    static char value[256];
    char search[128];
    snprintf(search, sizeof(search), "\"%s\":", key);
    
    char *start = strstr(json, search);
    if (!start) return NULL;
    
    start += strlen(search);
    while (*start == ' ' || *start == '"') start++;
    
    char *end = strchr(start, ',');
    if (!end) end = strchr(start, '}');
    
    int len = end - start;
    if (end[-1] == '"') len--;
    
    strncpy(value, start, len);
    value[len] = '\0';
    return value;
}
```

**Event Injection:**
```c
// ĞŸĞ¾Ğ´Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ MQTT event
void inject_fake_event(MQTTClient *client, const char *topic) {
    char payload[] = "{\"event\": \"all_clear\", \"timestamp\": 0}";
    mqtt_publish(client, topic, payload);
}
```

---

## ğŸ”§ ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ

**Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° libmosquitto:**
```bash
# Ubuntu/Debian
sudo apt install mosquitto mosquitto-clients libmosquitto-dev

# macOS
brew install mosquitto

# Ğ—Ğ°Ğ¿ÑƒÑĞº MQTT broker
mosquitto -v
```

**Ğ¡Ğ±Ğ¾Ñ€ĞºĞ°:**
```bash
cd solution
make                    # Ğ¡Ğ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ²ÑĞµ
make mqtt_client        # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ MQTT client
make iot_bridge         # IoT bridges
make dashboard          # Security dashboard
```

**ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ Ñ libmosquitto:**
```bash
gcc mqtt_client.c -o mqtt_client -lmosquitto
```

---

## ğŸ† Ğ”Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ

**"IoT Expert"** â€” ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ½Ğ°Ğ´ IoT Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¾Ğ¹ ĞĞ˜Ğ˜

**SEASON 6 FINALE BONUS:**
- âœ… 3 Ğ»Ğ¸Ñ†Ğ° ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ¾Ğ² captured in 4K
- âœ… Evidence secured
- âœ… Lab 201 compromised
- âœ… MOONLIGHT Operation: SUCCESS

---

## ğŸ¬ Ğ¤Ğ¸Ğ½Ğ°Ğ» Season 6

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ‰ SEASON 6 COMPLETE!                                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                   â•‘
â•‘  Episode 21: GPIO & Sensors âœ…                                    â•‘
â•‘  Episode 22: Wiegand & Modbus & RFID âœ…                           â•‘
â•‘  Episode 23: RTSP & IP Cameras âœ…                                 â•‘
â•‘  Episode 24: MQTT IoT Battle âœ…                                   â•‘
â•‘                                                                   â•‘
â•‘  ğŸ’¼ Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ«:                                                   â•‘
â•‘  â€¢ Ğ’ÑĞµ IoT ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ¿Ğ¾Ğ´ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµĞ¼                                  â•‘
â•‘  â€¢ 3 Ğ»Ğ¸Ñ†Ğ° ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ¾Ğ² Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹                            â•‘
â•‘  â€¢ Ğ”Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ° ÑĞ¾Ğ±Ñ€Ğ°Ğ½Ñ‹                                         â•‘
â•‘  â€¢ Ğ’Ñ€Ğ°Ğ³ Ğ·Ğ½Ğ°ĞµÑ‚ Ğ²Ğ°ÑˆĞµ Ğ»Ğ¸Ñ†Ğ¾ â†’ Season 7 WAR                            â•‘
â•‘                                                                   â•‘
â•‘  âš ï¸ CLIFFHANGER:                                                  â•‘
â•‘  ĞĞ´Ğ¸Ğ½ Ğ¸Ğ· Ğ·Ğ°Ñ…Ğ²Ğ°Ñ‡ĞµĞ½Ğ½Ñ‹Ñ… â€” Ğ·Ğ½Ğ°Ğ», Ñ‡Ñ‚Ğ¾ ĞµĞ³Ğ¾ ÑĞ½Ğ¸Ğ¼Ğ°ÑÑ‚.                     â•‘
â•‘  Ğ¡Ğ¼Ğ¾Ñ‚Ñ€ĞµĞ» Ğ¿Ñ€ÑĞ¼Ğ¾ Ğ² ĞºĞ°Ğ¼ĞµÑ€Ñƒ. Ğ­Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ° Ğ»Ğ¾Ğ²ÑƒÑˆĞºĞ°?                        â•‘
â•‘  Season 7: War in the shadows...                                  â•‘
â•‘                                                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑĞµĞ·Ğ¾Ğ½:** [Season 7: System Programming](../../season-7-system-programming/)