# üéØ MISSION BRIEF: Industrial Protocols
## Episode 22 | CLASSIFIED

---

## üìã –ó–ê–î–ê–ù–ò–ï

**–¶–µ–ª—å:** –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ –°–ö–£–î

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í–´–°–û–ö–ò–ô

---

## ‚úÖ –ó–ê–î–ê–ß–ò

### 1. Wiegand Parser (wiegand_parser.c)

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏:

```c
// –ü–∞—Ä—Å–∏–Ω–≥ Wiegand-26
WiegandCard parse_wiegand26(uint32_t raw_data);

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Wiegand-26
uint32_t generate_wiegand26(uint8_t facility_code, uint16_t card_id);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
bool wiegand_is_valid(uint32_t raw_data);
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ FC (8 –±–∏—Ç) –∏ Card ID (16 –±–∏—Ç)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ even parity –¥–ª—è –ø–µ—Ä–≤—ã—Ö 13 –±–∏—Ç
- –ü—Ä–æ–≤–µ—Ä–∫–∞ odd parity –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 13 –±–∏—Ç
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–Ω—ã—Ö –∫–æ–¥–æ–≤ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —á—ë—Ç–Ω–æ—Å—Ç—å—é

---

### 2. Modbus Client (modbus_client.c)

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

```c
// CRC16 –¥–ª—è Modbus (–ø–æ–ª–∏–Ω–æ–º 0xA001)
uint16_t modbus_crc16(const uint8_t *data, size_t len);

// –°–æ–∑–¥–∞—Ç—å –∑–∞–ø—Ä–æ—Å Read Holding Registers
int modbus_read_holding_registers(uint8_t *buf, uint8_t slave_id,
                                   uint16_t addr, uint16_t count);

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CRC –æ—Ç–≤–µ—Ç–∞
bool modbus_check_crc(const uint8_t *frame, size_t len);
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- CRC16 –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É Modbus RTU
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ (slave, function, addr, count, CRC)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ CRC –≤ –æ—Ç–≤–µ—Ç–µ

---

### 3. RFID Emulator (rfid_emulator.c)

–°–æ–∑–¥–∞—Ç—å —ç–º—É–ª—è—Ç–æ—Ä RFID-–∫–∞—Ä—Ç:

```c
// –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç –∏–∑ —Ñ–∞–π–ª–∞
int load_cards(const char *filename, CardList *cards);

// –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Wiegand-–∫–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ä—Ç
void generate_all_codes(CardList *cards);

// –í—ã–≤–µ—Å—Ç–∏ –∫–æ–¥—ã –≤ hex
void print_codes(CardList *cards);
```

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:**
```
123,45678
123,45679
200,12345
```

**–í—ã–≤–æ–¥:**
```
Card 1: FC=123, ID=45678, Wiegand=0x1B2D84E
Card 2: FC=123, ID=45679, Wiegand=0x1B2D86F
...
```

---

## üìä –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

- [ ] Wiegand parser —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Wiegand —Å –≤–∞–ª–∏–¥–Ω–æ–π —á—ë—Ç–Ω–æ—Å—Ç—å—é
- [ ] Modbus CRC16 –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] Modbus –∑–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- [ ] RFID emulator —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥—ã
- [ ] –í—Å–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `make test`

---

## üîß –ò–ù–°–¢–†–£–ú–ï–ù–¢–´

**–ö–æ–º–ø–∏–ª—è—Ü–∏—è:**
```bash
make                  # –°–æ–±—Ä–∞—Ç—å –≤—Å–µ
make wiegand          # –¢–æ–ª—å–∫–æ Wiegand parser
make modbus           # –¢–æ–ª—å–∫–æ Modbus client
make rfid             # –¢–æ–ª—å–∫–æ RFID emulator
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
make test             # –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã
make clean            # –û—á–∏—Å—Ç–∫–∞
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
./wiegand_parser 0x1A2B3C4
./wiegand_parser --gen 123 45678

./modbus_client
# (—Å–∏–º—É–ª—è—Ü–∏—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)

./rfid_emulator test_cards.txt
```

---

## ‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï

–≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¢–û–õ–¨–ö–û –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞.

–ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–∞–º –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ —è–≤–ª—è–µ—Ç—Å—è **–ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º**.

---

## üì° –î–û–ù–ï–°–ï–ù–ò–ï

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å Wiegand parity
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Modbus CRC —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
4. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ Episode 23

---

**–°—Ç–∞—Ç—É—Å:** üü° IN PROGRESS

**–ê–≥–µ–Ω—Ç:** [–í–ê–®_–ü–û–ó–´–í–ù–û–ô]

**–û—Ç—á–µ—Ç –Ω–∞–ø—Ä–∞–≤–∏—Ç—å:** The Architect

---

*–ö–æ–¥ ‚Äî —ç—Ç–æ –∫–ª—é—á. –ü—Ä–æ—Ç–æ–∫–æ–ª ‚Äî —ç—Ç–æ –∑–∞–º–æ–∫. –í–∑–ª–æ–º ‚Äî —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ.* üîê