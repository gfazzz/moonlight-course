# Episode 09: "Network Basics" ๐

> *"Every connection has an address. Every address tells a story."*

---

## ๐ฌ BRIEFING

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะะะะะฆะะฏ: Safe House (ะฝะตะธะทะฒะตััะฝัะน ะฐะดัะตั), ะะพัะบะฒะฐ        โ
โ  ะะะะะฏ:   04:27, ััะตะดะฐ, 1 ะพะบััะฑัั                       โ
โ  ะกะขะะขะฃะก:  ๐ก NEW LEAD + POTENTIAL THREAT                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะั ะดะพัะปะธ ะดะพ ัะธะฝะฐะปะฐ Season 2. ะฃัะตัะบะธ ะฟะฐะผััะธ ััััะฐะฝะตะฝั. `buggy_logger` ะธัะฟัะฐะฒะปะตะฝ.  
ะะพัะปะต ะพะฑะฝะฐััะถะตะฝะธั GPS-ะบะพะพัะดะธะฝะฐั ะฒะฐัะตะน ััะฐัะพะน ะบะฒะฐััะธัั ะฒั ัะฒะฐะบัะธัะพะฒะฐะปะธัั ะฒ safe house.

**ะั ะฒ ะฑะตะทะพะฟะฐัะฝะพััะธ... ะธะปะธ ะฝะตั?**

ะ 04:27 ัััะฐ ะฝะฐ ะฒะฐั ะทะฐัะธััะฝะฝัะน ะบะฐะฝะฐะป ะฟัะธัะพะดะธั ะฝะพะฒะพะต ัะพะพะฑัะตะฝะธะต ะพั V.:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  FROM: V. (ENCRYPTED CHANNEL)               โ
โ  TO:   Agent [REDACTED]                     โ
โ  TIME: 04:27:19 UTC                         โ
โ  PRIORITY: HIGH                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                             โ
โ  ะะฐะผััั โ ััะพ ัะพะปัะบะพ ะฝะฐัะฐะปะพ.                โ
โ  ะะฐััะพััะฐั ะธะณัะฐ ะฝะฐัะธะฝะฐะตััั ะฒ ัะตัะธ.          โ
โ                                             โ
โ  ะฏ ะพััะฐะฒะธะป ัะฐะนะป:                            โ
โ  > addresses.txt                            โ
โ                                             โ
โ  ะญัะพ ะฝะต ะฟัะพััะพ ะฐะดัะตัะฐ.                      โ
โ  ะญัะพ ะบะฐััะฐ ัะตัะฒะตัะพะฒ MOONLIGHT.              โ
โ                                             โ
โ  ะะฐะนะดะธ ะฟะฐััะตัะฝ. ะะฐะนะดะธ ะฟะตัะฒัะน ัะทะตะป.          โ
โ                                             โ
โ  ะะพ ะฑัะดั ะพััะพัะพะถะตะฝ.                         โ
โ  ะะฝะธ ัะปะตะดัั ะทะฐ ััะฐัะธะบะพะผ.                    โ
โ                                             โ
โ  โ V.                                       โ
โ                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะั ะพัะบััะฒะฐะตัะต `addresses.txt`:

```
192.168.1.100:8080
10.0.0.5:22
8.8.8.8:53
172.16.0.1:443
127.0.0.1:80
203.0.113.42:31337
...
```

### โฑ๏ธ ะัะตะผะตะฝะฝะฐั ะปะธะฝะธั ัะพะฑััะธะน

```
04:27 โ ๐ง ะกะพะพะฑัะตะฝะธะต ะพั V.: ัะฐะนะป addresses.txt ะฟะพะปััะตะฝ
05:30 โ ๐ ะะฐัะฐะปะพ ะฐะฝะฐะปะธะทะฐ IP-ะฐะดัะตัะพะฒ ะธ ะฟะพััะพะฒ
06:15 โ ๐จ ะะะะขะะงะะกะะะ ะะขะะะซะขะะ!
        IP 203.0.113.42 ะฒ hex: CB 00 71 2A
        
        ะั ะทะฐะผะตัะฐะตัะต ัััะฐะฝะฝะพััั...
        CB = 203 (decimal)
        00 = 0
        71 = 113
        2A = 42
        
        ะะพ ะตัะปะธ ะธะฝัะตัะฟัะตัะธัะพะฒะฐัั ะบะฐะบ ะบะพะพัะดะธะฝะฐัั...
        203.0.113.42 โ ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะต...
        
        ๐ ะะะะะะะะะขะซ: 55.7558ยฐN 37.6173ยฐE
        
        ะั ะฟัะพะฒะตััะตัะต ะฝะฐ ะบะฐััะต: **ะะะะกะะะฏ ะะะะฉะะะฌ, ะะะกะะะ!**
        
06:16 โ โ๏ธ SMS ะพั ะฝะพะผะตัะฐ UNKNOWN:
        "ะขั ัะปะธัะบะพะผ ะฑะปะธะทะบะพ. ะััะฐะฝะพะฒะธัั."
        
06:17 โ ๐ฌ ะกะพะพะฑัะตะฝะธะต ะพั V.:
        "ะะณะฝะพัะธััะน ะธั. ะัะพะดะพะปะถะฐะน ะฐะฝะฐะปะธะท.
         ะัะฐัะฝะฐั ะฟะปะพัะฐะดั โ ัะพัะบะฐ ะฒัััะตัะธ.
         ะะพ ัะฝะฐัะฐะปะฐ ะพัะฒะพะน ัะตัะธ."
         
06:45 โ ๐ฏ ะะตัะตะฝะธะต: ะฟัะพะดะพะปะถะธัั ะฐะฝะฐะปะธะท ะฐะดัะตัะพะฒ
        ะะทััะธัั ะพัะฝะพะฒั ัะตัะตะน
        ะกะพะทะดะฐัั net_analyzer
```

**ะงัะพ ะฒั ะฟะพะฝะธะผะฐะตัะต:**
- IP-ะฐะดัะตัะฐ โ ััะพ **ะบะพะพัะดะธะฝะฐัั ะฒ ะบะธะฑะตัะฟัะพัััะฐะฝััะฒะต**
- ะะพััั ัะบะฐะทัะฒะฐัั ะฝะฐ **ัะตัะฒะธัั** (SSH, HTTP, DNS...)
- Private IP (192.168, 10.0, 172.16) โ **ะฒะฝัััะตะฝะฝะธะต ัะตัะธ**
- Public IP โ **ะดะพัััะฟะฝั ะธะท ะธะฝัะตัะฝะตัะฐ**
- ะะตะบะพัะพััะต IP ะผะพะณัั ัะพะดะตัะถะฐัั **ัะบััััะต ัะพะพะฑัะตะฝะธั** (GPS-ะบะพะพัะดะธะฝะฐัั!)
- **ะัะตัะปะตะดะพะฒะฐัะตะปะธ ัะปะตะดัั** โ ะบะฐะถะดะพะต ะดะตะนััะฒะธะต ะฟะพะด ัะณัะพะทะพะน ะพะฑะฝะฐััะถะตะฝะธั
- ะัะฐัะฝะฐั ะฟะปะพัะฐะดั โ **ัะพัะบะฐ ะฒัััะตัะธ ั V.** (ะฝะพ ัะฝะฐัะฐะปะฐ ะฝัะถะฝะพ ะพัะฒะพะธัั ัะตัะธ)

V. ะฝะต ะทัั ะฟัะธัะปะฐะป ััะพ. ะะพัะฐ ะพัะฒะพะธัั **ัะตัะตะฒะพะต ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธะต**.

### ๐ฏ ะะะะะงะ

ะกะพะทะดะฐัั **`net_analyzer`** โ ะฟัะพะณัะฐะผะผั ะดะปั ะฐะฝะฐะปะธะทะฐ IP-ะฐะดัะตัะพะฒ:
1. โ ะะฐััะธะฝะณ IP:PORT ะธะท ัะฐะนะปะฐ
2. โ ะะปะฐััะธัะธะบะฐัะธั (private/public/loopback)
3. โ ะะฟัะตะดะตะปะตะฝะธะต ัะตัะฒะธัะพะฒ ะฟะพ ะฟะพััะฐะผ
4. โ ะะพะฝะฒะตััะฐัะธั ะฒ hex ัะพัะผะฐั
5. โ ะะทะฒะปะตัะตะฝะธะต ะฟะฐััะตัะฝะฐ (ะฟััั ะบ ัะตัะฒะตัั)

**ะกะปะพะถะฝะพััั:** ๐ก Medium  
**ะะพะฒัะต ะฝะฐะฒัะบะธ:** TCP/IP, ัะตัะตะฒัะต ััััะบัััั, byte order, ัะพะบะตัั (preview)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  [!] ะะะะะะะะ:                               โ
โ  ะั ะฒัะพะดะธัะต ะฒ Season 3: NETWORKS.           โ
โ  ะะดะตัั ะบะฐะถะดัะน ะฟะฐะบะตั โ ัะปะตะด.                  โ
โ  ะะฐะถะดะพะต ัะพะตะดะธะฝะตะฝะธะต โ ะทะฐัะตะฟะบะฐ.                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะขะตะพัะธั: ะัะฝะพะฒั ัะตัะตะน TCP/IP

### 1. ะะพะดะตะปั OSI ะธ TCP/IP

**OSI (7 ัะปะพัะฒ)** vs **TCP/IP (4 ัะปะพั)**:

```
OSI Model          TCP/IP Model      ะัะธะผะตัั
-------------------------------------------------
Application  ]     
Presentation ] --> Application  --> HTTP, FTP, DNS
Session      ]     

Transport    ] --> Transport    --> TCP, UDP

Network      ] --> Internet     --> IP, ICMP

Data Link    ]
Physical     ] --> Link         --> Ethernet, WiFi
```

**ะ C ะฟัะพะณัะฐะผะผะธััะตะผ ะฝะฐ ััะพะฒะฝะต Transport ะธ Internet.**

---

### 2. IP-ะฐะดัะตัะฐ ะธ ััััะบัััั

#### IPv4 ะฐะดัะตั (32 ะฑะธัะฐ = 4 ะฑะฐะนัะฐ)

```c
#include <netinet/in.h>
#include <arpa/inet.h>

// ะกัััะบัััะฐ ะดะปั IPv4
struct in_addr {
    uint32_t s_addr;  // Network byte order (big-endian)
};

// ะกัััะบัััะฐ ะดะปั ัะพะบะตัะฐ (IP + ะฟะพัั)
struct sockaddr_in {
    sa_family_t    sin_family;  // AF_INET
    in_port_t      sin_port;    // ะะพัั (network byte order)
    struct in_addr sin_addr;    // IP ะฐะดัะตั
    char           sin_zero[8]; // Padding
};
```

#### ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะฐะดัะตัะพะฒ

```c
// ะกััะพะบะฐ โ ะฑะธะฝะฐัะฝัะน ัะพัะผะฐั
struct in_addr addr;
inet_pton(AF_INET, "192.168.1.1", &addr);

// ะะธะฝะฐัะฝัะน โ ัััะพะบะฐ
char ip_str[INET_ADDRSTRLEN];
inet_ntop(AF_INET, &addr, ip_str, INET_ADDRSTRLEN);
printf("IP: %s\n", ip_str);  // "192.168.1.1"

// ะกัะฐััะน ัะฟะพัะพะฑ (deprecated, ะฝะพ ัะฐััะพ ะฒัััะตัะฐะตััั)
addr.s_addr = inet_addr("192.168.1.1");
printf("IP: %s\n", inet_ntoa(addr));
```

---

### 3. Byte Order (ะฟะพััะดะพะบ ะฑะฐะนัะพะฒ)

**ะัะพะฑะปะตะผะฐ**: ัะฐะทะฝัะต ะฟัะพัะตััะพัั ััะฐะฝัั ัะธัะปะฐ ะฟะพ-ัะฐะทะฝะพะผั.

- **Little-endian** (Intel x86): ะผะปะฐะดัะธะน ะฑะฐะนั ะฟะตัะฒัะผ  
  `0x12345678` โ `78 56 34 12`

- **Big-endian** (Network): ััะฐััะธะน ะฑะฐะนั ะฟะตัะฒัะผ  
  `0x12345678` โ `12 34 56 78`

**ะกะตัั ะฒัะตะณะดะฐ ะธัะฟะพะปัะทัะตั big-endian (network byte order)!**

#### ะคัะฝะบัะธะธ ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธั

```c
#include <arpa/inet.h>

// Host to Network (Short - 16 bit)
uint16_t port = 8080;
uint16_t network_port = htons(port);

// Host to Network (Long - 32 bit)
uint32_t ip = 0xC0A80101;  // 192.168.1.1
uint32_t network_ip = htonl(ip);

// Network to Host
uint16_t host_port = ntohs(network_port);
uint32_t host_ip = ntohl(network_ip);
```

**ะัะฐะฒะธะปะพ**: ะัะตะณะดะฐ ะบะพะฝะฒะตััะธััะนัะต ะฟะตัะตะด ะพัะฟัะฐะฒะบะพะน/ะฟะพัะปะต ะฟะพะปััะตะฝะธั!

---

### 4. ะะพััั ะธ ะฟัะพัะพะบะพะปั

**ะะพัั** โ ััะพ ัะธัะปะพ ะพั 0 ะดะพ 65535, ะธะดะตะฝัะธัะธัะธััััะตะต ะฟัะธะปะพะถะตะฝะธะต.

```c
// Well-known ports (0-1023) โ ะทะฐัะตะทะตัะฒะธัะพะฒะฐะฝั
#define PORT_HTTP   80
#define PORT_HTTPS  443
#define PORT_SSH    22
#define PORT_FTP    21

// Registered ports (1024-49151)
// Dynamic/private (49152-65535)
```

**TCP vs UDP**:

| TCP                          | UDP                        |
|------------------------------|----------------------------|
| Connection-oriented          | Connectionless             |
| ะะฐะดัะถะฝัะน (retransmit)        | ะะตะฝะฐะดัะถะฝัะน (fire and forget)|
| ะฃะฟะพััะดะพัะตะฝะฝัะน                | ะะตัะฟะพััะดะพัะตะฝะฝัะน            |
| ะะตะดะปะตะฝะฝะตะต                    | ะััััะตะต                    |
| HTTP, SSH, FTP               | DNS, VoIP, streaming       |

---

### 5. ะกัััะบัััั IP ะธ TCP ะทะฐะณะพะปะพะฒะบะพะฒ

#### IP Header (IPv4)

```c
struct iphdr {
    uint8_t  version:4;       // IP ะฒะตััะธั (4)
    uint8_t  ihl:4;           // Header length
    uint8_t  tos;             // Type of service
    uint16_t tot_len;         // Total length
    uint16_t id;              // Identification
    uint16_t frag_off;        // Fragment offset
    uint8_t  ttl;             // Time to live
    uint8_t  protocol;        // Protocol (TCP=6, UDP=17)
    uint16_t check;           // Checksum
    uint32_t saddr;           // Source address
    uint32_t daddr;           // Destination address
};
```

#### TCP Header

```c
struct tcphdr {
    uint16_t source;          // Source port
    uint16_t dest;            // Destination port
    uint32_t seq;             // Sequence number
    uint32_t ack_seq;         // Acknowledgment
    uint16_t res1:4;          // Reserved
    uint16_t doff:4;          // Data offset
    uint16_t fin:1, syn:1, rst:1, psh:1,
             ack:1, urg:1, ece:1, cwr:1;  // Flags
    uint16_t window;          // Window size
    uint16_t check;           // Checksum
    uint16_t urg_ptr;         // Urgent pointer
};
```

---

### 6. ะัะฝะพะฒะฝัะต ัะตัะตะฒัะต ััะฝะบัะธะธ

```c
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>

// ะกะพะทะดะฐัั ัะพะบะตั
int sockfd = socket(AF_INET, SOCK_STREAM, 0);  // TCP
int sockfd = socket(AF_INET, SOCK_DGRAM, 0);   // UDP

// ะะฐะฟะพะปะฝะธัั ััััะบัััั ะฐะดัะตัะฐ
struct sockaddr_in addr;
addr.sin_family = AF_INET;
addr.sin_port = htons(8080);
inet_pton(AF_INET, "127.0.0.1", &addr.sin_addr);

// ะัะธะฒัะทะฐัั ะบ ะฐะดัะตัั (ะดะปั ัะตัะฒะตัะฐ)
bind(sockfd, (struct sockaddr*)&addr, sizeof(addr));

// ะะพะดะบะปััะธัััั (ะดะปั ะบะปะธะตะฝัะฐ)
connect(sockfd, (struct sockaddr*)&addr, sizeof(addr));
```

---

### 7. ะะพะปะตะทะฝัะต ััะธะปะธัั

```bash
# ะะพะบะฐะทะฐัั ัะตัะตะฒัะต ะธะฝัะตััะตะนัั
ifconfig         # macOS/ััะฐััะน Linux
ip addr          # Linux

# ะะพะบะฐะทะฐัั ัะฐะฑะปะธัั ะผะฐัััััะธะทะฐัะธะธ
netstat -rn      # macOS
ip route         # Linux

# ะะพะบะฐะทะฐัั ะฐะบัะธะฒะฝัะต ัะพะตะดะธะฝะตะฝะธั
netstat -an      # ะัะต
ss -tunap        # Linux (ัะพะฒัะตะผะตะฝะฝัะน)

# ะัะพะฒะตัะธัั ะดะพัััะฟะฝะพััั ัะพััะฐ
ping 8.8.8.8

# ะขัะฐััะธัะพะฒะบะฐ ะผะฐัััััะฐ
traceroute google.com
```

---

### 8. ๐ก ะะะขะะคะะะ: ะะฝัะตัะฝะตั = ะะพัะพะด ั ะฐะดัะตัะฐะผะธ

ะงัะพะฑั ะปัััะต ะฟะพะฝััั IP-ะฐะดัะตัะฐ ะธ ะฟะพััั, ะฟัะตะดััะฐะฒั **ะะฝัะตัะฝะตั ะบะฐะบ ะพะณัะพะผะฝัะน ะณะพัะพะด**:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐๏ธ ะะะะะ ะะะขะะะะะข โ ะะฐััะฐ ะะธะฑะตัะฟัะพัััะฐะฝััะฒะฐ              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ                                                            โ
โ  IP-ะะะะะก = ะะะะะะะะะขะซ ะะะะะะฏ                              โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ  โ 192.168.1.1                        โ                   โ
โ  โ = "ะฃะปะธัะฐ ะงะฐััะฝะฐั, ะดะพะผ 192,         โ                   โ
โ  โ    ะบะฒะฐััะฐะป 168, ััะฐััะพะบ 1"         โ                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ                                                            โ
โ  ะะะะข = ะะะะะ ะะะะะขะะะซ (ะธะปะธ ะพัะธัะฐ) ะฒ ะทะดะฐะฝะธะธ                โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ  โ :80  โ ะะฒะฐััะธัะฐ โ80 (HTTP)         โ                   โ
โ  โ :443 โ ะะฒะฐััะธัะฐ โ443 (HTTPS)       โ                   โ
โ  โ :22  โ ะะฒะฐััะธัะฐ โ22 (SSH)          โ                   โ
โ  โ :31337 โ ะกะตะบัะตัะฝัะน ะพัะธั V.         โ                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ                                                            โ
โ  PRIVATE IP (192.168.x.x, 10.0.x.x) = ะะะะะซะขะซะ ะะะกะะะะ    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ  โ ๐ง ะะพัะพัะฐ ั ะพััะฐะฝะพะน (NAT Router)   โ                   โ
โ  โ                                    โ                   โ
โ  โ  ๐๏ธ ะะฝัััะธ ะฟะพััะปะบะฐ:                โ                   โ
โ  โ  โโ ะะพะผ 1 (192.168.1.1)            โ                   โ
โ  โ  โโ ะะพะผ 100 (192.168.1.100)        โ                   โ
โ  โ  โโ ะะพะผ 254 (192.168.1.254)        โ                   โ
โ  โ                                    โ                   โ
โ  โ  ะกะฝะฐััะถะธ ะฝะต ะฒะธะดะฝั!                 โ                   โ
โ  โ  ะัะถะตะฝ ะฟัะพะฟััะบ ัะตัะตะท ะฒะพัะพัะฐ.       โ                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ                                                            โ
โ  PUBLIC IP (8.8.8.8, 203.0.113.42) = ะะะะะะะฏ ะะะะฉะะะฌ      โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ  โ ๐๏ธ ะัะฑะปะธัะฝะพะต ะทะดะฐะฝะธะต                 โ                   โ
โ  โ ะะธะดะฝะพ ะฒัะตะผ!                        โ                   โ
โ  โ ะะพัััะฟะฝะพ ะธะท ะปัะฑะพะน ัะพัะบะธ ะณะพัะพะดะฐ.    โ                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ                                                            โ
โ  LOOPBACK (127.0.0.1) = ะะะจ ะะะ                            โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ  โ ๐ "Home Sweet Home"                โ                   โ
โ  โ ะัะตะณะดะฐ ัะบะฐะทัะฒะฐะตั ะฝะฐ ะฒะฐั ะบะพะผะฟัััะตั  โ                   โ
โ  โ ะะตะทะฐะฒะธัะธะผะพ ะพั ัะตัะธ                 โ                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ                                                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ASCII-ะฐัั ะณะพัะพะดะฐ:**

```
           ๐ ะะะขะะะะะข โ ะะะะะ ะกะะะะะะะ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ                                             โ
    โ  ๐๏ธ ะัะฑะปะธัะฝะฐั ะฟะปะพัะฐะดั (8.8.8.8)            โ
    โ    โโ ะัะธั :53 (DNS ัะตัะฒะธั)                โ
    โ    โโ ะัะธั :80 (HTTP)                      โ
    โ    โโ ะัะธั :443 (HTTPS)                    โ
    โ                                             โ
    โ  ๐๏ธ ะะฐะบััััะน ะฟะพััะปะพะบ (192.168.0.0/16)      โ
    โ    ๐ง NAT Router (ะพััะฐะฝะฐ ะฝะฐ ะฒะพัะพัะฐั)        โ
    โ    โโ ๐ ะะพะผ 1 (192.168.1.1)               โ
    โ    โ   โโ ะะฒะฐััะธัะฐ :22 (SSH)               โ
    โ    โ   โโ ะะฒะฐััะธัะฐ :80 (ะปะพะบะฐะปัะฝัะน ะฒะตะฑ)     โ
    โ    โโ ๐ ะะพะผ 100 (192.168.1.100)           โ
    โ    โ   โโ ะะฒะฐััะธัะฐ :8080 (ะฟัะธะปะพะถะตะฝะธะต)      โ
    โ    โโ ๐ ะะพะผ 254 (192.168.1.254)           โ
    โ        โโ ะะฒะฐััะธัะฐ :53 (ะปะพะบะฐะปัะฝัะน DNS)     โ
    โ                                             โ
    โ  ๐ ะกะตะบัะตัะฝะพะต ัะฑะตะถะธัะต (203.0.113.42)       โ
    โ    โโ ะัะธั :31337 (MOONLIGHT server)       โ
    โ       ะะพะพัะดะธะฝะฐัั: 55.7558ยฐN 37.6173ยฐE      โ
    โ       (ะัะฐัะฝะฐั ะฟะปะพัะฐะดั!)                   โ
    โ                                             โ
    โ  ๐ ะะฐั ะดะพะผ (127.0.0.1 - localhost)        โ
    โ    โโ ะัะต ะฒะฐัะธ ะปะพะบะฐะปัะฝัะต ัะตัะฒะธัั           โ
    โ                                             โ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**Byte Order = ะะพััะพะฒัะน ะธะฝะดะตะบั:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ฎ BYTE ORDER โ ะะตะถะดัะฝะฐัะพะดะฝะฐั ะฟะพััะฐ                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ                                                            โ
โ  ะ ะะพััะธะธ (Big-Endian, Network Order):                    โ
โ  ะะฝะดะตะบั: 123456  โ  ะฟะธัะตะผ ัะปะตะฒะฐ ะฝะฐะฟัะฐะฒะพ                   โ
โ           โ                                                โ
โ      ััะฐััะฐั ัะธััะฐ ะฟะตัะฒะพะน                                  โ
โ                                                            โ
โ  ะ ะกะจะ (Little-Endian, Host Order ะฝะฐ Intel):               โ
โ  ะะฝะดะตะบั: 654321  โ  ะฟะธัะตะผ ะฝะฐะพะฑะพัะพั                        โ
โ           โ                                                โ
โ      ะผะปะฐะดัะฐั ัะธััะฐ ะฟะตัะฒะพะน                                  โ
โ                                                            โ
โ  ะะะะะะะะ: ะะตะถะดัะฝะฐัะพะดะฝะพะต ะฟะธััะผะพ!                           โ
โ  ะัะฟัะฐะฒะปัะตะผ ะธะท ะะพััะธะธ ะฒ ะกะจะ โ ะฝัะถะฝะฐ ะบะพะฝะฒะตััะฐัะธั!          โ
โ                                                            โ
โ  ะ ะะะะ:                                                   โ
โ  uint16_t port = 8080;  // ะ ะฟะพััะดะบะต ะฒะฐัะตะน ะผะฐัะธะฝั          โ
โ  uint16_t net_port = htons(port);  // โ Network order!    โ
โ                                                            โ
โ  htons = "Host TO Network Short"                           โ
โ  ntohs = "Network TO Host Short"                           โ
โ                                                            โ
โ  โ๏ธ ะะกะะะะ ะบะพะฝะฒะตััะธััะน ะฟะตัะตะด ะพัะฟัะฐะฒะบะพะน ะฒ ัะตัั!             โ
โ                                                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะัะฐะบัะธัะตัะบะธะน ะฟัะธะผะตั:**

```c
// โ ะะะะะะะะะฌะะ (ะฑะตะท ะบะพะฝะฒะตััะฐัะธะธ)
struct sockaddr_in addr;
addr.sin_port = 8080;  // ะัะดะตั ะฟัะพะฑะปะตะผะฐ!

// โ ะะะะะะะฌะะ (ั ะบะพะฝะฒะตััะฐัะธะตะน)
struct sockaddr_in addr;
addr.sin_port = htons(8080);  // Network byte order!

// ะัะพะฒะตัะบะฐ:
printf("Host order: %d\n", 8080);          // 8080
printf("Network order: %d\n", htons(8080)); // 36895 (ะฝะฐ little-endian)
// ะ ัะตัะธ ะฑัะดะตั ะฟัะฐะฒะธะปัะฝะพ ะธะฝัะตัะฟัะตัะธัะพะฒะฐะฝะพ ะบะฐะบ 8080!
```

---

## ๐ฏ ะะธััะธั: "ะะฝะฐะปะธะทะฐัะพั ะฐะดัะตัะพะฒ"

### ะะตะณะตะฝะดะฐ

V. ะพััะฐะฒะธะป ะทะฐัะธััะพะฒะฐะฝะฝัะน ัะฐะนะป ัะพ ัะฟะธัะบะพะผ IP-ะฐะดัะตัะพะฒ ะธ ะฟะพััะพะฒ. ะญัะพ ะฝะต ะฟัะพััะพ ะฐะดัะตัะฐ โ ะฒ ะฝะธั ะทะฐะบะพะดะธัะพะฒะฐะฝะฐ ะธะฝัะพัะผะฐัะธั:

- **IP-ะฐะดัะตัะฐ** ัะพะดะตัะถะฐั ะณะตะพะปะพะบะฐัะธั ัะตัะฒะตัะพะฒ
- **ะะพััั** ัะบะฐะทัะฒะฐัั ะฝะฐ ัะตัะฒะธัั
- **ะะพะผะฑะธะฝะฐัะธะธ** ะพะฑัะฐะทััั ะฟะฐััะตัะฝ

**ะะฐัะฐ ะทะฐะดะฐัะฐ**: ัะพะทะดะฐัั `net_analyzer` โ ััะธะปะธัั, ะบะพัะพัะฐั:
1. ะงะธัะฐะตั ัะฐะนะป ั IP:PORT ะทะฐะฟะธััะผะธ
2. ะัะพะฒะตััะตั ะบะพััะตะบัะฝะพััั ะฐะดัะตัะพะฒ
3. ะะปะฐััะธัะธัะธััะตั ะฟะพ ัะธะฟะฐะผ (private/public, well-known ports)
4. ะะทะฒะปะตะบะฐะตั ัะบัััะพะต ัะพะพะฑัะตะฝะธะต

---

### ะคะพัะผะฐั ะฒัะพะดะฝัั ะดะฐะฝะฝัั

ะคะฐะนะป `addresses.txt`:
```
192.168.1.100:8080
10.0.0.5:22
8.8.8.8:53
172.16.0.1:443
127.0.0.1:80
203.0.113.42:31337
```

ะะฐะถะดะฐั ัััะพะบะฐ: `IP:PORT`

---

### ะขะตัะฝะธัะตัะบะธะต ััะตะฑะพะฒะฐะฝะธั

**ะัะพะดะฝัะต ะดะฐะฝะฝัะต**: ัะฐะนะป `addresses.txt`

**ะััะพะดะฝัะต ะดะฐะฝะฝัะต**:
```
=== NETWORK ANALYZER ===
Analyzing addresses.txt...

[1] 192.168.1.100:8080
    Type: Private (RFC 1918)
    Network: 192.168.1.0/24
    Port: 8080 (HTTP Alternate)
    Hex: 0xC0A80164

[2] 10.0.0.5:22
    Type: Private (RFC 1918)
    Network: 10.0.0.0/8
    Port: 22 (SSH - Well-Known)
    Hex: 0x0A000005

[3] 8.8.8.8:53
    Type: Public
    Port: 53 (DNS - Well-Known)
    Hex: 0x08080808

...

Statistics:
- Total addresses: 6
- Private: 3 (50%)
- Public: 3 (50%)
- Well-known ports: 4
- Custom ports: 2

Hidden message: [Extracted from port patterns]
```

**ะคัะฝะบัะธะพะฝะฐะป**:
1. ะะฐััะธะฝะณ IP:PORT ะธะท ัััะพะบ
2. ะะฐะปะธะดะฐัะธั IP-ะฐะดัะตัะพะฒ
3. ะะฟัะตะดะตะปะตะฝะธะต ัะธะฟะฐ (private/public/loopback)
4. ะะปะฐััะธัะธะบะฐัะธั ะฟะพััะพะฒ (well-known/registered/dynamic)
5. ะะพะฝะฒะตััะฐัะธั ะฒ hex ัะพัะผะฐั
6. ะััะธัะปะตะฝะธะต ัะตัะธ ะฟะพ ะผะฐัะบะต
7. ะะทะฒะปะตัะตะฝะธะต ัะบัััะพะณะพ ัะพะพะฑัะตะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

---

## ๐ ะะฐะดะฐะฝะธะต

### Starter Code

ะคะฐะนะป `starter.c`:

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdint.h>
#include <arpa/inet.h>

#define MAX_LINE 256

typedef struct {
    struct in_addr ip;
    uint16_t port;
} Address;

// TODO: Implement functions

// Parse "IP:PORT" string
int parse_address(const char *str, Address *addr) {
    // Hint: use strtok or sscanf
    return 0;
}

// Check if IP is private (RFC 1918)
int is_private_ip(struct in_addr addr) {
    // 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16
    return 0;
}

// Get port type name
const char* get_port_type(uint16_t port) {
    // Well-known (0-1023), Registered (1024-49151), Dynamic (49152+)
    return "Unknown";
}

// Get service name for well-known port
const char* get_service_name(uint16_t port) {
    // 22=SSH, 80=HTTP, 443=HTTPS, etc.
    return "Unknown";
}

int main(int argc, char *argv[]) {
    // TODO: Read file, parse addresses, analyze, print stats
    return 0;
}
```

---

## ๐ ะกัััะบัััะฐ ัะฟะธะทะพะดะฐ

```
episode-09-network-basics/
โโโ README.md            โ ะั ะทะดะตัั
โโโ mission.md
โโโ starter.c            โ ะจะฐะฑะปะพะฝ ั ะฟัะธะผะตัะฐะผะธ
โโโ artifacts/
โ   โโโ ip_converter.c   โ ๐ฏ ะะะะะะะฃะขะะงะะะฏ ะะะะะงะ (ะฝะฐัะฝะธัะต ั ะฝะตั!)
โ   โโโ net_analyzer.c   โ ะคะธะฝะฐะปัะฝะฐั ะทะฐะดะฐัะฐ
โโโ solution/
โ   โโโ ip_converter_solution.c     โ ะะตัะตะฝะธะต ะฟัะพะผะตะถััะพัะฝะพะน
โ   โโโ net_analyzer_solution.c     โ ะะตัะตะฝะธะต ัะธะฝะฐะปัะฝะพะน
โโโ tests/
    โโโ test_ip_converter.sh        โ ะขะตัั ะฟัะพะผะตะถััะพัะฝะพะน
    โโโ test.sh                     โ ะขะตัั ัะธะฝะฐะปัะฝะพะน
```

### ๐ก ะะฐะบ ัะฐะฑะพัะฐัั:

**๐ฏ ะจะะ 1: ะัะพะผะตะถััะพัะฝะฐั ะทะฐะดะฐัะฐ `ip_converter.c` (ะะะะะะะะะฃะะขะกะฏ!)**

ะะตัะตะด ัะธะฝะฐะปัะฝะพะน ะทะฐะดะฐัะตะน ะพัะฒะพะนัะต ะฑะฐะทะพะฒัะต ะพะฟะตัะฐัะธะธ ั IP-ะฐะดัะตัะฐะผะธ:

1. **ะกะพะทะดะฐะนัะต** ัะฐะนะป `artifacts/ip_converter.c`
2. **ะะตะฐะปะธะทัะนัะต** ััะฝะบัะธะพะฝะฐะป:
   - ะะฒะพะด IP-ะฐะดัะตัะฐ ะธะท ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ ะธะปะธ ะธะฝัะตัะฐะบัะธะฒะฝะพ
   - ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ัััะพะบะธ ะฒ `struct in_addr` (`inet_pton`)
   - ะะพะฝะฒะตััะฐัะธั ะฒ hex (network byte order)
   - ะะพะฝะฒะตััะฐัะธั ะฒ decimal (host byte order)
   - ะัะฒะพะด ะพัะดะตะปัะฝัั ะพะบัะตัะพะฒ (ะฟะพะฑะธัะพะฒัะต ะพะฟะตัะฐัะธะธ)
   - ะะปะฐััะธัะธะบะฐัะธั IP (private/public/loopback)
3. **ะกะบะพะผะฟะธะปะธััะนัะต**: 
   ```bash
   gcc -Wall -Wextra -std=c11 -o ip_converter artifacts/ip_converter.c
   ```
4. **ะะฐะฟัััะธัะต**:
   ```bash
   ./ip_converter 192.168.1.100
   # ะธะปะธ ะธะฝัะตัะฐะบัะธะฒะฝัะน ัะตะถะธะผ:
   ./ip_converter
   ```
5. **ะัะพะฒะตัััะต**: 
   ```bash
   bash tests/test_ip_converter.sh
   ```

**ะัะธะผะตั ะฒัะฒะพะดะฐ:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    IP ADDRESS CONVERTER
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

Input:
  String: 192.168.1.100
  โ Valid IPv4 address

Binary Format:
  Network byte order: 0x6401A8C0
  Host byte order:    0xC0A80164

Decimal:
  Unsigned 32-bit: 3232235876

Octets:
  192 . 168 . 1 . 100

Classification:
  Type: Private (192.168.0.0/16 - RFC 1918)
```

---

**๐ฏ ะจะะ 2: ะคะธะฝะฐะปัะฝะฐั ะทะฐะดะฐัะฐ `net_analyzer.c`**

ะะพัะปะต ะพัะฒะพะตะฝะธั `ip_converter`, ะฟะตัะตัะพะดะธัะต ะบ ัะธะฝะฐะปัะฝะพะน ะทะฐะดะฐัะต:

1. **ะะทััะธัะต** `starter.c` โ ัะฐะผ ััััะบัััะฐ `Address` ะธ ะทะฐะณะพัะพะฒะบะธ ััะฝะบัะธะน
2. **ะกะพะทะดะฐะนัะต** ัะฐะนะป `artifacts/net_analyzer.c`
3. **ะะตะฐะปะธะทัะนัะต** ะฐะฝะฐะปะธะท ัะตัะตะฒัั ะฐะดัะตัะพะฒ:
   - ะะฐััะธะฝะณ ัััะพะบ "IP:PORT" ั ะฟะพะผะพััั `sscanf()`
   - ะะฐะปะธะดะฐัะธั IP ัะตัะตะท `inet_pton()`
   - ะะฟัะตะดะตะปะตะฝะธะต ัะธะฟะฐ IP (private/public/loopback)
   - ะะปะฐััะธัะธะบะฐัะธั ะฟะพััะพะฒ (well-known/registered/dynamic)
   - ะะพะฝะฒะตััะฐัะธั ะฒ hex ัะพัะผะฐั
   - ะกัะฐัะธััะธะบะฐ ะฟะพ ัะฐะนะปั
4. **ะกะบะพะผะฟะธะปะธััะนัะต**: `gcc -Wall -o net_analyzer artifacts/net_analyzer.c`
5. **ะะฐะฟัััะธัะต**: `./net_analyzer addresses.txt`
6. **ะัะพะฒะตัััะต**: `bash tests/test.sh`

---

### ะะพะดัะบะฐะทะบะธ

<details>
<summary>ะะฐะบ ะฟะฐััะธัั "IP:PORT"?</summary>

```c
int parse_address(const char *str, Address *addr) {
    char ip_str[INET_ADDRSTRLEN];
    int port;
    
    if (sscanf(str, "%15[^:]:%d", ip_str, &port) != 2) {
        return -1;
    }
    
    if (inet_pton(AF_INET, ip_str, &addr->ip) != 1) {
        return -1;
    }
    
    addr->port = (uint16_t)port;
    return 0;
}
```
</details>

<details>
<summary>ะะฐะบ ะฟัะพะฒะตัะธัั private IP?</summary>

```c
int is_private_ip(struct in_addr addr) {
    uint32_t ip = ntohl(addr.s_addr);
    
    // 10.0.0.0/8
    if ((ip & 0xFF000000) == 0x0A000000) return 1;
    
    // 172.16.0.0/12
    if ((ip & 0xFFF00000) == 0xAC100000) return 1;
    
    // 192.168.0.0/16
    if ((ip & 0xFFFF0000) == 0xC0A80000) return 1;
    
    return 0;
}
```
</details>

<details>
<summary>ะะฐะบ ะฟะพะปััะธัั ะธะผั ัะตัะฒะธัะฐ?</summary>

```c
const char* get_service_name(uint16_t port) {
    switch (port) {
        case 20: return "FTP-DATA";
        case 21: return "FTP";
        case 22: return "SSH";
        case 23: return "Telnet";
        case 25: return "SMTP";
        case 53: return "DNS";
        case 80: return "HTTP";
        case 443: return "HTTPS";
        default: return "Unknown";
    }
}
```
</details>

---

## โ ะัะพะฒะตัะบะฐ

```bash
make
make test
```

**ะัะธัะตัะธะธ ััะฟะตัะฐ**:
- ะะพััะตะบัะฝะพ ะฟะฐััะธั ะฒัะต ะฐะดัะตัะฐ
- ะัะฐะฒะธะปัะฝะพ ะพะฟัะตะดะตะปัะตั private/public
- ะะปะฐััะธัะธัะธััะตั ะฟะพััั
- ะะพะฝะฒะตััะธััะตั ะฒ hex
- ะัะฒะพะดะธั ััะฐัะธััะธะบั

---

## ๐ ะััะตัะฐะบั

ะะพัะปะต ะฒัะฟะพะปะฝะตะฝะธั ะผะธััะธะธ ะฒั ะฟะพะปััะธัะต:
- **ะะฐะฒัะบ**: ัะฐะฑะพัะฐ ั IP-ะฐะดัะตัะฐะผะธ ะธ ะฟะพััะฐะผะธ ะฒ C
- **ะะฝััััะผะตะฝั**: `net_analyzer` โ ะฐะฝะฐะปะธะทะฐัะพั ัะตัะตะฒัั ะฐะดัะตัะพะฒ
- **ะคัะฝะดะฐะผะตะฝั**: ะณะพัะพะฒะฝะพััั ะบ Episode 10 (ัะพะบะตัั)

---

## ๐ฌ DEBRIEFING

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะะะะะฆะะฏ: Safe House (ะฝะตะธะทะฒะตััะฝัะน ะฐะดัะตั), ะะพัะบะฒะฐ        โ
โ  ะะะะะฏ:   07:15, ััะตะดะฐ, 1 ะพะบััะฑัั                       โ
โ  ะกะขะะขะฃะก:  ๐ข FIRST NODE IDENTIFIED + GPS DECODED         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

`net_analyzer` ะทะฐะฟััะตะฝ. ะะฝะฐะปะธะท ะทะฐะฒะตัััะฝ. ะะตะทัะปััะฐั:

```
=== NETWORK ANALYZER ===
Analyzing addresses.txt... โ

Statistics:
- Total addresses: 42
- Private: 18 (42.9%)
- Public: 21 (50.0%)
- Loopback: 3 (7.1%)
- Well-known ports: 28

๐ PATTERN DETECTED:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Public IPs with port 31337:                    โ
โ  203.0.113.42:31337                             โ
โ                                                 โ
โ  Hex: 0xCB00712A                                โ
โ  Binary: 11001011 00000000 01110001 00101010    โ
โ           โ        โ        โ        โ          โ
โ         203  .   0   .  113  .  42              โ
โ                                                 โ
โ  ๐ฏ FIRST NODE: 203.0.113.42:31337             โ
โ                                                 โ
โ  ๐ ะกะะะซะขะะ ะกะะะะฉะะะะ:                          โ
โ  GPS-ะบะพะพัะดะธะฝะฐัั: 55.7558ยฐN 37.6173ยฐE            โ
โ  ะะพะบะฐัะธั: ะะะะกะะะฏ ะะะะฉะะะฌ, ะะะกะะะ               โ
โ  (ะกะฟะฐััะบะฐั ะฑะฐัะฝั ะัะตะผะปั)                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะงัะพ ะฒั ัะทะฝะฐะปะธ:**
- **Port 31337** (ัะปะธัะฝัะน ัะฐะบะตััะบะธะน ะฟะพัั, "leet" = 1337) โ **ะฝะต ัะปััะฐะนะฝะพััั**
- **203.0.113.0/24** โ TEST-NET-3 (RFC 5737) โ **ะผะฐัะบะธัะพะฒะบะฐ ะฟะพะด ัะตััะพะฒัั ัะตัั**
- **Hex ะฟัะตะดััะฐะฒะปะตะฝะธะต** ัะพะดะตัะถะธั **GPS-ะบะพะพัะดะธะฝะฐัั ะฒัััะตัะธ**
- ะญัะพ **ะฟะตัะฒัะน ัะทะตะป ัะตัะธ MOONLIGHT** + **ัะพัะบะฐ ะฒัััะตัะธ ั V.**
- ะัะตัะปะตะดะพะฒะฐัะตะปะธ ัะถะต ะทะฝะฐัั ะพ ะฒะฐัะตะผ ะฐะฝะฐะปะธะทะต (SMS ะพั UNKNOWN)

ะ 07:12 ะฟัะธัะพะดะธั ะฝะพะฒะพะต ัะพะพะฑัะตะฝะธะต:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  FROM: V.                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                         โ
โ  ะขั ะฝะฐััะป ะฐะดัะตั. ะขั ะฝะฐััะป ะผะตััะพ.        โ
โ                                         โ
โ  ะัะฐัะฝะฐั ะฟะปะพัะฐะดั โ ัะพัะบะฐ ะฒัััะตัะธ.       โ
โ  ะะพ ะกะะะงะะะ ะฝะฐััะธัั ัะตััะผ.              โ
โ                                         โ
โ  Episode 10: Socket Programming         โ
โ  ะะพะดะบะปััะธัั ะบ ัะตัะฒะตัั 203.0.113.42      โ
โ  ะะดั ัะตะฑั ัะฐะผ.                          โ
โ                                         โ
โ  P.S. ะะณะฝะพัะธััะน SMS ะพั UNKNOWN.         โ
โ  ะญัะพ ะฟััััะต ัะณัะพะทั.                     โ
โ                                         โ
โ  โ V.                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะ 07:14 ะฒั ัะผะพััะธัะต ะฝะฐ ะบะฐััั:

```
         ๐ ะะะกะะะ
           โ
           v
    โโโโโโโโโโโโโโโโ
    โ  ๐๏ธ ะะะะกะะะฏ   โ
    โ   ะะะะฉะะะฌ    โ  โ 55.7558ยฐN 37.6173ยฐE
    โ              โ
    โ  ๐ ะขะพัะบะฐ    โ
    โ   ะฒัััะตัะธ    โ
    โโโโโโโโโโโโโโโโ
    
ะะฐัััะพัะฝะธะต ะพั safe house: ~3.5 ะบะผ
ะัะตะผั ะฒ ะฟััะธ: ~15 ะผะธะฝัั ะฝะฐ ะผะตััะพ
```

**IP-ะฐะดัะตัะฐ โ ััะพ ะบะพะพัะดะธะฝะฐัั. GPS โ ััะพ ะฒัััะตัะฐ. ะขะตะฟะตัั ะฟะพัะฐ ะฝะฐััะธัััั ะฟะพะดะบะปััะฐัััั.**

### ๐๏ธ ะะฐะฒัะบ ัะฐะทะฑะปะพะบะธัะพะฒะฐะฝ:
**"Network Cartographer"** โ ะั ะฟะพะฝะธะผะฐะตัะต IP-ะฐะดัะตัะฐัะธั ะธ ััััะบัััั ัะตัะตะน ะฝะฐ ััะพะฒะฝะต ะฑะฐะนัะพะฒ.

---

## ๐ ะะะะขะะะะฌะะซะ ะะะะะะกะซ

ะัะพะฒะตัััะต ะฟะพะฝะธะผะฐะฝะธะต Episode 09 (ะฒัะต ะฒะพะฟัะพัั ะพัะฝะพะฒะฐะฝั ะฝะฐ ััะถะตัะต ัะฐััะธััะพะฒะบะธ GPS ะธะท IP):

### ๐ข ะะฐะทะพะฒะพะต ะฟะพะฝะธะผะฐะฝะธะต (4 ะฒะพะฟัะพัะฐ)

**1. ะ ัะฐะนะปะต `addresses.txt` ะฒั ะฝะฐัะปะธ IP `203.0.113.42`. ะงัะพ ััะพ ัะฐะบะพะต ะธ ะบะฐะบ ะพะฝ ะฟะพะผะพะณ ะฝะฐะนัะธ ะัะฐัะฝัั ะฟะปะพัะฐะดั?**

<details>
<summary>ะัะฒะตั</summary>

**IP-ะฐะดัะตั โ ัะฝะธะบะฐะปัะฝัะน ะธะดะตะฝัะธัะธะบะฐัะพั ััััะพะนััะฒะฐ ะฒ ัะตัะธ**, ัะพััะพะธั ะธะท 4 ะฑะฐะนัะพะฒ (32 ะฑะธัะฐ).

**ะ ะผะธััะธะธ:**
```
IP: 203.0.113.42
Hex: 0xCB00712A
Binary: 11001011.00000000.01110001.00101010
```

**ะะฐััะธััะพะฒะบะฐ GPS:**
- ะะบัะตัั `203.0` = ัะธัะพัะฐ `55.7558ยฐN`
- ะะบัะตัั `113.42` = ะดะพะปะณะพัะฐ `37.6173ยฐE`
- **ะะตะทัะปััะฐั:** ะัะฐัะฝะฐั ะฟะปะพัะฐะดั, ะกะฟะฐััะบะฐั ะฑะฐัะฝั ะัะตะผะปั!

**ะ ะบะพะดะต (PATTERN DETECTED):**
```c
struct in_addr addr;
inet_pton(AF_INET, "203.0.113.42", &addr);
// โ ะบะพะพัะดะธะฝะฐัั ะฒัััะตัะธ ั V.!
```

**ะขะตัะฝะธัะตัะบะธ:**
- IPv4 = 32 ะฑะธัะฐ = 4 ะพะบัะตัะฐ
- ะะฐะถะดัะน ะพะบัะตั: 0-255
- ะัะฟะพะปัะทัะตััั ะดะปั ะผะฐัััััะธะทะฐัะธะธ ะฟะฐะบะตัะพะฒ
- ะ ะผะธััะธะธ: V. ะทะฐะบะพะดะธัะพะฒะฐะป GPS ะฒ IP!

**ะฃัะพะบ:** IP-ะฐะดัะตั ะผะพะถะตั ะฝะตััะธ ัะบััััะน ัะผััะป. ะัั ะทะฐะฒะธัะธั ะพั ะธะฝัะตัะฟัะตัะฐัะธะธ.
</details>

**2. ะะพัะตะผั IP `192.168.1.100` (ะธะท ะฒะฐัะตะณะพ safe house) ะฝะต ะฒะธะดะตะฝ ะธะท ะธะฝัะตัะฝะตัะฐ, ะฐ `203.0.113.42` (ัะตัะฒะตั V.) ะฒะธะดะตะฝ?**

<details>
<summary>ะัะฒะตั</summary>

**`192.168.1.100` โ private IP, `203.0.113.42` โ public IP!**

**Private IP (RFC 1918):**
```
10.0.0.0/8        โ 10.0.0.0 โ 10.255.255.255
172.16.0.0/12     โ 172.16.0.0 โ 172.31.255.255
192.168.0.0/16    โ 192.168.0.0 โ 192.168.255.255  โ ะะฐั safe house!
```
- ะัะฟะพะปัะทััััั **ะฒะฝัััะธ ะปะพะบะฐะปัะฝัั ัะตัะตะน**
- **ะะ ะผะฐัััััะธะทะธัััััั ะฒ ะธะฝัะตัะฝะตัะต**
- ะัะถะตะฝ NAT ะดะปั ะดะพัััะฟะฐ ะฝะฐััะถั

**Public IP:**
```
203.0.113.42 โ ะกะตัะฒะตั V.
```
- ะฃะฝะธะบะฐะปะตะฝ **ะณะปะพะฑะฐะปัะฝะพ**
- ะะพัััะฟะตะฝ ะธะท ะธะฝัะตัะฝะตัะฐ
- ะะพะถะฝะพ ะฟะพะดะบะปััะธัััั ะฝะฐะฟััะผัั

**ะ ะผะธััะธะธ:**
```
Safe House Network:
โโ Router: 192.168.1.1 (private)
โโ ะะฐั ะบะพะผะฟัััะตั: 192.168.1.100 (private)
โโ ะััะพะด ะฒ ะธะฝัะตัะฝะตั: NAT โ Public IP

ะกะตัะฒะตั V.:
โโ 203.0.113.42:31337 (public) โ ะะพัััะฟะตะฝ ะธะท ะปัะฑะพะน ัะพัะบะธ ะผะธัะฐ
```

**ะัะพะฒะตัะบะฐ ะฒ ip_converter:**
```bash
$ ./ip_converter 192.168.1.100
Type: Private (192.168.0.0/16 - RFC 1918)

$ ./ip_converter 203.0.113.42
Type: Public (TEST-NET-3 203.0.113.0/24 - RFC 5737)
```

**ะฃัะพะบ:** Private IP = ะฒะฐัะฐ ะทะฐัะธัะฐ ะพั ะฟััะผะพะณะพ ะดะพัััะฟะฐ ะธะท ะธะฝัะตัะฝะตัะฐ.
</details>

**3. ะกะตัะฒะตั V. ัะฐะฑะพัะฐะตั ะฝะฐ `203.0.113.42:31337`. ะงัะพ ะพะทะฝะฐัะฐะตั `:31337` ะธ ะฟะพัะตะผั ััะพ ะฒะฐะถะฝะพ?**

<details>
<summary>ะัะฒะตั</summary>

**`:31337` โ ััะพ ะฟะพัั, ะฝะพะผะตั "ะดะฒะตัะธ" ะฝะฐ ัะตัะฒะตัะต!**

**ะะฝะฐะปะพะณะธั ะธะท ะผะตัะฐัะพัั "ะะพัะพะด ะะฝัะตัะฝะตั":**
```
203.0.113.42 = ะฐะดัะตั ะทะดะฐะฝะธั (ะกะฟะฐััะบะฐั ะฑะฐัะฝั)
31337 = ะฝะพะผะตั ะบะฒะฐััะธัั (ะณะดะต ะถะธะฒัั ัะตัะฒะตั V.)
```

**ะะฐัะตะผ ะฟะพัั:**
- ะะฐ ะพะดะฝะพะผ IP ะผะพะถะตั ะฑััั **ะผะฝะพะณะพ ัะตัะฒะธัะพะฒ**
- ะะพัั ัะฐะทะปะธัะฐะตั ะธั

**ะะฐัะตะณะพัะธะธ ะฟะพััะพะฒ:**
```
0-1023      โ Well-known (SSH=22, HTTP=80, HTTPS=443)
1024-49151  โ Registered (ะฟัะธะปะพะถะตะฝะธั)
49152-65535 โ Dynamic (ะฒัะตะผะตะฝะฝัะต ัะพะตะดะธะฝะตะฝะธั)
```

**ะ ะผะธััะธะธ:**
```
203.0.113.42:31337 โ ะกะตัะฒะตั V. (TCP)
203.0.113.42:80    โ ะะพะณ ะฑั ะฑััั ะฒะตะฑ-ัะตัะฒะตั
203.0.113.42:22    โ ะะพะณ ะฑั ะฑััั SSH
```

**ะะพัะตะผั 31337?**
- **Leet speak:** 1337 = "LEET" (ัะปะธัะฝัะน)
- 31337 = ัะฐะบะตััะบะธะน ะฟะพัั (Easter Egg!)
- ะกะบััััะน ัะตัะฒะธั, ะฝะต ััะฐะฝะดะฐััะฝัะน

**ะ ะบะพะดะต (Episode 10):**
```c
struct sockaddr_in addr;
addr.sin_family = AF_INET;
addr.sin_port = htons(31337);  // โ ะะะะะ: htons()!
inet_pton(AF_INET, "203.0.113.42", &addr.sin_addr);
connect(sockfd, ...);  // โ ะะพะดะบะปััะตะฝะธะต ะบ ัะตัะฒะตัั V.
```

**ะฃัะพะบ:** IP ะฑะตะท ะฟะพััะฐ ะฑะตัะฟะพะปะตะทะตะฝ. ะัะตะณะดะฐ ะฝัะถะฝะพ ะทะฝะฐัั ะพะฑะฐ.
</details>

**4. ะ ะทะฐะดะฐัะต `ip_converter.c` ะฒั ะธัะฟะพะปัะทะพะฒะฐะปะธ `htons()`. ะะพัะตะผั ััะพ ะบัะธัะธัะฝะพ ะดะปั ะฟะพะดะบะปััะตะฝะธั ะบ ัะตัะฒะตัั V.?**

<details>
<summary>ะัะฒะตั</summary>

**Network byte order (big-endian) โ Host byte order (little-endian ะฝะฐ Intel)!**

**ะัะพะฑะปะตะผะฐ:**
```
ะะฐั ะบะพะผะฟัััะตั (Intel x86):     Little-endian (ะผะปะฐะดัะธะน ะฑะฐะนั ะฟะตัะฒัะผ)
ะกะตัั (TCP/IP ััะฐะฝะดะฐัั):          Big-endian (ััะฐััะธะน ะฑะฐะนั ะฟะตัะฒัะผ)
```

**ะะตะท `htons()` โ ะบะฐัะฐัััะพัะฐ:**
```c
// ะะะะะะะะะฌะะ:
addr.sin_port = 31337;  // 0x7A69 ะฒ little-endian

ะ ะฟะฐะผััะธ: [69 7A]
ะ ัะตัั ะพัะฟัะฐะฒะธััั: ะฟะพัั 26985 (0x697A)!
ะกะตัะฒะตั V. ะถะดัั 31337, ะฝะพ ะฒั ััััะธัะต ะฒ 26985 โ Connection refused!
```

**ะก `htons()` โ ััะฟะตั:**
```c
// ะะะะะะะฌะะ:
addr.sin_port = htons(31337);  // ะะพะฝะฒะตััะฐัะธั!

Host (little): 31337 = 0x7A69 โ [69 7A]
Network (big): htons() โ [7A 69]
ะกะตัะฒะตั V. ะฟะพะปััะฐะตั ะฟัะฐะฒะธะปัะฝัะน ะฟะพัั 31337 โ
```

**ะคัะฝะบัะธะธ ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธั:**
```c
htons()  // Host TO Network Short (16-bit ะฟะพัั)
htonl()  // Host TO Network Long (32-bit IP)
ntohs()  // Network TO Host Short
ntohl()  // Network TO Host Long
```

**ะ ะผะธััะธะธ (ip_converter.c):**
```c
printf("Network byte order: 0x%08X\n", addr.s_addr);      // Big-endian
printf("Host byte order:    0x%08X\n", ntohl(addr.s_addr)); // Little-endian

// ะะปั 203.0.113.42:
// Network: 0xCB00712A
// Host:    0x2A7100CB
```

**ะฃัะพะบ:** ะะกะะะะ ะธัะฟะพะปัะทัะนัะต `htons()`/`htonl()` ะดะปั ัะตัะตะฒัั ััััะบััั!
</details>

---

### ๐ก ะัะฐะบัะธะบะฐ (4 ะฒะพะฟัะพัะฐ)

**5. ะั ะทะฐะฟัััะธะปะธ `ip_converter` ะดะปั ัะตััะธัะพะฒะฐะฝะธั byte order. ะงัะพ ะฒะตัะฝัั `htons(0x1234)` ะฝะฐ ะฒะฐัะตะผ ะบะพะผะฟัััะตัะต (Intel)?**

<details>
<summary>ะัะฒะตั</summary>

**`0x3412` โ ะฑะฐะนัั ะผะตะฝััััั ะผะตััะฐะผะธ!**

**ะะฑัััะฝะตะฝะธะต:**
```
ะัะพะดะฝะพะต ะทะฝะฐัะตะฝะธะต: 0x1234 (host byte order, little-endian ะฝะฐ Intel)
ะ ะฟะฐะผััะธ Intel:   [34 12] (ะผะปะฐะดัะธะน ะฑะฐะนั ะฟะตัะฒัะผ)
Network order:    [12 34] (ััะฐััะธะน ะฑะฐะนั ะฟะตัะฒัะผ - big-endian)
ะะตะทัะปััะฐั:        0x3412
```

**ะ ะผะธััะธะธ (ip_converter.c):**
```c
uint16_t test_port = 0x1234;
printf("Host byte order:    0x%04X\n", test_port);     // 0x1234
printf("Network byte order: 0x%04X\n", htons(test_port)); // 0x3412
```

**ะัะพะฒะตัะบะฐ:**
```bash
$ ./ip_converter
# ะขะตััะธััะนัะต ัะฐะทะฝัะต ะทะฝะฐัะตะฝะธั:
# 0x1234 โ 0x3412
# 31337 (0x7A69) โ 0x697A (ะฒ network ะฟะพััะดะบะต)
```

**ะะพัะตะผั ััะพ ะฒะฐะถะฝะพ ะดะปั ะผะธััะธะธ:**
- ะะพัั 31337 ัะตัะฒะตัะฐ V. ะะะฏะะะขะะะฌะะ ัะตัะตะท `htons()`!
- ะะฝะฐัะต ะฟะพะดะบะปััะธัะตัั ะบ ะฝะตะฟัะฐะฒะธะปัะฝะพะผั ะฟะพััั

**ะฃัะพะบ:** Network byte order โ ััะพ BIG-endian, ะฒัะตะณะดะฐ!
</details>

**6. ะ `net_analyzer` ะฒั ะฟะฐััะธัะต `addresses.txt`. ะะฐะบ ะฑะตะทะพะฟะฐัะฝะพ ะฟัะตะพะฑัะฐะทะพะฒะฐัั ัััะพะบั "203.0.113.42" ะฒ `struct in_addr`?**

<details>
<summary>ะัะฒะตั</summary>

**ะัะฟะพะปัะทัะนัะต `inet_pton()` โ ัะพะฒัะตะผะตะฝะฝัะน ะธ ะฑะตะทะพะฟะฐัะฝัะน ัะฟะพัะพะฑ!**

**ะ ะผะธััะธะธ (net_analyzer.c):**
```c
#include <arpa/inet.h>

char line[256];
while (fgets(line, sizeof(line), file)) {
    // ะัะพัะธัะฐะปะธ ัััะพะบั ะธะท addresses.txt: "203.0.113.42"
    line[strcspn(line, "\n")] = '\0';  // ะฃะดะฐะปะธัั \n
    
    struct in_addr addr;
    if (inet_pton(AF_INET, line, &addr) == 1) {
        printf("โ Valid IP: %s\n", line);
        printf("  Binary: 0x%08X\n", ntohl(addr.s_addr));
        
        // ะัะพะฒะตัะบะฐ ะฝะฐ GPS-ะบะพะพัะดะธะฝะฐัั:
        if (ntohl(addr.s_addr) == 0xCB00712A) {  // 203.0.113.42
            printf("๐ฏ PATTERN DETECTED: RED SQUARE!\n");
        }
    } else {
        printf("โ Invalid IP: %s\n", line);
    }
}
```

**ะกัะฐััะน ัะฟะพัะพะฑ (ะะ ะะกะะะะฌะะฃะะขะ):**
```c
addr.s_addr = inet_addr("203.0.113.42");  // โ Deprecated!
// ะัะพะฑะปะตะผั:
// - ะะต ะฟัะพะฒะตััะตั ะฒะฐะปะธะดะฝะพััั
// - ะะพะทะฒัะฐัะฐะตั INADDR_NONE ะดะปั ะพัะธะฑะพะบ
// - INADDR_NONE = 255.255.255.255 (ัะพะถะต ะฒะฐะปะธะดะฝัะน IP!)
```

**ะะพัะตะผั `inet_pton` ะปัััะต:**
1. **ะะพะทะฒัะฐัะฐะตั ะบะพะด ะพัะธะฑะบะธ:**
   - `1` = ััะฟะตั
   - `0` = ะฝะตะฒะฐะปะธะดะฝัะน IP
   - `-1` = ัะธััะตะผะฝะฐั ะพัะธะฑะบะฐ

2. **ะะฐะฑะพัะฐะตั ั IPv6** (ะตัะปะธ ะฝัะถะฝะพ)
3. **Thread-safe**
4. **ะะต ะฟััะฐะตั ะพัะธะฑะบะธ ั ะฒะฐะปะธะดะฝัะผะธ IP**

**ะ ะผะธััะธะธ:**
- `addresses.txt` ะผะพะถะตั ัะพะดะตัะถะฐัั ะผััะพั
- `inet_pton()` ะพััะธะปััััะตั ะฝะตะฒะฐะปะธะดะฝัะต IP
- ะขะพะปัะบะพ ะฒะฐะปะธะดะฝัะต IP โ ะฐะฝะฐะปะธะท โ ะฟะพะธัะบ GPS

**ะฃัะพะบ:** ะัะตะณะดะฐ ะฟัะพะฒะตััะนัะต ะฒะฒะพะด ะฟะพะปัะทะพะฒะฐัะตะปั/ัะฐะนะปะพะฒ!
</details>

**7. ะัะปะธ V. ัะผะตะฝะธั ะฟะพัั ั 31337 ะฝะฐ 443 (HTTPS), ััะพ ะธะทะผะตะฝะธััั ะฒ ะฟะพะดะบะปััะตะฝะธะธ?**

<details>
<summary>ะัะฒะตั</summary>

**ะขะตัะฝะธัะตัะบะธ โ ัะพะปัะบะพ ะฝะพะผะตั ะฟะพััะฐ. ะะพ ัะตะผะฐะฝัะธัะตัะบะธ โ ะฒัั!**

**ะขะตัะฝะธัะตัะบะธะต ะธะทะผะตะฝะตะฝะธั:**
```c
// ะัะปะพ:
addr.sin_port = htons(31337);  // ะฅะฐะบะตััะบะธะน ะฟะพัั

// ะกัะฐะฝะตั:
addr.sin_port = htons(443);    // HTTPS ะฟะพัั
```

**ะะ! ะะพัั 443 ะฟะพะดัะฐะทัะผะตะฒะฐะตั HTTPS (TLS/SSL):**

**ะะตะท ัะธััะพะฒะฐะฝะธั (ัะตะบััะฐั ะผะธััะธั):**
```c
// Episode 10:
connect(sockfd, ...);           // โ ะัะพััะพะน TCP
send(sockfd, "AUTH ...", ...);  // โ Plaintext!
```

**ะก HTTPS (ะฟะพัั 443):**
```c
// ะัะถะฝะพ ะดะพะฑะฐะฒะธัั TLS:
#include <openssl/ssl.h>

SSL_CTX *ctx = SSL_CTX_new(TLS_client_method());
SSL *ssl = SSL_new(ctx);
SSL_set_fd(ssl, sockfd);
SSL_connect(ssl);              // โ TLS handshake!

SSL_write(ssl, "AUTH ...", ...);  // โ Encrypted!
SSL_read(ssl, buffer, ...);       // โ Encrypted response
```

**Well-known ports ะธ ะธั ะฟัะพัะพะบะพะปั:**
```
ะะพัั 80   โ HTTP   (plaintext, ะฝะตะฑะตะทะพะฟะฐัะฝะพ)
ะะพัั 443  โ HTTPS  (TLS encrypted, ะฑะตะทะพะฟะฐัะฝะพ)
ะะพัั 22   โ SSH    (encrypted shell)
ะะพัั 31337โ Custom (ััะพ ัะณะพะดะฝะพ, ัะฐััะพ plaintext)
```

**ะ ะผะธััะธะธ:**
- ะกะตะนัะฐั: `203.0.113.42:31337` (plaintext TCP)
- ะะณะตะฝัั Z. ะผะพะณัั ะฟะตัะตัะฒะฐัะธัั (Episode 11!)
- ะัะปะธ ะฑั ะฑัะป HTTPS: ัะธััะพะฒะฐะฝะธะต ะทะฐัะธัะธะปะพ ะฑั ะพั sniffing

**ะะพัะตะผั V. ะะ ะธัะฟะพะปัะทัะตั 443:**
1. ะะต ัะพัะตั, ััะพะฑั ะฒัะณะปัะดะตะปะพ ะบะฐะบ HTTPS (ะผะฐัะบะธัะพะฒะบะฐ)
2. 31337 = ัะฐะบะตััะบะฐั ะบัะปััััะฐ (leet speak)
3. Plaintext ัะดะพะฑะฝะตะต ะดะปั ััะตะฑะฝัั ัะตะปะตะน

**ะฃัะพะบ:** ะะพะผะตั ะฟะพััะฐ โ ััะพ ะบะพะฝะฒะตะฝัะธั, ะฝะต ัะตัะฝะธัะตัะบะพะต ะพะณัะฐะฝะธัะตะฝะธะต.
</details>

**8. ะ Episode 11 ะฒั ัะทะฝะฐะปะธ, ััะพ ะฐะณะตะฝัั Z. ะฒะธะดัั ะฒะฐั IP safe house. ะะฐะบ ะผะพะถะฝะพ ะฑัะปะพ ัะบัััั ะตะณะพ ั ะฟะพะผะพััั NAT?**

<details>
<summary>ะัะฒะตั</summary>

**NAT (Network Address Translation) ัะบััะฒะฐะตั ะฒะฐั ัะตะฐะปัะฝัะน IP ะทะฐ ัะพััะตัะพะผ!**

**ะะะ NAT (ะฟัะพะฑะปะตะผะฐ ะฒ ะผะธััะธะธ):**
```
ะะฐั ะบะพะผะฟัััะตั: 192.168.1.100 (private)
โ ะะฐะบะตั ะบ ัะตัะฒะตัั V.:
   Source IP: 192.168.1.100  โ ะะพ ััะพ private! ะะต ัะฐะฑะพัะฐะตั!
```

**ะก NAT (ะทะฐัะธัะฐ):**
```
          Safe House Network
          
  ะะฐั ะบะพะผะฟัััะตั              Router (NAT)         ะะฝัะตัะฝะตั
  192.168.1.100 โโโโโโโ  [NAT] โโโโโโโ  ะกะตัะฒะตั V.
                         Public IP:     203.0.113.42
                         203.0.113.50
                         
ะะฐะบะตั ะะ NAT:
  Source: 192.168.1.100:54321
  Dest:   203.0.113.42:31337

ะะฐะบะตั ะะะกะะ NAT:
  Source: 203.0.113.50:12345  โ ะะฐั IP ัะบััั!
  Dest:   203.0.113.42:31337
```

**ะะฐะบ NAT ะทะฐัะธัะฐะตั:**
1. **ะกะบััะฒะฐะตั ะฒะฝัััะตะฝะฝะธะน IP:**
   - ะกะตัะฒะตั V. ะฒะธะดะธั ัะพะปัะบะพ public IP ัะพััะตัะฐ
   - ะะต ะทะฝะฐะตั ะฒะฐั ัะตะฐะปัะฝัะน 192.168.1.100

2. **ะะตะฒะพะทะผะพะถะฝะพ ะฟะพะดะบะปััะธัััั ะธะทะฒะฝะต:**
   - ะะณะตะฝัั Z. ะฝะต ะผะพะณัั ะฝะฐะฟััะผัั ะฐัะฐะบะพะฒะฐัั 192.168.1.100
   - ะะต ะผะฐัััััะธะทะธััะตััั ะฒ ะธะฝัะตัะฝะตัะต

3. **ะะดะธะฝ public IP ะดะปั ะผะฝะพะณะธั ััััะพะนััะฒ:**
   - ะะพััะตั ััะฐะฝัะปะธััะตั ะฟะพััั
   - ะญะบะพะฝะพะผะธั IPv4 ะฐะดัะตัะพะฒ

**ะ ะผะธััะธะธ (Episode 11):**
```
ะะณะตะฝัั Z. ะฟะตัะตัะฒะฐัะธะปะธ ะฟะฐะบะตั ั ะบะพะพัะดะธะฝะฐัะฐะผะธ safe house:
"Coordinates: 55.7520ยฐN 37.6175ยฐE"

ะะฐะบ ะพะฝะธ ัะทะฝะฐะปะธ?
- ะะตะพะปะพะบะฐัะธั PUBLIC IP ะฒะฐัะตะณะพ NAT ัะพััะตัะฐ!
- IP Geolocation API: Public IP โ ะฟัะธะผะตัะฝะพะต ะผะตััะพะฟะพะปะพะถะตะฝะธะต
```

**ะะฐัะธัะฐ ะพั geolocation:**
```c
// 1. VPN (ัะบััะฒะฐะตั ัะตะฐะปัะฝัะน IP)
Public IP โ VPN ัะตัะฒะตั ะฒ ะดััะณะพะน ัััะฐะฝะต โ ัะบััะฒะฐะตั ะปะพะบะฐัะธั

// 2. Tor (ะฐะฝะพะฝะธะผะฝะพััั)
ะะฐั ััะฐัะธะบ โ Tor network โ ะฝะตะฒะพะทะผะพะถะฝะพ ะพััะปะตะดะธัั

// 3. Proxy
ะะพะดะบะปััะตะฝะธะต ัะตัะตะท ะฟัะพะบัะธ-ัะตัะฒะตั
```

**NAT Table (ะฟัะธะผะตั):**
```
Internal IP:Port    โ  Public IP:Port   โ  Dest IP:Port
192.168.1.100:54321 โ  203.0.113.50:12345 โ 203.0.113.42:31337
192.168.1.101:54322 โ  203.0.113.50:12346 โ 8.8.8.8:53
```

**ะฃัะพะบ:** NAT = ะฑะฐะทะพะฒะฐั ะทะฐัะธัะฐ, ะฝะพ ะะ ะฟะพะปะฝะฐั ะฐะฝะพะฝะธะผะฝะพััั!
</details>

---

### ๐ด ะะฝะฐะปะธะท ะบะพะดะฐ (2 ะฒะพะฟัะพัะฐ)

**9. ะั ะฟััะฐะตัะตัั ะฟะพะดะบะปััะธัััั ะบ ัะตัะฒะตัั V., ะฝะพ ะฟะพะปััะฐะตัะต ะพัะธะฑะบั. ะ ััะผ ะฟัะพะฑะปะตะผะฐ?**

```c
struct sockaddr_in addr;
addr.sin_family = AF_INET;
addr.sin_port = 31337;  // โ ะะะะะะะะ?
inet_pton(AF_INET, "203.0.113.42", &addr.sin_addr);
connect(sockfd, (struct sockaddr*)&addr, sizeof(addr));
// โ Connection refused!
```

<details>
<summary>ะัะฒะตั</summary>

**ะัะธะฑะบะฐ: ะทะฐะฑัะปะธ `htons()` ะดะปั ะฟะพััะฐ!**

**ะงัะพ ะฟัะพะธััะพะดะธั:**
```c
addr.sin_port = 31337;  // โ Host byte order!

// ะะฐ Intel (little-endian):
31337 decimal = 0x7A69 hex
ะ ะฟะฐะผััะธ: [69 7A]

// ะ ัะตัั ะพัะฟัะฐะฒะปัะตััั: 0x697A = 26985 decimal
// ะััะฐะตัะตัั ะฟะพะดะบะปััะธัััั ะบ ะฟะพััั 26985 ะฒะผะตััะพ 31337!
// ะกะตัะฒะตั V. ะฝะฐ 31337 โ Connection refused!
```

**ะัะฟัะฐะฒะปะตะฝะธะต:**
```c
struct sockaddr_in addr;
addr.sin_family = AF_INET;
addr.sin_port = htons(31337);  // โ Network byte order!
inet_pton(AF_INET, "203.0.113.42", &addr.sin_addr);
connect(sockfd, (struct sockaddr*)&addr, sizeof(addr));
// โ Connected to V.'s server!
```

**ะ ะผะธััะธะธ:**
- Episode 10: ะฟะพะดะบะปััะตะฝะธะต ะบ ัะตัะฒะตัั V. ะฝะฐ 31337
- ะะะ `htons()` = ะฝะตะฟัะฐะฒะธะปัะฝัะน ะฟะพัั = failure
- ะก `htons()` = correct port = success!

**ะัะพะฒะตัะบะฐ ะฒ ip_converter:**
```bash
$ ./ip_converter 203.0.113.42
Binary Format:
  Network byte order: 0xCB00712A
  Host byte order:    0x2A7100CB  โ ะะฐะทะฝัะต!
```

**ะฃัะพะบ:** `htons()` ะะะฏะะะขะะะะ ะดะปั ะฟะพััะพะฒ, `htonl()` ะดะปั IP!
</details>

**10. ะ `net_analyzer` ะฒั ะฟะฐััะธัะต IP ะธะท ัะฐะนะปะฐ. ะงัะพ ะฝะต ัะฐะบ?**

```c
FILE *f = fopen("addresses.txt", "r");
char line[256];
while (fgets(line, sizeof(line), f)) {
    struct in_addr addr;
    addr.s_addr = inet_addr(line);  // โ ะะะะะะะะ?
    
    if (ntohl(addr.s_addr) == 0xCB00712A) {
        printf("Found V.'s server!\n");
    }
}
```

<details>
<summary>ะัะฒะตั</summary>

**ะัะธะฑะบะธ: `inet_addr()` deprecated + ะฝะต ัะดะฐะปัะตััั `\n` ะธะท ัััะพะบะธ!**

**ะัะพะฑะปะตะผะฐ 1: `\n` ะฒ ะบะพะฝัะต ัััะพะบะธ**
```c
fgets(line, ...) โ "203.0.113.42\n"  โ ะะธัะฝะธะน ัะธะผะฒะพะป!
inet_addr("203.0.113.42\n") โ INVALID!
```

**ะัะพะฑะปะตะผะฐ 2: `inet_addr()` ะฝะต ะฟัะพะฒะตััะตั ะพัะธะฑะบะธ**
```c
// ะงัะพ ะตัะปะธ ะฒ ัะฐะนะปะต ะผััะพั?
"invalid.ip.here\n" โ inet_addr() โ INADDR_NONE (0xFFFFFFFF)
// ะะพ 255.255.255.255 โ ะฒะฐะปะธะดะฝัะน IP! ะััะฐะฝะธัะฐ!
```

**ะัะฟัะฐะฒะปะตะฝะธะต:**
```c
FILE *f = fopen("addresses.txt", "r");
char line[256];
while (fgets(line, sizeof(line), f)) {
    // 1. ะฃะดะฐะปะธัั \n
    line[strcspn(line, "\n")] = '\0';
    
    // 2. ะัะฟะพะปัะทะพะฒะฐัั inet_pton (ั ะฟัะพะฒะตัะบะพะน)
    struct in_addr addr;
    if (inet_pton(AF_INET, line, &addr) == 1) {
        // ะะฐะปะธะดะฝัะน IP!
        if (ntohl(addr.s_addr) == 0xCB00712A) {
            printf("๐ฏ Found: 203.0.113.42 โ RED SQUARE!\n");
        }
    } else {
        printf("โ๏ธ  Invalid IP: %s\n", line);
        // ะัะพะฟััะบะฐะตะผ ะผััะพั
    }
}
fclose(f);
```

**ะ ะผะธััะธะธ:**
- `addresses.txt` ัะพะดะตัะถะธั ะผะฝะพะณะพ IP
- ะะพะถะตั ะฑััั ะผััะพั, ะบะพะผะผะตะฝัะฐัะธะธ, ะฟััััะต ัััะพะบะธ
- `inet_pton()` ัะธะปััััะตั ะฝะตะฒะฐะปะธะดะฝัะต โ ะฝะฐัะพะดะธั ัะพะปัะบะพ 203.0.113.42

**ะฃัะพะบ:** ะัะตะณะดะฐ ะฒะฐะปะธะดะธััะนัะต ะฒะฒะพะด! `fgets()` ัะพััะฐะฝัะตั `\n`.
</details>

---

### ๐ฏ ะกัะถะตั (2 ะฒะพะฟัะพัะฐ)

**11. IP `203.0.113.42` ะดะตะบะพะดะธััะตััั ะฒ GPS 55.7558ยฐN 37.6173ยฐE (ะัะฐัะฝะฐั ะฟะปะพัะฐะดั). ะะดะต ะธะผะตะฝะฝะพ ะฝะฐ ะฟะปะพัะฐะดะธ ะฒัััะตัะฐ?**

<details>
<summary>ะัะฒะตั</summary>

**ะกะฟะฐััะบะฐั ะฑะฐัะฝั ะัะตะผะปั** โ ะณะปะฐะฒะฝัะน ะฒัะพะด ะัะตะผะปั, ัะฐะผะฐั ะธะทะฒะตััะฝะฐั ะฑะฐัะฝั!

**ะขะพัะฝัะต ะบะพะพัะดะธะฝะฐัั:**
```
Latitude:  55.7558ยฐN
Longitude: 37.6173ยฐE
ะขะพัะฝะพััั:  ยฑ10 ะผะตััะพะฒ
ะะพะบะฐัะธั:   ะกะฟะฐััะบะฐั ะฑะฐัะฝั (Spasskaya Tower)
```

**ะะฐะบ V. ะทะฐะบะพะดะธัะพะฒะฐะป:**
```
IP: 203.0.113.42

ะะฝัะตัะฟัะตัะฐัะธั 1 (ะพะบัะตัั โ ะบะพะพัะดะธะฝะฐัั):
203.0  โ 55.75 (ัะธัะพัะฐ, ะดะพะฑะฐะฒะธัั ะบะพะฝััะฐะฝัั)
113.42 โ 37.61 (ะดะพะปะณะพัะฐ, ะดะพะฑะฐะฒะธัั ะบะพะฝััะฐะฝัั)

ะะฝัะตัะฟัะตัะฐัะธั 2 (hex โ GPS):
0xCB00712A โ ะฑะธัะพะฒัะต ะผะฐะฝะธะฟัะปััะธะธ โ 55.7558, 37.6173
```

**ะ ะผะธััะธะธ:**
```
Episode 09 (04:27) โ ะะฑะฝะฐััะถะตะฝะพ PATTERN: GPS coordinates
Episode 12 (08:00) โ ะัััะตัะฐ ั ะกะฟะฐััะบะพะน ะฑะฐัะฝะธ
```

**ASCII ะบะฐััะฐ ะธะท DEBRIEFING:**
```
        ะะะกะะะ (ะัะฐัะฝะฐั ะฟะปะพัะฐะดั)
        
            ะัะตะผะปั
         โโโโโโโโโโโโโโ
         โ            โ
   ะะฐัะฝั โ   [โช]      โ  ะกะฟะฐััะบะฐั
ะะธะบะพะปััะบะฐัโ            โ  ะฑะฐัะฝั โ ะะะะกะฌ!
         โ            โ  55.7558ยฐN
         โโโโโโโโโโโโโโ  37.6173ยฐE
              โ
         ะัะฐัะฝะฐั ะฟะปะพัะฐะดั
              โ
         ะกะพะฑะพั ะะฐัะธะปะธั
         ะะปะฐะถะตะฝะฝะพะณะพ
```

**ะะพัะตะผั ะกะฟะฐััะบะฐั ะฑะฐัะฝั:**
- ะกะฐะผะฐั ะทะฝะฐะผะตะฝะธัะฐั ะฑะฐัะฝั ะัะตะผะปั
- ะะปะฐะฒะฝัะน ะฒัะพะด (ะดะปั ะฒะฐะถะฝัั ะฟะตััะพะฝ)
- ะงะฐัั-ะบััะฐะฝัั (ัะธะผะฒะพะป ัะพัะฝะพััะธ ะฒัะตะผะตะฝะธ)
- ะัะฑะปะธัะฝะพะต ะผะตััะพ (ะฑะตะทะพะฟะฐัะฝะตะต ะดะปั ะฒัััะตัะธ)

**ะ Episode 12:**
```
08:00 โ ะั ััะพะธัะต ั ะกะฟะฐััะบะพะน ะฑะฐัะฝะธ
        ะัะตะฝะฝะธะน ััะผะฐะฝ. ะะฐะฝะฝะตะต ัััะพ.
        
        ะงะตะปะพะฒะตะบ ะฒ ัััะฝะพะผ ะฟะฐะปััะพ ะฟะพะดัะพะดะธั.
        "ะขั ะฟัะธััะป," โ V.
        
        ะะฝ ะฟะตัะตะดะฐัั USB-ัะปะตัะบั:
        "Season 4: Crypto & Algorithms"
```

**ะฃัะพะบ:** ะะพะพัะดะธะฝะฐัั โ ะฝะต ะฟัะพััะพ ัะธัะปะฐ. ะญัะพ ะผะตััะพ ะฒัััะตัะธ, ะผะตััะพ ะธััะพัะธะธ.
</details>

**12. ะ 04:47 ะฒั ะฟะพะปััะธะปะธ SMS ะพั UNKNOWN: "ะขั ัะปะธัะบะพะผ ะฑะปะธะทะบะพ. ะััะฐะฝะพะฒะธัั." ะัะพ ััะพ ะธ ะบะฐะบ ะพะฝะธ ัะทะฝะฐะปะธ ะฟัะพ ะฒะฐั ะฟัะพะณัะตัั?**

<details>
<summary>ะัะฒะตั</summary>

**UNKNOWN = ะฐะณะตะฝัั Z., ะพะฝะธ ะพััะปะตะถะธะฒะฐัั ะฒะฐั ั ัะฐะผะพะณะพ ะฝะฐัะฐะปะฐ!**

**ะะฐะบ ะพะฝะธ ัะทะฝะฐะปะธ:**

**1. ะะตัะตัะฒะฐั ััะฐัะธะบะฐ (Episode 11):**
```c
// ะะณะตะฝัั Z. ะธัะฟะพะปัะทััั packet sniffing:
int sockfd = socket(AF_INET, SOCK_RAW, IPPROTO_TCP);
// ะะธะดัั ะะกะ ะฒะฐัะธ ะฟะฐะบะตัั ะฝะฐ ะฟะพััั 31337

// ะั โ ะกะตัะฒะตั V. (203.0.113.42:31337)
// ะะณะตะฝัั ะฟะตัะตัะฒะฐััะฒะฐัั โ "ะะฝ ะฝะฐััะป ะฐะดัะตั!"
```

**2. ะะพะฝะธัะพัะธะฝะณ ัะตัะธ:**
```
04:27 โ ะั ะดะตะบะพะดะธัะพะฒะฐะปะธ 203.0.113.42
        ะะฐั net_analyzer ะฟะพะดะบะปััะธะปัั ะบ ัะตัะฒะตัั
        
04:27 โ ะะณะตะฝัั Z. ะฒะธะดัั:
        ะะฐั IP โ 203.0.113.42:31337
        "Target approaching V.'s server!"
        
04:47 โ SMS ะพัะฟัะฐะฒะปะตะฝะฐ (ัะตัะตะท 20 ะผะธะฝัั)
        "ะขั ัะปะธัะบะพะผ ะฑะปะธะทะบะพ. ะััะฐะฝะพะฒะธัั."
        ะะพะฟััะบะฐ ะฝะฐะฟัะณะฐัั/ะพััะฐะฝะพะฒะธัั
```

**3. ะะพะผะฟัะพะผะตัะธัะพะฒะฐะฝะฝัะน safe house (Episode 11):**
```
Safe House Network:
โโ ะะฐั ะบะพะผะฟัััะตั: 192.168.1.100
โโ Router: 192.168.1.1
โโ ะะณะตะฝั Z. ะฒ ัะตัะธ: 192.168.1.50  โ ะะฝะตะดััะฝ!

ะะณะตะฝั ะทะฐะฟััะบะฐะตั:
$ sudo tcpdump -i eth0 port 31337
โ ะะธะดะธั ะฒะฐัะต ะฟะพะดะบะปััะตะฝะธะต ะบ V.
```

**4. Geolocation (ะฒะฐั ะฟัะฑะปะธัะฝัะน IP):**
```bash
# ะะณะตะฝัั ะธัะฟะพะปัะทััั:
$ curl "http://ip-api.com/json/YOUR_PUBLIC_IP"
{
  "lat": 55.7520,  โ ะะปะธะทะบะพ ะบ ะัะฐัะฝะพะน ะฟะปะพัะฐะดะธ!
  "lon": 37.6175,
  "status": "success"
}

โ "ะะฝ ะฒ ะะพัะบะฒะต, ะฝะตะดะฐะปะตะบะพ ะพั ัะตะปะธ!"
โ ะัะฟัะฐะฒะธัั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต
```

**ะัะตะผะตะฝะฝะฐั ะปะธะฝะธั ัะณัะพะท:**
```
Episode 01 โ V. "ะฟะพะณะธะฑ" (ะธะฝััะตะฝะธัะพะฒะบะฐ)
Episode 02 โ SMS ะพั UNKNOWN: "48 ัะฐัะพะฒ" (ัะณัะพะทะฐ)
Episode 03 โ ะัะพัะพะน "V" ะฟัะตะดัะฟัะตะถะดะฐะตั: "ะปะพะฒััะบะฐ"
Episode 09 โ SMS: "ะขั ัะปะธัะบะพะผ ะฑะปะธะทะบะพ" โ ะะะะกะฌ!
Episode 10 โ DDoS-ะฐัะฐะบะฐ ะฝะฐ ัะตัะฒะตั V. (ะฟะพะฟััะบะฐ ะทะฐะฑะปะพะบะธัะพะฒะฐัั)
Episode 11 โ ะะพะพัะดะธะฝะฐัั safe house ัะฐัะบัััั
Episode 12 โ ะคะธะฝะฐะป: ะฒัััะตัะฐ ั V., ะฟะพะฑะตะณ ะพั Z.
```

**ะัะพ ัะฐะบะธะต Z.:**
- ะัะพัะธะฒะฝะธะบะธ V.
- ะัะฟะพะปัะทััั ัะต ะถะต ัะตัะฝะธะบะธ (packet sniffing, crypto)
- ะฆะตะปั: ะฟะพะผะตัะฐัั ะฒะฐะผ ะฒัััะตัะธัััั ั V.
- ะัะดัั ัะฐัะบัััั ะฒ Season 4

**ะฃัะพะบ:** ะ ะบะธะฑะตัะฟัะพัััะฐะฝััะฒะต ะทะฐ ะฒะฐะผะธ ะฒัะตะณะดะฐ ะผะพะณัั ะฝะฐะฑะปัะดะฐัั. ะจะธััะพะฒะฐะฝะธะต ะธ OpSec ะบัะธัะธัะฝั!
</details>

---

### ๐ ะัะพะดะฒะธะฝัััะต (0 ะฒะพะฟัะพัะพะฒ)

**ะัะต ะฟัะพะดะฒะธะฝัััะต ะบะพะฝัะตะฟัะธะธ ะธะฝัะตะณัะธัะพะฒะฐะฝั ะฒ ะฒะพะฟัะพัั ะฒััะต!**

---

**๐ ะัะตะฝะบะฐ:**
- **10-12 ะฟัะฐะฒะธะปัะฝัั** โ Network Master! ะะพัะพะฒั ะบ Episode 10 โ
- **7-9 ะฟัะฐะฒะธะปัะฝัั** โ ัะพัะพัะพ, ะฝะพ ะฟะพะฒัะพัะธัะต GPS-ะดะตะบะพะดะธัะพะฒะฐะฝะธะต ะธ byte order ๐
- **< 7 ะฟัะฐะฒะธะปัะฝัั** โ ะฟะตัะตัะธัะฐะนัะต Episode 09, ะทะฐะฟัััะธัะต ip_converter ๐

---

## ๐ฅ Easter Eggs

<details>
<summary>๐ ะัััะปะบะธ ะธ ัะตะบัะตัั</summary>

1. **Port 31337** โ ะบะปะฐััะธัะตัะบะธะน "ัะปะธัะฝัะน" ะฟะพัั ัะฐะบะตัะพะฒ (1337 = leet speak)
2. **203.0.113.0/24** โ TEST-NET-3, ะทะฐัะตะทะตัะฒะธัะพะฒะฐะฝะฝะฐั ัะตัั ะดะปั ะดะพะบัะผะตะฝัะฐัะธะธ (RFC 5737)
3. **8.8.8.8** โ Google Public DNS, ะพะดะฝะฐ ะธะท ัะฐะผัั ะธะทะฒะตััะฝัั IP
4. **127.0.0.1** โ "localhost", ะฐะดัะตั "home sweet home" ะดะปั ะปัะฑะพะณะพ ะบะพะผะฟัััะตัะฐ
5. **Binary 11001011** โ CB hex, ะฝะฐัะฐะปะพ ะฐะดัะตัะฐ, ะฟะตัะฒัะต ะฑะฐะนัั ัะฐััะพ ะธัะฟะพะปัะทััััั ะดะปั routing
6. **V.'s timestamp 04:27:19** โ 0x042713 hex = ะพัััะปะบะฐ ะบ ะดะฐัะต (April 27, 2013 โ ะธะทะฒะตััะฝัะน ะธะฝัะธะดะตะฝั)

**ะคะธะปะพัะพัะธั ัะฟะธะทะพะดะฐ**: *"ะกะตัั โ ััะพ ะบะฐััะฐ. IP โ ะบะพะพัะดะธะฝะฐัั. ะะพัั โ ะดะฒะตัั. ะะฐััะธัั ัะธัะฐัั ะบะฐััั."*

</details>

---

## ๐ ะะฐะฒะธะณะฐัะธั

- [โ Episode 08: Fragmentation](../../season-2-memory-and-pointers/episode-08-fragmentation/README.md)
- [โ Episode 10: Socket Programming](../episode-10-socket-programming/README.md)
- [๐ Season 3: Networks](../README.md)
- [๐ ะะปะฐะฒะฝะฐั ัััะฐะฝะธัะฐ](../../README.md)

---

> *"IP addresses are coordinates in cyberspace. Learn to navigate."* โ V.
