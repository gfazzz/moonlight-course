# Episode 12: "Encrypted Communications" ๐

> *"The final piece of the puzzle lies in the encrypted stream."*

---

## ๐ฌ BRIEFING

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะะะะะฆะะฏ: Safe House โ ะัะฐัะฝะฐั ะฟะปะพัะฐะดั, ะะพัะบะฒะฐ          โ
โ  ะะะะะฏ:   02:15, ัะตัะฒะตัะณ, 2 ะพะบััะฑัั                     โ
โ  ะกะขะะขะฃะก:  ๐ด FINAL MISSION - SEASON 3 FINALE             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะั ะฟัะพัะปะธ ััะธ ััะฐะฟะฐ: **IP-ะฐะดัะตัะฐัะธั**, **ัะพะบะตัั**, **ะฟะตัะตัะฒะฐั ะฟะฐะบะตัะพะฒ**.  
ะะณะตะฝัั Z. ัะฐัะบัััั. Safe house ัะบะพะผะฟัะพะผะตัะธัะพะฒะฐะฝ.

**ะขะตะฟะตัั โ ัะธะฝะฐะป Season 3. ะัััะตัะฐ ั V.**

ะ 02:12 ะฟัะธัะพะดะธั ะฟะพัะปะตะดะฝะตะต ัะพะพะฑัะตะฝะธะต V.:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  FROM: V. (ENCRYPTED CHANNEL)               โ
โ  TIME: 02:12:58 UTC                         โ
โ  PRIORITY: ๐ด FINAL                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                             โ
โ  ะญัะพ ัะธะฝะฐะป Season 3.                        โ
โ  ะัั, ัะตะผั ัั ะฝะฐััะธะปัั, ัะพะฑะตััััั ะฒะพะตะดะธะฝะพ.  โ
โ                                             โ
โ  ะกะะขะฃะะฆะะฏ:                                  โ
โ  ะะฒะฐ ะฐะณะตะฝัะฐ Z. ะพะฑะผะตะฝะธะฒะฐัััั ะทะฐัะธััะพะฒะฐะฝะฝัะผะธ  โ
โ  ะดะฐะฝะฝัะผะธ. ะ ัะพะพะฑัะตะฝะธัั โ ะดะตัะฐะปะธ ะฒัััะตัะธ.    โ
โ                                             โ
โ  ะะดัะตั: 10.0.0.1:4433                       โ
โ  ะัะพัะพะบะพะป: TCP ั XOR ัะธััะพะฒะฐะฝะธะตะผ            โ
โ  ะะปัั: ะัััะพะตะฝ ะฒ ะฟะตัะฒัะน ะฟะฐะบะตั (KEY:0x??)    โ
โ                                             โ
โ  ะะะะะงะ:                                    โ
โ  1. ะะตัะตัะฒะฐัะธัั TCP-ะฟะพัะพะบ (Episode 11)      โ
โ  2. ะะตะบะพะฝััััะธัะพะฒะฐัั ัะตััะธั ะฟะพ seq          โ
โ  3. ะะทะฒะปะตัั ะบะปัั ะธะท ะฟะตัะฒะพะณะพ ะฟะฐะบะตัะฐ          โ
โ  4. ะะฐััะธััะพะฒะฐัั XOR (Episode 01)           โ
โ  5. ะะพะปััะธัั ะะะะะะะะะขะซ ะะกะขะะะงะ             โ
โ                                             โ
โ  ะะฐััะธัััะน ััะพ โ ัะทะฝะฐะตัั, ะณะดะต ะผะตะฝั ะฝะฐะนัะธ.   โ
โ                                             โ
โ  ะญัะพ ะฟัะพะฒะตัะบะฐ ะะกะะฅ ัะฒะพะธั ะฝะฐะฒัะบะพะฒ.           โ
โ  ะฃะดะฐัะธ. ะขั ะณะพัะพะฒ. ะฃะฒะธะดะธะผัั.                 โ
โ                                             โ
โ  โ V.                                       โ
โ                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### โฑ๏ธ ะัะตะผะตะฝะฝะฐั ะปะธะฝะธั ัะธะฝะฐะปะฐ

```
ะงะะขะะะะ, 2 ะะะขะฏะะะฏ

02:12 โ ๐ง ะคะธะฝะฐะปัะฝะฐั ะธะฝััััะบัะธั ะพั V.
        ะะตัะตัะฒะฐัะธัั ะทะฐัะธััะพะฒะฐะฝะฝัะน ะฟะพัะพะบ ะฝะฐ 10.0.0.1:4433
        ะะฐััะธััะพะฒะฐัั โ ัะทะฝะฐัั ะผะตััะพ ะฒัััะตัะธ
        
02:15 โ ๐๏ธ ะะฐะทัะฐะฑะพัะบะฐ comm_interceptor
        ะะฝัะตะณัะฐัะธั ะฒัะตั ะฝะฐะฒัะบะพะฒ Season 3:
        - Raw sockets (Ep11)
        - TCP reconstruction (Ep12 ัะตะพัะธั)
        - XOR decryption (Ep01!)
        
03:30 โ ๐ ะะฐะฟััะบ ะฟะตัะตัะฒะฐััะธะบะฐ
        $ sudo ./comm_interceptor
        
        Listening for encrypted traffic on port 4433...
        
03:31 โ ๐ก ะะฐัะฒะฐั TCP ะฟะพัะพะบะฐ
        [Session detected] 10.0.0.1:54321 โ 10.0.0.1:4433
        Captured 8 packets, reconstructing stream...
        
03:45 โ ๐ข ะะตะบะพะฝััััะบัะธั ัะตััะธะธ
        Sorting by sequence number... โ
        [Packet 1] SEQ=1000, len=15: "KEY:0x42\n..."
        [Packet 2] SEQ=1015, len=50
        [Packet 3] SEQ=1065, len=100
        ... (8 packets total)
        
04:00 โ ๐ ะะทะฒะปะตัะตะฝะธะต ะบะปััะฐ
        Extracting key from first packet... โ
        Key: 0x42 (Answer to Everything!)
        
04:15 โ ๐ ะะะกะจะะคะะะะะ XOR
        Assembling stream... โ (225 bytes)
        Decrypting with XOR key 0x42...
        
04:30 โ ๐ฏ ะกะะะะฉะะะะ ะะะกะจะะคะะะะะะ!
        
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  ะคะะะะะฌะะะ ะกะะะะฉะะะะ ะะข V.:               โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
        โ                                           โ
        โ  ะะพะทะดัะฐะฒะปัั, ะฐะณะตะฝั.                       โ
        โ                                           โ
        โ  ะขั ะพัะฒะพะธะป ัะตัะธ. ะขั ะณะพัะพะฒ ะบ ะฒัััะตัะต.      โ
        โ                                           โ
        โ  ะะะะะะะะะขะซ:                              โ
        โ  55.7558ยฐN 37.6173ยฐE                      โ
        โ  (ะัะฐัะฝะฐั ะฟะปะพัะฐะดั, ะกะฟะฐััะบะฐั ะฑะฐัะฝั)        โ
        โ                                           โ
        โ  ะะะะะฏ:                                   โ
        โ  ะััะฝะธัะฐ, 3 ะพะบััะฑัั, 08:00 UTC            โ
        โ                                           โ
        โ  ะัะธัะพะดะธ ะพะดะธะฝ. ะะธะบะพะผั ะฝะต ะณะพะฒะพัะธ.          โ
        โ  ะะฐะปัะฝะตะนัะธะต ะธะฝััััะบัะธะธ โ ะปะธัะฝะพ.           โ
        โ                                           โ
        โ  Season 4: Crypto & Algorithms ะถะดัั.      โ
        โ                                           โ
        โ  ะะพ ะฒัััะตัะธ ะฝะฐ ะฟะปะพัะฐะดะธ.                   โ
        โ  โ Viktor                                 โ
        โ                                           โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        
05:00 โ ๐ก ะะกะะะะะะะ
        ะะพะพัะดะธะฝะฐัั ัะต ะถะต, ััะพ ะฒ IP 203.0.113.42 (Ep09)!
        ะัั ะฑัะปะพ ัะฟะปะฐะฝะธัะพะฒะฐะฝะพ ั ัะฐะผะพะณะพ ะฝะฐัะฐะปะฐ.
        
06:47 โ โ Season 3 ะะะะะะจะะ
        ะัะต ะฝะฐะฒัะบะธ ะพัะฒะพะตะฝั.
        ะัััะตัะฐ ะฝะฐะทะฝะฐัะตะฝะฐ.
        
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะฏะขะะะฆะ, 3 ะะะขะฏะะะฏ

08:00 โ ๐ ะะะะกะะะฏ ะะะะฉะะะฌ, ะะะกะะะ
        
        ะั ััะพะธัะต ั ะกะฟะฐััะบะพะน ะฑะฐัะฝะธ ะัะตะผะปั.
        ะัะตะฝะฝะธะน ััะผะฐะฝ. ะะฐะฝะฝะตะต ัััะพ.
        
        ะงะตะปะพะฒะตะบ ะฒ ัััะฝะพะผ ะฟะฐะปััะพ ะฟะพะดัะพะดะธั ะบ ะฒะฐะผ.
        
        "ะขั ะฟัะธััะป," โ ะณะพะฒะพัะธั ะพะฝ.
        "Season 3 ะฟัะพะนะดะตะฝ. ะขะตะฟะตัั โ ัะตัััะทะฝะตะต."
        
        ะะฝ ะฟะตัะตะดะฐัั ะฒะฐะผ USB-ัะปะตัะบั.
        
        "Season 4: Crypto & Algorithms.
         ะะดะตัั ะฒัั, ััะพ ัะตะฑะต ะฝัะถะฝะพ.
         ะกะธะผะผะตััะธัะฝะพะต ัะธััะพะฒะฐะฝะธะต.
         ะฅัั-ััะฝะบัะธะธ. Blockchain.
         ะะปะณะพัะธัะผั."
         
        "ะะฟะตัะฐัะธั MOONLIGHT ะฟัะพะดะพะปะถะฐะตััั.
         ะฃะฒะธะดะธะผัั ะฒ Season 4."
         
        ะะฝ ัะฐััะฒะพััะตััั ะฒ ััะผะฐะฝะต.
        
        ะั ัะผะพััะธัะต ะฝะฐ ัะปะตัะบั.
        ะญัะธะบะตัะบะฐ: "S4: CRYPTO & ALGORITHMS"
        
        โ SEASON 3: NETWORKS โ COMPLETE!
        ๐ SEASON 4: CRYPTO & ALGORITHMS โ UNLOCKED!
```

**ะงัะพ ะฒั ะฟะพะฝะธะผะฐะตัะต:**
- ะญัะพ **ะธะฝัะตะณัะฐัะธั** ะฒัะตั ัะฟะธะทะพะดะพะฒ Season 3
- ะัะถะฝะพ ะพะฑัะตะดะธะฝะธัั **packet sniffing** + **TCP session tracking** + **XOR decryption**
- **Sequence numbers** ะฟะพะผะพะณัั ัะฟะพััะดะพัะธัั ะฟะฐะบะตัั
- **ะะตัะฒัะน ะฟะฐะบะตั** ัะพะดะตัะถะธั ะบะปัั ัะธััะพะฒะฐะฝะธั (KEY:0x42)
- **ะคะธะฝะฐะปัะฝะพะต ัะพะพะฑัะตะฝะธะต** = ะบะพะพัะดะธะฝะฐัั ะฒัััะตัะธ ะฝะฐ ะัะฐัะฝะพะน ะฟะปะพัะฐะดะธ
- **ะัััะตัะฐ ั V.** = ะผะพัั ะบ Season 4

ะญัะพ **ะผะพะผะตะฝั ะธััะธะฝั**. ะัั, ััะพ ะฒั ะธะทััะธะปะธ, ะดะพะปะถะฝะพ ััะฐะฑะพัะฐัั.  
**ะคะธะฝะฐะป Season 3. ะะฐัะฐะปะพ Season 4.**

### ๐ฏ ะะะะะงะ

ะกะพะทะดะฐัั **`comm_interceptor`** โ ัะธััะตะผั ะฟะตัะตัะฒะฐัะฐ ะทะฐัะธััะพะฒะฐะฝะฝัั ะบะพะผะผัะฝะธะบะฐัะธะน:
1. โ ะะตัะตัะฒะฐัะธัั TCP ััะฐัะธะบ ะฝะฐ ะฟะพััั 4433 (raw sockets)
2. โ ะะตะบะพะฝััััะธัะพะฒะฐัั TCP ัะตััะธั ะฟะพ sequence numbers
3. โ ะฃะฟะพััะดะพัะธัั ะฟะฐะบะตัั ะฟะพ seq
4. โ ะะทะฒะปะตัั ะบะปัั ะธะท ะฟะตัะฒะพะณะพ ะฟะฐะบะตัะฐ
5. โ ะะฑัะตะดะธะฝะธัั payload ะฒัะตั ะฟะฐะบะตัะพะฒ
6. โ ะะฐััะธััะพะฒะฐัั XOR
7. โ ะะพะปััะธัั ัะธะฝะฐะปัะฝะพะต ัะพะพะฑัะตะฝะธะต V.

**ะกะปะพะถะฝะพััั:** ๐ด Hard (Finale)  
**ะะพะฒัะต ะฝะฐะฒัะบะธ:** TCP session reconstruction, packet ordering, stream assembly

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  [!] ะคะะะะะฌะะะฏ ะะะกะกะะฏ SEASON 3               โ
โ  ะัะต ะฝะฐะฒัะบะธ ัะพะฑะตััััั ะฒะพะตะดะธะฝะพ:               โ
โ  - XOR (Episode 01)                          โ
โ  - IP ะฐะดัะตัะฐัะธั (Episode 09)                 โ
โ  - ะกะพะบะตัั (Episode 10)                       โ
โ  - Packet sniffing (Episode 11)              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ญ ะะะขะะคะะะ: TCP Session = ะะฐะทะพัะฒะฐะฝะฝะพะต ะฟะธััะผะพ

**ะัะตะดััะฐะฒััะต:**  
ะั ะฟะตัะตัะฒะฐัะธะปะธ ะฟะธััะผะพ ะพั ะฐะณะตะฝัะพะฒ Z., ะฝะพ ะพะฝะพ **ัะฐะทะพัะฒะฐะฝะพ ะฝะฐ 8 ะบััะพัะบะพะฒ** ะธ ะฟะตัะตะผะตัะฐะฝะพ. ะะฐะถะดัะน ะบััะพัะตะบ ะฟัะพะฝัะผะตัะพะฒะฐะฝ (sequence number), ะฝะพ ะพะฝะธ ะปะตะถะฐั ะฒ ัะปััะฐะนะฝะพะผ ะฟะพััะดะบะต.

**ะะฐัะฐ ะทะฐะดะฐัะฐ:**
1. **ะกะพะฑัะฐัั ะบััะพัะบะธ** ะฒ ะฟัะฐะฒะธะปัะฝะพะผ ะฟะพััะดะบะต (ะฟะพ ะฝะพะผะตัะฐะผ)
2. **ะกะบะปะตะธัั ะฟะธััะผะพ** ะพะฑัะฐัะฝะพ
3. **ะัะพัะธัะฐัั ัะพะดะตัะถะธะผะพะต**

**ะ ัะตัะธ (TCP Session Reconstruction):**

```
ะะะะะขะซ Z. ะะขะะะะะะะ ะะะจะะคะะะะะะะะ ะกะะะะฉะะะะ:

Packet 3: SEQ=1065, len=100, payload="Coordinates: 55..."
Packet 1: SEQ=1000, len=15,  payload="KEY:0x42\n..."
Packet 4: SEQ=1165, len=75,  payload="7558ยฐN 37.6173ยฐE..."
Packet 2: SEQ=1015, len=50,  payload="ะะพะทะดัะฐะฒะปัั, ะฐะณะตะฝั..."

โ ะะตะฟัะฐะฒะธะปัะฝัะน ะฟะพััะดะพะบ โ ะผััะพั ะฟัะธ ัะฐััะธััะพะฒะบะต!

ะกะะะขะะะะะะ ะะ SEQ:
Packet 1: SEQ=1000 (KEY:0x42)      โ ะะฐัะฐะปะพ!
Packet 2: SEQ=1015 (ะะพะทะดัะฐะฒะปัั...) โ 1000 + 15 = 1015 โ
Packet 3: SEQ=1065 (Coordinates...) โ 1015 + 50 = 1065 โ
Packet 4: SEQ=1165 (7558ยฐN...)      โ 1065 + 100 = 1165 โ

โ ะัะฐะฒะธะปัะฝัะน ะฟะพััะดะพะบ โ ััะฟะตัะฝะฐั ัะฐััะธััะพะฒะบะฐ!
```

**ASCII-ะดะธะฐะณัะฐะผะผะฐ ะฟัะพัะตััะฐ:**

```
STEP 1: ะะะะะฅะะะข ะะะะะขะะ (packet sniffing)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Port 4433:
โโโโโโโ โโโโโโโ โโโโโโโ โโโโโโโ
โ P3  โ โ P1  โ โ P4  โ โ P2  โ  โ ะะฐะบะตัั ะฒ ัะปััะฐะนะฝะพะผ ะฟะพััะดะบะต!
โ1065 โ โ1000 โ โ1165 โ โ1015 โ
โโโโโโโ โโโโโโโ โโโโโโโ โโโโโโโ

STEP 2: ะกะะะขะะะะะะ (packet_sorter.c)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
qsort(packets, count, sizeof(Packet), compare_seq);

โโโโโโโ โโโโโโโ โโโโโโโ โโโโโโโ
โ P1  โ โ P2  โ โ P3  โ โ P4  โ  โ ะััะพััะธัะพะฒะฐะฝั!
โ1000 โ โ1015 โ โ1065 โ โ1165 โ
โโโโโโโ โโโโโโโ โโโโโโโ โโโโโโโ
   โ       โ       โ       โ
[KEY] [DATA1] [DATA2] [DATA3]

STEP 3: ะกะะะะะ ะะะขะะะ (stream reassembly)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
char stream[10000];
for (i = 0; i < count; i++) {
    memcpy(stream + stream_len, packets[i].payload, ...);
}

Result: "KEY:0x42\nะะพะทะดัะฐะฒะปัั, ะฐะณะตะฝั...Coordinates: 55.7558ยฐN 37.6173ยฐE..."

STEP 4: ะะะกะจะะคะะะะะ (XOR decryption)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
uint8_t key = 0x42;  // ะะทะฒะปะตััะฝ ะธะท ะฟะตัะฒะพะณะพ ะฟะฐะบะตัะฐ
for (i = 0; i < len; i++) {
    decrypted[i] = encrypted[i] ^ key;
}

Result: Readable message!
```

**ะะพัะตะผั TCP ัะฐะทะฑะธะฒะฐะตั ะฝะฐ ะฟะฐะบะตัั:**

```
1. **MTU (Maximum Transmission Unit):**
   Ethernet MTU = 1500 ะฑะฐะนั
   โโ IP header: 20 ะฑะฐะนั
   โโ TCP header: 20 ะฑะฐะนั
   โโ Payload: 1460 ะฑะฐะนั (ะผะฐะบัะธะผัะผ!)
   
   ะกะพะพะฑัะตะฝะธะต 350 ะฑะฐะนั โ 1 ะฟะฐะบะตั (ะฟะพะผะตัะฐะตััั)
   ะกะพะพะฑัะตะฝะธะต 5000 ะฑะฐะนั โ 4 ะฟะฐะบะตัะฐ (ะฝะต ะฟะพะผะตัะฐะตััั)

2. **Routing:**
   ะะฐะบะตัั ะผะพะณัั ะธะดัะธ ัะฐะทะฝัะผะธ ะผะฐัััััะฐะผะธ
   โ ะัะธัะพะดัั ะฒ ัะฐะทะฝะพะผ ะฟะพััะดะบะต
   โ SEQ number ะณะฐัะฐะฝัะธััะตั ะฟัะฐะฒะธะปัะฝัั ัะฑะพัะบั

3. **Retransmission:**
   ะัะปะธ ะฟะฐะบะตั ะฟะพัะตััะฝ โ ะฟะตัะตะพัะฟัะฐะฒะบะฐ ัะพะปัะบะพ ััะพะณะพ ะฟะฐะบะตัะฐ
   (ะฐ ะฝะต ะฒัะตะณะพ ัะพะพะฑัะตะฝะธั!)
```

**ะ ะผะธััะธะธ (Episode 12):**

```
02:15 โ ะะฐะฟััะบ comm_interceptor
03:00 โ ะะตัะตัะฒะฐั ะฝะฐัะฐะปะฐpackets ะฝะฐ 10.0.0.1:4433

03:45 โ ะะพะปััะตะฝะพ 8 ะฟะฐะบะตัะพะฒ (ะฝะตัะฟะพััะดะพัะตะฝะฝัั):
        [Pkt 3] SEQ=1065  "Coordinates..."
        [Pkt 1] SEQ=1000  "KEY:0x42..."
        [Pkt 4] SEQ=1165  "7558ยฐN..."
        [Pkt 2] SEQ=1015  "ะะพะทะดัะฐะฒะปัั..."
        [Pkt 5] SEQ=1240  "..."
        [Pkt 6] SEQ=1300  "..."
        [Pkt 7] SEQ=1340  "..."
        [Pkt 8] SEQ=1365  FIN (ะฟะพัะปะตะดะฝะธะน!)

04:00 โ ะกะพััะธัะพะฒะบะฐ ะฟะพ SEQ (qsort)
04:15 โ ะัะพะฒะตัะบะฐ ัะตะปะพััะฝะพััะธ (gaps detection)
04:20 โ ะกะฑะพัะบะฐ ะฟะพัะพะบะฐ (stream reassembly)
04:25 โ ะะทะฒะปะตัะตะฝะธะต ะบะปััะฐ: 0x42
04:30 โ ะะฐััะธััะพะฒะบะฐ (XOR)
04:35 โ ะฃะกะะะฅ! ะะพะพัะดะธะฝะฐัั: 55.7558ยฐN 37.6173ยฐE (ะัะฐัะฝะฐั ะฟะปะพัะฐะดั!)
```

**ะะปััะตะฒัะต ััะฝะบัะธะธ:**

```c
// 1. ะกะพััะธัะพะฒะบะฐ
int compare_seq(const void *a, const void *b) {
    return (pa->seq > pb->seq) - (pa->seq < pb->seq);
}
qsort(packets, count, sizeof(Packet), compare_seq);

// 2. ะัะพะฒะตัะบะฐ ัะตะปะพััะฝะพััะธ
for (int i = 1; i < count; i++) {
    uint32_t expected = packets[i-1].seq + packets[i-1].len;
    if (packets[i].seq != expected) {
        printf("GAP! Missing %u bytes\n", packets[i].seq - expected);
    }
}

// 3. ะกะฑะพัะบะฐ
for (int i = 0; i < count; i++) {
    memcpy(stream + stream_len, packets[i].payload, packets[i].len);
    stream_len += packets[i].len;
}

// 4. ะะฐััะธััะพะฒะบะฐ
for (int i = 0; i < stream_len; i++) {
    decrypted[i] = stream[i] ^ 0x42;
}
```

**ะฃัะพะบ:** TCP ะณะฐัะฐะฝัะธััะตั ะฟะพััะดะพะบ, ะฝะพ ะฟัะธ passive sniffing **ะฒั** ะดะพะปะถะฝั ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐัั ัะตััะธั ะฒัััะฝัั!

---

## ๐ ะขะตะพัะธั: TCP Session Reconstruction

### ๐ก ะะฐัะตะผ ััะพ ะฝัะถะฝะพ ะฒ ัะตะฐะปัะฝะพััะธ?

**Session reconstruction** ะธัะฟะพะปัะทัะตััั ะฒ:
- ๐ **Network forensics**: ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต ะดะฐะฝะฝัั ะฟะพัะปะต ะธะฝัะธะดะตะฝัะฐ
- ๐ก๏ธ **IDS/IPS**: ะฐะฝะฐะปะธะท ะฐัะฐะบ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
- ๐ **Traffic analysis**: ะฟะพะฝะธะผะฐะฝะธะต ะฟะพะปะฝะพะณะพ ะบะพะฝัะตะบััะฐ ะบะพะผะผัะฝะธะบะฐัะธะธ
- ๐ **Malware analysis**: ะธะทะฒะปะตัะตะฝะธะต C&C ะบะพะผะฐะฝะด
- ๐ก **Protocol reverse engineering**: ะฟะพะฝะธะผะฐะฝะธะต ะฝะตะธะทะฒะตััะฝัั ะฟัะพัะพะบะพะปะพะฒ

**Wireshark ะดะตะปะฐะตั ะธะผะตะฝะฝะพ ััะพ: "Follow TCP Stream".**

---

### 1. TCP Sequence Numbers

**ะะฐะถะดัะน TCP ะฟะฐะบะตั** ะธะผะตะตั:
- **SEQ** (sequence number) โ ะฝะพะผะตั ะฟะตัะฒะพะณะพ ะฑะฐะนัะฐ ะฒ ััะพะผ ะฟะฐะบะตัะต
- **ACK** (acknowledgment) โ ะฟะพะดัะฒะตัะถะดะตะฝะธะต ะฟะพะปััะตะฝะธั

```c
struct tcphdr *tcp = ...;
uint32_t seq = ntohl(tcp->seq);
uint32_t ack = ntohl(tcp->ack_seq);

printf("SEQ: %u, ACK: %u\n", seq, ack);
```

**ะัะธะผะตั ัะตััะธะธ**:
```
[Packet 1] SEQ=1000, len=100  โ ะดะฐะฝะฝัะต ั ะฑะฐะนัะฐ 1000 ะฟะพ 1099
[Packet 2] SEQ=1100, len=50   โ ะดะฐะฝะฝัะต ั ะฑะฐะนัะฐ 1100 ะฟะพ 1149
[Packet 3] SEQ=1150, len=200  โ ะดะฐะฝะฝัะต ั ะฑะฐะนัะฐ 1150 ะฟะพ 1349
```

**ะะพััะดะพะบ ะฟะฐะบะตัะพะฒ** ะผะพะถะตั ะฝะฐัััะฐัััั! ะัะถะฝะพ **ัะพััะธัะพะฒะฐัั ะฟะพ SEQ**.

---

### 2. ะะฟัะตะดะตะปะตะฝะธะต TCP ัะตััะธะธ

**ะกะตััะธั** ะธะดะตะฝัะธัะธัะธััะตััั ะฟะพ:
- Source IP
- Source Port
- Destination IP
- Destination Port

```c
typedef struct {
    uint32_t src_ip;
    uint32_t dst_ip;
    uint16_t src_port;
    uint16_t dst_port;
} SessionKey;

// ะกัะฐะฒะฝะตะฝะธะต ัะตััะธะน
int same_session(SessionKey *a, SessionKey *b) {
    return (a->src_ip == b->src_ip &&
            a->dst_ip == b->dst_ip &&
            a->src_port == b->src_port &&
            a->dst_port == b->dst_port);
}
```

---

### 3. ะฅัะฐะฝะตะฝะธะต ะฟะฐะบะตัะพะฒ ัะตััะธะธ

```c
#define MAX_PACKETS 1000

typedef struct {
    uint32_t seq;
    unsigned char data[2048];
    int data_len;
} Packet;

typedef struct {
    SessionKey key;
    Packet packets[MAX_PACKETS];
    int packet_count;
} Session;

// ะะพะฑะฐะฒะธัั ะฟะฐะบะตั ะฒ ัะตััะธั
void add_packet(Session *session, uint32_t seq, unsigned char *data, int len) {
    int idx = session->packet_count;
    session->packets[idx].seq = seq;
    memcpy(session->packets[idx].data, data, len);
    session->packets[idx].data_len = len;
    session->packet_count++;
}
```

---

### 4. ะกะพััะธัะพะฒะบะฐ ะฟะพ SEQ

```c
int compare_packets(const void *a, const void *b) {
    Packet *p1 = (Packet*)a;
    Packet *p2 = (Packet*)b;
    return (p1->seq > p2->seq) - (p1->seq < p2->seq);
}

// ะกะพััะธัะพะฒะฐัั ะฟะฐะบะตัั
qsort(session->packets, session->packet_count, sizeof(Packet), compare_packets);
```

---

### 5. ะกะฑะพัะบะฐ ะฟะพัะพะบะฐ ะดะฐะฝะฝัั

```c
// ะะฑัะตะดะธะฝะธัั ะฒัะต ะฟะฐะบะตัั ะฒ ะพะดะธะฝ ะฑััะตั
unsigned char stream[65536];
int stream_len = 0;

for (int i = 0; i < session->packet_count; i++) {
    memcpy(stream + stream_len, 
           session->packets[i].data, 
           session->packets[i].data_len);
    stream_len += session->packets[i].data_len;
}

printf("Total stream size: %d bytes\n", stream_len);
```

---

### 6. ะะทะฒะปะตัะตะฝะธะต ะบะปััะฐ ะธะท ะฟะตัะฒะพะณะพ ะฟะฐะบะตัะฐ

**ะัะพัะพะบะพะป V.**:
```
[Packet 1] (ั ะฝะฐะธะผะตะฝััะธะผ SEQ):
ะคะพัะผะฐั: "KEY:<hex_key>\n<encrypted_data>"
ะัะธะผะตั: "KEY:0x42\nEncrypted message here"
```

```c
// ะะฐััะธะฝะณ ะบะปััะฐ
unsigned char *first_packet = session->packets[0].data;
uint8_t key = 0;

if (sscanf((char*)first_packet, "KEY:0x%02hhx\n", &key) == 1) {
    printf("Encryption key: 0x%02X\n", key);
}

// ะะฐะนัะธ ะฝะฐัะฐะปะพ ะทะฐัะธััะพะฒะฐะฝะฝัั ะดะฐะฝะฝัั (ะฟะพัะปะต "\n")
unsigned char *encrypted = (unsigned char*)strchr((char*)first_packet, '\n');
if (encrypted) {
    encrypted++;  // ะัะพะฟัััะธัั '\n'
}
```

---

### 7. ะะฐััะธััะพะฒะบะฐ XOR (ะธะท Episode 01)

```c
void xor_decrypt(unsigned char *data, int len, uint8_t key) {
    for (int i = 0; i < len; i++) {
        data[i] ^= key;
    }
}

// ะัะฟะพะปัะทะพะฒะฐะฝะธะต
xor_decrypt(encrypted, encrypted_len, key);
printf("Decrypted: %s\n", encrypted);
```

---

### 8. ะะฑัะฐะฑะพัะบะฐ ะฝะตัะบะพะปัะบะธั ัะตััะธะน (advanced)

```c
#define MAX_SESSIONS 10

Session sessions[MAX_SESSIONS];
int session_count = 0;

// ะะฐะนัะธ ะธะปะธ ัะพะทะดะฐัั ัะตััะธั
Session* find_or_create_session(SessionKey *key) {
    // ะัะบะฐัั ัััะตััะฒััััั
    for (int i = 0; i < session_count; i++) {
        if (same_session(&sessions[i].key, key)) {
            return &sessions[i];
        }
    }
    
    // ะกะพะทะดะฐัั ะฝะพะฒัั
    if (session_count < MAX_SESSIONS) {
        sessions[session_count].key = *key;
        sessions[session_count].packet_count = 0;
        return &sessions[session_count++];
    }
    
    return NULL;
}
```

---

## ๐ฏ ะะธััะธั: "Communication Interceptor"

### ะะตะณะตะฝะดะฐ

ะะฒะฐ ะฐะณะตะฝัะฐ ะฟัะพัะธะฒะฝะธะบะฐ ะพะฑะผะตะฝะธะฒะฐัััั ะบัะธัะธัะตัะบะพะน ะธะฝัะพัะผะฐัะธะตะน ัะตัะตะท ะทะฐัะธััะพะฒะฐะฝะฝัะน TCP ะบะฐะฝะฐะป ะฝะฐ **10.0.0.1:4433**.

**ะัะพัะพะบะพะป ะบะพะผะผัะฝะธะบะฐัะธะธ**:
1. **ะะตัะฒัะน ะฟะฐะบะตั** (ะฝะฐะธะผะตะฝััะธะน SEQ): ัะพะดะตัะถะธั ะบะปัั ะฒ ัะพัะผะฐัะต `KEY:0x??`
2. **ะััะฐะปัะฝัะต ะฟะฐะบะตัั**: ะทะฐัะธััะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต (XOR)
3. **ะะพััะดะพะบ ะฟะฐะบะตัะพะฒ**: ัะปััะฐะนะฝัะน (ะฝัะถะฝะฐ ัะพััะธัะพะฒะบะฐ ะฟะพ SEQ)

**ะะฐัะฐ ะทะฐะดะฐัะฐ**: ะฟะตัะตัะฒะฐัะธัั, ัะตะบะพะฝััััะธัะพะฒะฐัั, ัะฐััะธััะพะฒะฐัั.

---

### ะะปะณะพัะธัะผ ัะตัะตะฝะธั

```
1. ะกะพะทะดะฐัั raw socket (SOCK_RAW, IPPROTO_TCP)
2. ะะตัะตัะฒะฐััะฒะฐัั ะฟะฐะบะตัั ะฒ ัะธะบะปะต
3. ะะปั ะบะฐะถะดะพะณะพ ะฟะฐะบะตัะฐ:
   - ะะฐััะธัั IP ะธ TCP ะทะฐะณะพะปะพะฒะบะธ
   - ะคะธะปัััะพะฒะฐัั ะฟะพ ะฟะพััั 4433
   - ะะทะฒะปะตัั SEQ ะธ payload
   - ะกะพััะฐะฝะธัั ะฒ ะผะฐััะธะฒ
4. ะะพัะปะต ะทะฐะฒะตััะตะฝะธั (FIN flag):
   - ะกะพััะธัะพะฒะฐัั ะฟะฐะบะตัั ะฟะพ SEQ
   - ะะทะฒะปะตัั ะบะปัั ะธะท ะฟะตัะฒะพะณะพ
   - ะะฑัะตะดะธะฝะธัั payload ะฒัะตั ะฟะฐะบะตัะพะฒ
   - ะะฐััะธััะพะฒะฐัั XOR
   - ะัะฒะตััะธ ัะพะพะฑัะตะฝะธะต
```

---

## ๐ ะกัััะบัััะฐ ัะฟะธะทะพะดะฐ

```
episode-12-encrypted-communications/
โโโ README.md              โ ะั ะทะดะตัั
โโโ mission.md
โโโ starter.c              โ ะจะฐะฑะปะพะฝ interceptor
โโโ artifacts/
โ   โโโ comm_interceptor.c โ ะกะพะทะดะฐะนัะต ััะพั ัะฐะนะป
โโโ solution/
โ   โโโ comm_interceptor_solution.c
โ   โโโ encrypted_sender.c    โ ะะตะฝะตัะฐัะพั ะทะฐัะธััะพะฒะฐะฝะฝะพะณะพ ััะฐัะธะบะฐ
โ   โโโ encrypted_receiver.c
โโโ tests/
    โโโ test.sh
```

### ๐ก ะะฐะบ ัะฐะฑะพัะฐัั:

1. **ะะทััะธัะต** `starter.c` โ ัะฐะผ ััััะบัััั Session, Packet ั TODO
2. **ะกะพะทะดะฐะนัะต** ัะฐะนะป `artifacts/comm_interceptor.c`
3. **ะะตะฐะปะธะทัะนัะต** ะฟะพะปะฝัั ัะตะฟะพัะบั:
   - Raw socket ะดะปั ะฟะตัะตัะฒะฐัะฐ
   - ะะฐััะธะฝะณ IP/TCP ะทะฐะณะพะปะพะฒะบะพะฒ
   - ะกะพััะฐะฝะตะฝะธะต ะฟะฐะบะตัะพะฒ ะฟะพ ัะตััะธัะผ
   - ะกะพััะธัะพะฒะบะฐ ะฟะพ sequence numbers
   - ะะทะฒะปะตัะตะฝะธะต ะบะปััะฐ
   - XOR ัะฐััะธััะพะฒะบะฐ
   - ะัะฒะพะด ัะธะฝะฐะปัะฝะพะณะพ ัะพะพะฑัะตะฝะธั
4. **ะกะบะพะผะฟะธะปะธััะนัะต**: `gcc -Wall -o comm_interceptor artifacts/comm_interceptor.c`
5. **ะะฐะฟัััะธัะต ั sudo**: `sudo ./comm_interceptor`

> ๐ก **ะะปั ัะตััะธัะพะฒะฐะฝะธั**: ะธัะฟะพะปัะทัะนัะต `encrypted_sender/receiver` ะดะปั ะณะตะฝะตัะฐัะธะธ ััะฐัะธะบะฐ!

---

### ะะพะดัะบะฐะทะบะธ

<details>
<summary>ะะฐะบ ะพะฟัะตะดะตะปะธัั ะบะพะฝะตั ัะตััะธะธ?</summary>

```c
// ะัะพะฒะตัะธัั FIN flag
if (tcp->fin) {
    printf("Session closing (FIN received)\n");
    // ะะฑัะฐะฑะพัะฐัั ะธ ัะฐััะธััะพะฒะฐัั ัะตััะธั
}
```
</details>

<details>
<summary>ะะฐะบ ัะพััะธัะพะฒะฐัั ะฟะฐะบะตัั?</summary>

```c
#include <stdlib.h>

int compare_packets(const void *a, const void *b) {
    Packet *p1 = (Packet*)a;
    Packet *p2 = (Packet*)b;
    
    if (p1->seq < p2->seq) return -1;
    if (p1->seq > p2->seq) return 1;
    return 0;
}

qsort(session->packets, session->packet_count, sizeof(Packet), compare_packets);
```
</details>

<details>
<summary>ะะฐะบ ะธะทะฒะปะตัั ะบะปัั?</summary>

```c
// ะะตัะฒัะน ะฟะฐะบะตั (ะฟะพัะปะต ัะพััะธัะพะฒะบะธ)
Packet *first = &session->packets[0];

uint8_t key = 0;
if (sscanf((char*)first->data, "KEY:0x%02hhx", &key) == 1) {
    printf("Found key: 0x%02X\n", key);
}

// ะะฐะฝะฝัะต ะฟะพัะปะต "KEY:0x??\n"
char *encrypted_start = strchr((char*)first->data, '\n');
if (encrypted_start) {
    encrypted_start++;  // Skip '\n'
}
```
</details>

<details>
<summary>ะะฐะบ ัะพะฑัะฐัั ะฒะตัั ะฟะพัะพะบ?</summary>

```c
unsigned char stream[65536];
int stream_len = 0;

// ะะฐัะฐัั ัะพ ะฒัะพัะพะณะพ ะฟะฐะบะตัะฐ (ะฟะตัะฒัะน - KEY)
for (int i = 1; i < session->packet_count; i++) {
    memcpy(stream + stream_len, 
           session->packets[i].data, 
           session->packets[i].data_len);
    stream_len += session->packets[i].data_len;
}

// ะะฐััะธััะพะฒะฐัั
xor_decrypt(stream, stream_len, key);
printf("Decrypted message:\n%s\n", stream);
```
</details>

---

## โ ะัะพะฒะตัะบะฐ

```bash
# ะะพะผะฟะธะปััะธั
gcc -Wall -o comm_interceptor artifacts/comm_interceptor.c

# ะ ะพะดะฝะพะผ ัะตัะผะธะฝะฐะปะต: ะทะฐะฟัััะธัั ะฟัะธะตะผะฝะธะบ
gcc -Wall -o receiver solution/encrypted_receiver.c
./receiver &

# ะ ะดััะณะพะผ ัะตัะผะธะฝะฐะปะต: ะทะฐะฟัััะธัั ะพัะฟัะฐะฒะธัะตะปั
gcc -Wall -o sender solution/encrypted_sender.c
./sender &

# ะ ััะตััะตะผ ัะตัะผะธะฝะฐะปะต: ะฟะตัะตัะฒะฐััะธะบ (ั sudo!)
sudo ./comm_interceptor

# ะััะฐะฝะพะฒะธัั ัะตััะพะฒัะน ััะฐัะธะบ
pkill receiver
pkill sender
```

**ะัะธัะตัะธะธ ััะฟะตัะฐ**:
- ะะตัะตัะฒะฐััะฒะฐะตั TCP ะฟะฐะบะตัั ะฝะฐ ะฟะพััั 4433
- ะะพััะตะบัะฝะพ ะฟะฐััะธั SEQ numbers
- ะกะพััะธััะตั ะฟะฐะบะตัั ะฟะพ ะฟะพััะดะบั
- ะะทะฒะปะตะบะฐะตั ะบะปัั ะธะท ะฟะตัะฒะพะณะพ ะฟะฐะบะตัะฐ
- ะะฑัะตะดะธะฝัะตั payload
- ะะฐััะธััะพะฒัะฒะฐะตั XOR
- ะัะฒะพะดะธั ัะธะฝะฐะปัะฝะพะต ัะพะพะฑัะตะฝะธะต V.

---

## ๐ฌ DEBRIEFING

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะะะะะฆะะฏ: ะะฒะฐััะธัะฐ, ัะฐะนะพะฝ ะัะฑะฐั, ะะพัะบะฒะฐ                 โ
โ  ะะะะะฏ:   06:47, ัะตัะฒะตัะณ, 2 ะพะบััะฑัั                     โ
โ  ะกะขะะขะฃะก:  ๐ข MISSION ACCOMPLISHED - SEASON 3 COMPLETE    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

`comm_interceptor` ะทะฐะฟััะตะฝ. ะะตัะตัะฒะฐั ะฝะฐัะฐั. ะะตะบะพะฝััััะบัะธั ะทะฐะฒะตััะตะฝะฐ. ะะตะทัะปััะฐั:

```
=== COMMUNICATION INTERCEPTOR ===
Listening for encrypted traffic on port 4433...

[Session detected]
10.0.0.1:54321 โ 10.0.0.1:4433

Captured 8 packets, reconstructing stream...

[Packet 1] SEQ=1000, len=15: "KEY:0x42\n..."
[Packet 2] SEQ=1015, len=50
[Packet 3] SEQ=1065, len=100
[Packet 4] SEQ=1165, len=75
[Packet 5] SEQ=1240, len=60
[Packet 6] SEQ=1300, len=40
[Packet 7] SEQ=1340, len=25
[Packet 8] SEQ=1365, FIN flag

Sorting by sequence number... โ
Extracting key from first packet... โ
Key: 0x42

Assembling stream... โ
Total encrypted data: 350 bytes

Decrypting with XOR... โ

๐ฏ DECRYPTED MESSAGE:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                       โ
โ  ะะพะทะดัะฐะฒะปัั, ะฐะณะตะฝั.                                   โ
โ                                                       โ
โ  ะขั ะฟัะพััะป Season 3: NETWORKS.                        โ
โ                                                       โ
โ  ะขั ะพัะฒะพะธะป:                                           โ
โ  โ IP-ะฐะดัะตัะฐัะธั ะธ ััััะบัััั ัะตัะตะน                     โ
โ  โ Socket programming (TCP/UDP)                       โ
โ  โ Raw sockets ะธ packet sniffing                      โ
โ  โ TCP session reconstruction                         โ
โ  โ XOR ัะธััะพะฒะฐะฝะธะต ะธ ะดะตัะธััะพะฒะบั                        โ
โ                                                       โ
โ  ะกะตัั ะฑะพะปััะต ะฝะต ัะฐะนะฝะฐ. ะขั ะฒะธะดะธัั ะฟะพัะพะบะธ ะดะฐะฝะฝัั.       โ
โ  ะขั ะฟะพะฝะธะผะฐะตัั ะฟัะพัะพะบะพะปั. ะขั ะบะพะฝััะพะปะธััะตัั ะบะฐะฝะฐะป.      โ
โ                                                       โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ                                                       โ
โ  ะกะปะตะดัััะธะน ัะฐะณ: ะะะะะขะะะะะคะะฏ.                         โ
โ                                                       โ
โ  Season 4: Crypto & Algorithms                        โ
โ  ะขะฐะผ ัะตะฑั ะถะดัั ะฝะฐััะพััะธะต ะฒัะทะพะฒั:                      โ
โ  - ะกะธะผะผะตััะธัะฝะพะต ัะธััะพะฒะฐะฝะธะต                            โ
โ  - ะฅัั-ััะฝะบัะธะธ ะธ blockchain                           โ
โ  - ะกะพััะธัะพะฒะบะฐ ะธ ะฟะพะธัะบ                                 โ
โ  - ะกัััะบัััั ะดะฐะฝะฝัั                                   โ
โ                                                       โ
โ  ะะพัะพะฒััั. ะกะปะพะถะฝะพััั ะฒะพะทัะฐััะฐะตั.                      โ
โ                                                       โ
โ  ะะพ ะฒัััะตัะธ ะฒ Season 4.                               โ
โ                                                       โ
โ  โ V.                                                 โ
โ                                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

Session closed gracefully.
```

---

### ๐ SEASON 3 COMPLETE!

**ะั ะพัะฒะพะธะปะธ:**
- ๐ **IP-ะฐะดัะตัะฐัะธั** โ ะบะพะพัะดะธะฝะฐัั ะฒ ะบะธะฑะตัะฟัะพัััะฐะฝััะฒะต
- ๐ **ะกะพะบะตัั** โ ะฟะพะดะบะปััะตะฝะธะต ะบ ะปัะฑะพะผั ัะตัะฒะตัั
- ๐ก **Packet sniffing** โ ะฒะธะดะธัะต ะฒัั, ััะพ ะฟัะพะธััะพะดะธั ะฒ ัะตัะธ
- ๐ **Session reconstruction** โ ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตัะต ะฟะพะปะฝัั ะบะฐััะธะฝั ะบะพะผะผัะฝะธะบะฐัะธะธ

**ะััะตัะฐะบัั ะฟะพะปััะตะฝั:**
- `net_analyzer` โ ะฐะฝะฐะปะธะทะฐัะพั IP-ะฐะดัะตัะพะฒ
- `moonlight_client` โ TCP ะบะปะธะตะฝั
- `packet_sniffer` โ ะฟะตัะตัะฒะฐััะธะบ ะฟะฐะบะตัะพะฒ
- `comm_interceptor` โ ัะธััะตะผะฐ ะฟะพะปะฝะพะณะพ ะฟะตัะตัะฒะฐัะฐ

### ๐๏ธ ะคะธะฝะฐะปัะฝัะน ะฝะฐะฒัะบ ัะฐะทะฑะปะพะบะธัะพะฒะฐะฝ:
**"Network Wizard"** โ ะั ะฒะปะฐะดะตะตัะต ัะตััะผะธ ะฝะฐ ะฒัะตั ััะพะฒะฝัั: ะพั IP ะดะพ ะฟัะธะปะพะถะตะฝะธะน.

---

## ๐ ะะะะขะะะะฌะะซะ ะะะะะะกะซ

ะัะพะฒะตัััะต ะฟะพะฝะธะผะฐะฝะธะต Episode 12 โ ะคะะะะ Season 3 (ะฒัะต ะฒะพะฟัะพัั ะพัะฝะพะฒะฐะฝั ะฝะฐ ััะถะตัะต ะฒัััะตัะธ ั V.):

### ๐ข ะะฐะทะพะฒะพะต ะฟะพะฝะธะผะฐะฝะธะต (5 ะฒะพะฟัะพัะพะฒ)

**1. ะ 04:30 ะฒั ัะฐััะธััะพะฒะฐะปะธ ัะพะพะฑัะตะฝะธะต ะธ ัะทะฝะฐะปะธ ะบะพะพัะดะธะฝะฐัั ะฒัััะตัะธ: 55.7558ยฐN 37.6173ยฐE. ะะพัะตะผั ััะธ ะบะพะพัะดะธะฝะฐัั ะทะฝะฐะบะพะผั?**

<details>
<summary>ะัะฒะตั</summary>

**ะญัะพ ัะต ะถะต ะบะพะพัะดะธะฝะฐัั ะธะท IP `203.0.113.42` (Episode 09)!**

**ะกะบะฒะพะทะฝะฐั ะปะธะฝะธั ััะถะตัะฐ:**
```
Episode 09 (04:27) โ ะะตะบะพะดะธัะพะฒะฐะปะธ IP 203.0.113.42
                      PATTERN DETECTED: GPS 55.7558ยฐN 37.6173ยฐE
                      ะัะฐัะฝะฐั ะฟะปะพัะฐะดั, ะกะฟะฐััะบะฐั ะฑะฐัะฝั

Episode 12 (04:30) โ ะะฐััะธััะพะฒะฐะปะธ ะทะฐัะธััะพะฒะฐะฝะฝะพะต ัะพะพะฑัะตะฝะธะต
                      ะะพะพัะดะธะฝะฐัั: 55.7558ยฐN 37.6173ยฐE
                      โ ะะพะดัะฒะตัะถะดะตะฝะธะต!

Episode 12 (08:00) โ ะัััะตัะฐ ะฝะฐ ะัะฐัะฝะพะน ะฟะปะพัะฐะดะธ
                      ะกะฟะฐััะบะฐั ะฑะฐัะฝั ะัะตะผะปั
                      Viktor ะฟะตัะตะดะฐัั USB-ัะปะตัะบั
```

**ะงัะพ ััะพ ะพะทะฝะฐัะฐะตั:**
- ะัั ะฑัะปะพ ัะฟะปะฐะฝะธัะพะฒะฐะฝะพ ั ัะฐะผะพะณะพ ะฝะฐัะฐะปะฐ
- V. ะดะฐะป ะบะพะพัะดะธะฝะฐัั ะฒ Episode 09
- Episode 10-11: ะฟัะพะฒะตัะบะฐ ะฝะฐะฒัะบะพะฒ
- Episode 12: ัะธะฝะฐะปัะฝะพะต ะฟะพะดัะฒะตัะถะดะตะฝะธะต

**ะ ะบะพะดะต:**
```c
// Episode 09:
uint32_t ip = 0xCB00712A;  // 203.0.113.42
// โ GPS: 55.7558ยฐN 37.6173ยฐE

// Episode 12:
char *decrypted = "Coordinates: 55.7558ยฐN 37.6173ยฐE";
// โ ะขะต ะถะต ะบะพะพัะดะธะฝะฐัั!
```

**ะฃัะพะบ:** ะ ัะพัะพัะพ ัะฟะปะฐะฝะธัะพะฒะฐะฝะฝะพะน ะพะฟะตัะฐัะธะธ ะฒัั ัะฒัะทะฐะฝะพ. ะะพะพัะดะธะฝะฐัั ั ัะฐะผะพะณะพ ะฝะฐัะฐะปะฐ ะฒะตะปะธ ะบ ัะธะฝะฐะปั.
</details>

**2. ะะฐัะธััะพะฒะฐะฝะฝัะน ะฟะพัะพะบ ะธัะฟะพะปัะทะพะฒะฐะป XOR ั ะบะปััะพะผ 0x42. ะะพัะตะผั V. ะฒัะฑัะฐะป ะธะผะตะฝะฝะพ ััะพั ะบะปัั?**

<details>
<summary>ะัะฒะตั</summary>

**0x42 = 66 decimal = "Answer to Everything" ะธะท Hitchhiker's Guide to the Galaxy!**

**Easter Egg:**
- ะ ัะพะผะฐะฝะต ะัะณะปะฐัะฐ ะะดะฐะผัะฐ ัะธัะปะพ 42 โ ะพัะฒะตั ะฝะฐ ะณะปะฐะฒะฝัะน ะฒะพะฟัะพั ะถะธะทะฝะธ, ะฒัะตะปะตะฝะฝะพะน ะธ ะฒัะตะณะพ ัะฐะบะพะณะพ
- V. ะธัะฟะพะปัะทัะตั ััะพ ะบะฐะบ ัะธะปะพัะพััะบัั ะพัััะปะบั
- "Answer to Everything" = ะบะปัั ะบ ะฟะพะฝะธะผะฐะฝะธั ะฒัะตะณะพ

**ะ ะผะธััะธะธ:**
```c
// ะะฐััะธััะพะฒะฐะฝะฝัะน ะฟะตัะฒัะน ะฟะฐะบะตั:
char first_packet[] = "KEY:0x42\n...";

// ะะทะฒะปะตัะตะฝะธะต ะบะปััะฐ:
uint8_t xor_key = 0x42;

// ะะฐััะธััะพะฒะบะฐ:
for (int i = 0; i < data_len; i++) {
    decrypted[i] = encrypted[i] ^ 0x42;
}
```

**ะขะตัะฝะธัะตัะบะธ:**
- XOR ั ะพะดะฝะธะผ ะฑะฐะนัะพะผ = ะฟัะพััะตะนัะตะต ัะธััะพะฒะฐะฝะธะต
- ะะตะณะบะพ ะปะพะผะฐะตััั (frequency analysis)
- ะะพ ะดะปั ััะตะฑะฝัั ัะตะปะตะน ะธะดะตะฐะปะตะฝ

**ะะพัะตะผั 0x42 ะฒ ัะตะฐะปัะฝะพััะธ:**
- ะะตะณะบะพ ะทะฐะฟะพะผะฝะธัั
- ASCII: 'B' = 66 = 0x42
- Hex: ัะดะพะฑะฝะพ ะทะฐะฟะธััะฒะฐัั
- ะคะธะปะพัะพััะบะฐั ะพัััะปะบะฐ (ะบัะปััััะฐ ัะฐะบะตัะพะฒ ะปัะฑะธั ัะฐะบะธะต ะฒะตัะธ)

**ะ Episode 01:**
- ะั ัะถะต ะธัะฟะพะปัะทะพะฒะฐะปะธ XOR ัะธััะพะฒะฐะฝะธะต!
- ะขะตะฟะตัั ะฟัะธะผะตะฝัะตัะต ะฝะฐ ัะตัะตะฒะพะผ ััะพะฒะฝะต
- ะะพะปะฝัะน ัะธะบะป: ัะธัั โ ัะตัั โ ะฟะตัะตัะฒะฐั โ ะดะตัะธัั

**ะฃัะพะบ:** ะัะฑะพั ะบะปััะฐ ะผะพะถะตั ะฝะตััะธ ัะผััะป. ะ ัะตะฐะปัะฝัั ัะธััะตะผะฐั ะธัะฟะพะปัะทัะนัะต ะบัะธะฟัะพะณัะฐัะธัะตัะบะธ ััะพะนะบะธะต ะบะปััะธ (AES, ChaCha20).
</details>

**3. ะงัะพ ัะฐะบะพะต TCP sequence number ะธ ะบะฐะบ ะพะฝ ะฟะพะผะพะณ ะฒะพัััะฐะฝะพะฒะธัั ะฟะพััะดะพะบ ะฟะฐะบะตัะพะฒ?**

<details>
<summary>ะัะฒะตั</summary>

**TCP sequence number = ะฝะพะผะตั ะฟะตัะฒะพะณะพ ะฑะฐะนัะฐ ะดะฐะฝะฝัั ะฒ ะฟะฐะบะตัะต!**

**ะะฐะบ ัะฐะฑะพัะฐะตั:**
```c
struct tcphdr {
    uint32_t seq;      // Sequence number
    uint32_t ack_seq;  // Acknowledgment number
    // ...
};
```

**ะ ะผะธััะธะธ (03:45):**
```
[Packet 1] SEQ=1000, len=15: "KEY:0x42\n..."
[Packet 2] SEQ=1015, len=50    โ 1000 + 15 = 1015!
[Packet 3] SEQ=1065, len=100   โ 1015 + 50 = 1065!
[Packet 4] SEQ=1165, len=75    โ 1065 + 100 = 1165!
...

ะกะปะตะดัััะธะน SEQ = ะขะตะบััะธะน SEQ + payload_len
```

**ะะปะณะพัะธัะผ ัะตะบะพะฝััััะบัะธะธ:**
```c
typedef struct {
    uint32_t seq;
    char payload[1024];
    int payload_len;
} Packet;

Packet packets[100];
int packet_count = 0;

// ะกะพััะธัะพะฒะบะฐ ะฟะพ SEQ:
qsort(packets, packet_count, sizeof(Packet), compare_seq);

int compare_seq(const void *a, const void *b) {
    Packet *pa = (Packet*)a;
    Packet *pb = (Packet*)b;
    return (pa->seq > pb->seq) - (pa->seq < pb->seq);
}

// ะกะฑะพัะบะฐ ะฟะพัะพะบะฐ:
char stream[10000];
int stream_len = 0;
for (int i = 0; i < packet_count; i++) {
    memcpy(stream + stream_len, packets[i].payload, packets[i].payload_len);
    stream_len += packets[i].payload_len;
}
```

**ะะพัะตะผั ะฒะฐะถะฝะพ:**
- ะะฐะบะตัั ะผะพะณัั ะฟัะธะนัะธ ะฒ ะปัะฑะพะผ ะฟะพััะดะบะต (routing)
- Retransmit ะผะพะถะตั ะดัะฑะปะธัะพะฒะฐัั ะฟะฐะบะตัั
- SEQ ะณะฐัะฐะฝัะธััะตั ะฟัะฐะฒะธะปัะฝัะน ะฟะพััะดะพะบ

**ะ ะผะธััะธะธ:**
```
ะะตะท ัะพััะธัะพะฒะบะธ:
[Packet 3] "Coordinates: 55..."
[Packet 1] "KEY:0x42..."
[Packet 2] "ะะพะทะดัะฐะฒะปัั..."
โ ะััะพั! ะะตะฒะพะทะผะพะถะฝะพ ัะฐััะธััะพะฒะฐัั!

ะก ัะพััะธัะพะฒะบะพะน ะฟะพ SEQ:
[Packet 1] "KEY:0x42..."
[Packet 2] "ะะพะทะดัะฐะฒะปัั..."
[Packet 3] "Coordinates: 55..."
โ ะัะฐะฒะธะปัะฝัะน ะฟะพัะพะบ! ะะฐััะธััะพะฒะบะฐ ััะฟะตัะฝะฐ!
```

**ะฃัะพะบ:** TCP SEQ = timestamp ะดะฐะฝะฝัั ะดะปั ัะฟะพััะดะพัะธะฒะฐะฝะธั.
</details>

**4. ะัััะตัะฐ ะฝะฐะทะฝะฐัะตะฝะฐ ะฝะฐ 08:00 ะฟััะฝะธัั, 3 ะพะบััะฑัั. ะกะบะพะปัะบะพ ะฒัะตะผะตะฝะธ ะฟัะพัะปะพ ะพั ะฝะฐัะฐะปะฐ Episode 09?**

<details>
<summary>ะัะฒะตั</summary>

**~76 ัะฐัะพะฒ (3 ะดะฝั ะธ 4 ัะฐัะฐ)!**

**ะัะตะผะตะฝะฝะฐั ะปะธะฝะธั:**
```
ะกะะะะ, 1 ะะะขะฏะะะฏ
04:00 โ Episode 09 ะฝะฐัะฐะปะพ (ะฐะฝะฐะปะธะท addresses.txt)
04:27 โ ะะฑะฝะฐััะถะตะฝ IP 203.0.113.42
04:47 โ SMS ะพั UNKNOWN: "ะขั ัะปะธัะบะพะผ ะฑะปะธะทะบะพ"

09:30 โ Episode 10 ะฝะฐัะฐะปะพ (ะฟะพะดะบะปััะตะฝะธะต ะบ ัะตัะฒะตัั)
10:16 โ ะะตัะฒะฐั ะฟะพะฟััะบะฐ โ DDoS-ะฐัะฐะบะฐ
10:47 โ ะัะพัะฐั ะฟะพะฟััะบะฐ โ ััะฟะตั!
10:51 โ ะะพะปััะตะฝั ะบะพะพัะดะธะฝะฐัั ัะทะปะฐ 2 (10.0.0.1:4433)

18:20 โ Episode 11 ะฝะฐัะฐะปะพ (packet sniffing)
19:47 โ ะะตัะตัะฒะฐัะตะฝั ะบะพะพัะดะธะฝะฐัั safe house!
20:15 โ SMS ะพั V.: "ะะฝัะพัะผะฐัะธะพะฝะฝะฐั ะฒะพะนะฝะฐ"
22:35 โ ะะตัะตัะฒะฐั ะทะฐะฒะตัััะฝ

ะงะะขะะะะ, 2 ะะะขะฏะะะฏ
02:15 โ Episode 12 ะฝะฐัะฐะปะพ (ัะธะฝะฐะปัะฝะฐั ะผะธััะธั)
04:30 โ ะะฐััะธััะพะฒะบะฐ ะทะฐะฒะตััะตะฝะฐ
        ะะพะพัะดะธะฝะฐัั ะฒัััะตัะธ: 55.7558ยฐN 37.6173ยฐE
        ะัะตะผั: ะััะฝะธัะฐ, 08:00 UTC
06:47 โ Season 3 ะะะะะะจะะ

ะะฏะขะะะฆะ, 3 ะะะขะฏะะะฏ
08:00 โ ะะกะขะะะงะ ะฝะฐ ะัะฐัะฝะพะน ะฟะปะพัะฐะดะธ
        Viktor ะฟะตัะตะดะฐัั USB-ัะปะตัะบั
        Season 4 ัะฐะทะฑะปะพะบะธัะพะฒะฐะฝ
```

**ะะฐัััั:**
```
ะะฐัะฐะปะพ: ะกัะตะดะฐ, 04:00
ะัััะตัะฐ: ะััะฝะธัะฐ, 08:00

ะกัะตะดะฐ 04:00 โ ะงะตัะฒะตัะณ 04:00 = 24 ัะฐัะฐ
ะงะตัะฒะตัะณ 04:00 โ ะััะฝะธัะฐ 04:00 = 24 ัะฐัะฐ
ะััะฝะธัะฐ 04:00 โ ะััะฝะธัะฐ 08:00 = 4 ัะฐัะฐ

ะัะพะณะพ: 24 + 24 + 4 = 52 ัะฐัะฐ

ะะปะธ ะตัะปะธ ะพั Episode 09 ััะฐััะฐ (ะกัะตะดะฐ 04:00):
ะะพ ะฒัััะตัะธ (ะััะฝะธัะฐ 08:00) = ~76 ัะฐัะพะฒ
```

**ะะฝัะตะฝัะธะฒะฝะพััั:**
- Season 3 = 4 ัะฟะธะทะพะดะฐ ะทะฐ ~52 ัะฐัะฐ ะฐะบัะธะฒะฝะพะน ัะฐะฑะพัั
- Episode 09: 16 ัะฐัะพะฒ (04:00-20:00)
- Episode 10: 14 ัะฐัะพะฒ (09:30-23:30)
- Episode 11: 8 ัะฐัะพะฒ (18:20-02:20)
- Episode 12: 6 ัะฐัะพะฒ (02:15-08:00)

**ะฃัะพะบ:** ะะตะฐะปัะฝัะต ะบะธะฑะตัะพะฟะตัะฐัะธะธ โ ััะพ ะผะฐัะฐัะพะฝ, ััะตะฑัััะธะน ะฒัะฝะพัะปะธะฒะพััะธ.
</details>

**5. ะ ัะธะฝะฐะปัะฝะพะผ ัะพะพะฑัะตะฝะธะธ V. ัะฟะพะผะธะฝะฐะตั Season 4: Crypto & Algorithms. ะะฐะบะธะต ะฝะฐะฒัะบะธ ะธะท Season 3 ะฟัะธะณะพะดัััั ัะฐะผ?**

<details>
<summary>ะัะฒะตั</summary>

**ะะกะ ะฝะฐะฒัะบะธ Season 3 โ ะพัะฝะพะฒะฐ ะดะปั Season 4!**

**ะกะฒัะทั ะผะตะถะดั Season 3 ะธ Season 4:**

**1. XOR ัะธััะพะฒะฐะฝะธะต โ Advanced Crypto:**
```
Season 3 (Episode 12):
  XOR ั ะบะปััะพะผ 0x42 (ะฟัะพััะพะต ัะธััะพะฒะฐะฝะธะต)
  
Season 4:
  AES, RSA, ECC (ะฝะฐััะพััะฐั ะบัะธะฟัะพะณัะฐัะธั)
  ะะพ ะฟัะธะฝัะธะฟ ัะพั ะถะต: ะบะปัั + ะฐะปะณะพัะธัะผ
```

**2. Network basics โ Secure Communications:**
```
Season 3:
  TCP ัะพะบะตัั (plaintext)
  
Season 4:
  TLS/SSL (encrypted TCP)
  ะขะพั ะถะต socket API, ะฝะพ ั ัะธััะพะฒะฐะฝะธะตะผ
```

**3. Packet sniffing โ Traffic Analysis:**
```
Season 3:
  ะะตัะตัะฒะฐั plaintext ะฟะฐะบะตัะพะฒ
  
Season 4:
  ะะฝะฐะปะธะท ะทะฐัะธััะพะฒะฐะฝะฝะพะณะพ ััะฐัะธะบะฐ
  Metadata analysis, timing attacks
```

**4. Session reconstruction โ Forensics:**
```
Season 3:
  ะกะฑะพัะบะฐ TCP ะฟะพัะพะบะฐ ะฟะพ SEQ
  
Season 4:
  ะะพัััะฐะฝะพะฒะปะตะฝะธะต ะทะฐัะธััะพะฒะฐะฝะฝัั ัะตััะธะน
  Breaking crypto, side-channel attacks
```

**ะะพะฝะบัะตัะฝัะต ะฝะฐะฒัะบะธ:**

**ะะท Episode 09:**
- ะะฐะฑะพัะฐ ั ะฑะฐะนัะฐะผะธ, hex, binary
- ะะพะฝะธะผะฐะฝะธะต endianness
โ ะัะถะฝะพ ะดะปั ะบัะธะฟัะพะณัะฐัะธะธ (ะฒัะต ะพะฟะตัะฐัะธะธ ั ะฑะฐะนัะฐะผะธ)

**ะะท Episode 10:**
- Socket programming
- Challenge-response ะฟัะพัะพะบะพะป
โ ะัะฝะพะฒะฐ ะดะปั TLS handshake, key exchange

**ะะท Episode 11:**
- Raw sockets, packet parsing
- Header structures
โ ะะฝะฐะปะธะท ะทะฐัะธััะพะฒะฐะฝะฝะพะณะพ ััะฐัะธะบะฐ

**ะะท Episode 12:**
- XOR encryption/decryption
- Stream reconstruction
โ ะะพะฝะธะผะฐะฝะธะต stream ciphers, block ciphers

**ะ Episode 12 V. ะณะพะฒะพัะธั:**
```
"Season 4: Crypto & Algorithms
 ะขะฐะผ ัะตะฑั ะถะดัั ะฝะฐััะพััะธะต ะฒัะทะพะฒั:
 
 Episode 13: ะกะธะผะผะตััะธัะฝะพะต ัะธััะพะฒะฐะฝะธะต (AES, ChaCha20)
 Episode 14: Blockchain ะธ ััั-ััะฝะบัะธะธ (SHA-256, mining)
 Episode 15: ะะปะณะพัะธัะผั ัะพััะธัะพะฒะบะธ ะธ ะฟะพะธัะบะฐ
 Episode 16: ะกัััะบัััั ะดะฐะฝะฝัั ะดะปั ะบัะธะฟัะพะณัะฐัะธะธ"
```

**ะฃัะพะบ:** ะะฐะถะดัะน Season ัััะพะธััั ะฝะฐ ะฟัะตะดัะดััะตะผ. ะกะตัะธ โ ะัะธะฟัะพะณัะฐัะธั โ ะะปะณะพัะธัะผั.
</details>

---

### ๐ก ะัะฐะบัะธะบะฐ (5 ะฒะพะฟัะพัะพะฒ)

**6. ะ 03:45 ะฒั ัะพััะธัะพะฒะฐะปะธ 8 ะฟะฐะบะตัะพะฒ ะฟะพ SEQ. ะะฐะบ ะพะฟัะตะดะตะปะธัั, ะบะฐะบะพะน ะฟะฐะบะตั ะฟะพัะปะตะดะฝะธะน?**

<details>
<summary>ะัะฒะตั</summary>

**ะะพัะปะตะดะฝะธะน ะฟะฐะบะตั ะธะผะตะตั ัะปะฐะณ FIN!**

**ะ ะผะธััะธะธ:**
```
[Packet 8] SEQ=1365, FIN flag
           ^^^^ ะญัะพ ะฟะพัะปะตะดะฝะธะน!
```

**TCP ัะปะฐะณะธ:**
```c
struct tcphdr {
    // ...
    uint8_t fin  : 1;  // Finish (ะฟะพัะปะตะดะฝะธะน ะฟะฐะบะตั)
    uint8_t syn  : 1;  // Synchronize (ะฟะตัะฒัะน ะฟะฐะบะตั)
    uint8_t rst  : 1;  // Reset (ะฐะฒะฐัะธะนะฝะพะต ะทะฐะฒะตััะตะฝะธะต)
    uint8_t psh  : 1;  // Push (ะฝะตะผะตะดะปะตะฝะฝะฐั ะพัะฟัะฐะฒะบะฐ)
    uint8_t ack  : 1;  // Acknowledgment
    uint8_t urg  : 1;  // Urgent
};
```

**ะัะพะฒะตัะบะฐ FIN:**
```c
struct tcphdr *tcp = (struct tcphdr*)(packet + ip_header_len);

if (tcp->fin) {
    printf("ะะพัะปะตะดะฝะธะน ะฟะฐะบะตั! SEQ=%u\n", ntohl(tcp->seq));
    // ะะพะปััะต ะดะฐะฝะฝัั ะฝะต ะฑัะดะตั
    // ะะฐะฒะตััะฐะตะผ ัะฑะพั ัะตััะธะธ
    break;
}
```

**ะ ะผะธััะธะธ (comm_interceptor):**
```c
typedef struct {
    uint32_t seq;
    char payload[1024];
    int payload_len;
    int is_fin;  // โ ะคะปะฐะณ ะฟะพัะปะตะดะฝะตะณะพ ะฟะฐะบะตัะฐ
} Packet;

// ะัะธ ะฟะพะปััะตะฝะธะธ:
packets[i].is_fin = tcp->fin;

// ะะพัะปะต ัะพััะธัะพะฒะบะธ:
for (int i = 0; i < packet_count; i++) {
    assemble_payload(packets[i]);
    
    if (packets[i].is_fin) {
        printf("Stream complete! Total: %d bytes\n", stream_len);
        break;
    }
}
```

**Graceful shutdown (FIN) vs Abort (RST):**
```
FIN (ะฒะตะถะปะธะฒะพะต ะทะฐะฒะตััะตะฝะธะต):
  Client โ Server: FIN
  Server โ Client: ACK + FIN
  Client โ Server: ACK
  โ ะกะพะตะดะธะฝะตะฝะธะต ะทะฐะบัััะพ ะบะพััะตะบัะฝะพ

RST (ะฐะฒะฐัะธะนะฝะพะต ะทะฐะฒะตััะตะฝะธะต):
  Client โ Server: RST
  โ๏ธ ะกะพะตะดะธะฝะตะฝะธะต ัะฐะทะพัะฒะฐะฝะพ ะฝะตะผะตะดะปะตะฝะฝะพ
  ะะฐะฝะฝัะต ะผะพะณัั ะฑััั ะฟะพัะตััะฝั
```

**ะฃัะพะบ:** FIN = "ั ะทะฐะบะพะฝัะธะป ะพัะฟัะฐะฒะปััั ะดะฐะฝะฝัะต". ะัะตะณะดะฐ ะถะดะธัะต FIN ะดะปั ะฟะพะปะฝะพะน ัะฑะพัะบะธ ัะตััะธะธ.
</details>

**7. ะะปัั XOR ะฑัะป ะฒ ะฟะตัะฒะพะผ ะฟะฐะบะตัะต ("KEY:0x42"). ะะฐะบ ะฑะตะทะพะฟะฐัะฝะพ ะธะทะฒะปะตัั ะตะณะพ ะธะท payload?**

<details>
<summary>ะัะฒะตั</summary>

**ะะฐััะธะฝะณ ัะตะบััะพะฒะพะณะพ ะฟัะพัะพะบะพะปะฐ ั ะฒะฐะปะธะดะฐัะธะตะน!**

**ะ ะผะธััะธะธ (04:00):**
```c
// ะะตัะฒัะน ะฟะฐะบะตั (SEQ=1000):
char first_payload[] = "KEY:0x42\n<encrypted data>";

// ะะทะฒะปะตัะตะฝะธะต ะบะปััะฐ:
uint8_t xor_key = 0;
if (sscanf(first_payload, "KEY:0x%hhx", &xor_key) == 1) {
    printf("Key extracted: 0x%02X\n", xor_key);  // 0x42
} else {
    fprintf(stderr, "Invalid key format!\n");
    return -1;
}
```

**ะะตะทะพะฟะฐัะฝัะน ะฟะฐััะธะฝะณ:**
```c
// 1. ะัะพะฒะตัะบะฐ ัะพัะผะฐัะฐ
if (strncmp(first_payload, "KEY:0x", 6) != 0) {
    fprintf(stderr, "Missing KEY: prefix\n");
    return -1;
}

// 2. ะะทะฒะปะตัะตะฝะธะต hex ะทะฝะฐัะตะฝะธั
char hex_str[3];  // 2 ัะธะผะฒะพะปะฐ + \0
hex_str[0] = first_payload[6];  // ะะตัะฒัะน hex digit
hex_str[1] = first_payload[7];  // ะัะพัะพะน hex digit
hex_str[2] = '\0';

// 3. ะะพะฝะฒะตััะฐัะธั ะฒ ัะธัะปะพ
xor_key = (uint8_t)strtol(hex_str, NULL, 16);

// 4. ะะฐะปะธะดะฐัะธั
if (xor_key == 0 && errno == EINVAL) {
    fprintf(stderr, "Invalid hex value\n");
    return -1;
}

printf("โ Key: 0x%02X (%u)\n", xor_key, xor_key);
```

**ะฃะดะฐะปะตะฝะธะต ะฟัะตัะธะบัะฐ ะธะท payload:**
```c
// ะะฐะนัะธ \n ะฟะพัะปะต ะบะปััะฐ:
char *data_start = strchr(first_payload, '\n');
if (data_start == NULL) {
    fprintf(stderr, "No newline after key\n");
    return -1;
}
data_start++;  // ะัะพะฟัััะธัั \n

int encrypted_len = strlen(data_start);
char encrypted_data[1024];
memcpy(encrypted_data, data_start, encrypted_len);
```

**ะะปััะตัะฝะฐัะธะฒะฝัะน ัะพัะผะฐั (ะฑะธะฝะฐัะฝัะน):**
```c
// ะัะปะธ ะบะปัั ะฒ ะฑะธะฝะฐัะฝะพะผ ะฒะธะดะต:
uint8_t xor_key = first_payload[0];  // ะะตัะฒัะน ะฑะฐะนั = ะบะปัั
char *encrypted = first_payload + 1;  // ะััะฐะปัะฝะพะต = ะดะฐะฝะฝัะต
```

**ะ ะผะธััะธะธ:**
- ะขะตะบััะพะฒัะน ัะพัะผะฐั: "KEY:0x42\n"
- ะะตะณะบะพ ัะธัะฐะตััั ัะตะปะพะฒะตะบะพะผ
- ะฃะดะพะฑะฝะพ ะดะปั debug

**ะฃัะพะบ:** ะัะตะณะดะฐ ะฒะฐะปะธะดะธััะนัะต ะธะทะฒะปะตััะฝะฝัะต ะดะฐะฝะฝัะต ะฟะตัะตะด ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ!
</details>

**8. ะะพัะปะต ัะฐััะธััะพะฒะบะธ ะฒั ะฟะพะปััะธะปะธ ัะพะพะฑัะตะฝะธะต ะดะปะธะฝะพะน 350 ะฑะฐะนั. ะกะบะพะปัะบะพ ะฑัะปะพ ะฟะฐะบะตัะพะฒ ะธ ะฟะพัะตะผั?**

<details>
<summary>ะัะฒะตั</summary>

**8 ะฟะฐะบะตัะพะฒ, ะฟะพัะพะผั ััะพ MTU (Maximum Transmission Unit) ะพะณัะฐะฝะธัะธะฒะฐะตั ัะฐะทะผะตั!**

**ะะฐัััั:**
```
ะะฑัะฐั ะดะปะธะฝะฐ ะดะฐะฝะฝัั: 350 ะฑะฐะนั

ะะฐะบะตั 1: 15 ะฑะฐะนั   (KEY:0x42 + ะฝะฐัะฐะปะพ)
ะะฐะบะตั 2: 50 ะฑะฐะนั
ะะฐะบะตั 3: 100 ะฑะฐะนั
ะะฐะบะตั 4: 75 ะฑะฐะนั
ะะฐะบะตั 5: 60 ะฑะฐะนั
ะะฐะบะตั 6: 40 ะฑะฐะนั
ะะฐะบะตั 7: 25 ะฑะฐะนั
ะะฐะบะตั 8: FIN (0 ะฑะฐะนั ะดะฐะฝะฝัั)

ะัะพะณะพ payload: 15+50+100+75+60+40+25 = 365 ะฑะฐะนั
(15 ะฑะฐะนั = "KEY:0x42\n", ะพััะฐะปัะฝะพะต = 350 ะฑะฐะนั encrypted)
```

**ะะพัะตะผั ะฝะต ะพะดะธะฝ ะฑะพะปััะพะน ะฟะฐะบะตั?**

**MTU (Maximum Transmission Unit):**
```
Ethernet MTU: 1500 ะฑะฐะนั
โโ IP header: 20 ะฑะฐะนั
โโ TCP header: 20 ะฑะฐะนั
โโ Payload: 1460 ะฑะฐะนั (ะผะฐะบัะธะผัะผ!)
```

**ะัะปะธ ะดะฐะฝะฝัั > 1460:**
- TCP ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะฐะทะฑะธะฒะฐะตั ะฝะฐ ะฟะฐะบะตัั
- ะะฐะถะดัะน ะฟะฐะบะตั โค MTU
- ะะพะปััะฐัะตะปั ัะพะฑะธัะฐะตั ะฟะพ SEQ

**ะ ะผะธััะธะธ:**
- ะะณะตะฝัั Z. ะพัะฟัะฐะฒะปัะปะธ ัะพะพะฑัะตะฝะธะต
- 350 ะฑะฐะนั ะดะฐะฝะฝัั
- ะะฐะทะฑะธัะพ ะฝะฐ 7 ะฟะฐะบะตัะพะฒ ั ะดะฐะฝะฝัะผะธ + 1 FIN
- ะะฟัะธะผะฐะปัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต MTU

**ะัะพะฒะตัะบะฐ ะฒ ะบะพะดะต:**
```c
#define MAX_PAYLOAD 1460  // MTU - IP - TCP headers

void send_large_data(int sockfd, char *data, int len) {
    int sent = 0;
    while (sent < len) {
        int chunk = (len - sent > MAX_PAYLOAD) ? MAX_PAYLOAD : (len - sent);
        send(sockfd, data + sent, chunk, 0);
        sent += chunk;
    }
}
```

**ะฃัะพะบ:** TCP ะฟัะพะทัะฐัะฝะพ ะพะฑัะฐะฑะฐััะฒะฐะตั ััะฐะณะผะตะฝัะฐัะธั. ะั ะพัะฟัะฐะฒะปัะตัะต ะฟะพัะพะบ, TCP ัะฐะทะฑะธะฒะฐะตั ะฝะฐ ะฟะฐะบะตัั.
</details>

**9. ะ 08:00 ะฒั ะฒัััะตัะธะปะธัั ั Viktor ั ะกะฟะฐััะบะพะน ะฑะฐัะฝะธ. ะะฐะบะธะต OpSec ะผะตัั ะฝัะถะฝะพ ะฑัะปะพ ะฟัะธะฝััั ะดะปั ะฑะตะทะพะฟะฐัะฝะพะน ะฒัััะตัะธ?**

<details>
<summary>ะัะฒะตั</summary>

**Operational Security (OpSec) ะดะปั ัะธะทะธัะตัะบะพะน ะฒัััะตัะธ:**

**1. ะะฐััััั ะฑะตะท ัะปะตะถะบะธ:**
```
ะะ ะฝะฐะฟััะผัั ะธะท safe house!

ะัะฐะฒะธะปัะฝะพ:
Safe house โ Metro โ ะะตัะตัะฐะดะบะฐ โ ะะตัะบะพะผ โ ะัะฐัะฝะฐั ะฟะปะพัะฐะดั
(ะะณะตะฝัั Z. ะฝะต ะผะพะณัั ะพััะปะตะดะธัั ะฒ ะผะตััะพ)

ะะตะฟัะฐะฒะธะปัะฝะพ:
Safe house โ ะขะฐะบัะธ ะฝะฐะฟััะผัั
(ะะตะณะบะพ ะพััะปะตะดะธัั, geolocation)
```

**2. ะะพะฝัั-ะฝะฐะฑะปัะดะตะฝะธะต:**
```
08:00 โ ะั ะฟัะธัะพะดะธัะต ะฝะฐ ะฟะปะพัะฐะดั
07:45 โ ะัะพะฒะตัะบะฐ: ะฝะตั ะปะธ ัะปะตะถะบะธ?
        - ะะณะปัะฝััััั ะฝะตัะบะพะปัะบะพ ัะฐะท
        - ะะฐะนัะธ ะฒ ะผะฐะณะฐะทะธะฝ, ะฒัะนัะธ
        - ะะฐะฑะปัะดะฐัั ะทะฐ ัะพะปะฟะพะน

ะัะปะธ ัะปะตะถะบะฐ ะพะฑะฝะฐััะถะตะฝะฐ โ Abort!
```

**3. ะะฝะพะฝะธะผะฝัะต ััะตะดััะฒะฐ ัะฒัะทะธ:**
```
ะะทะฑะตะณะฐัั:
- ะะธัะฝัะน ัะตะปะตัะพะฝ (geolocation, IMSI catcher)
- Bluetooth, WiFi (MAC address tracking)
- ะัะตะดะธัะฝัะต ะบะฐััั (financial tracking)

ะัะฟะพะปัะทะพะฒะฐัั:
- Burner phone (ะพะดะฝะพัะฐะทะพะฒัะน ัะตะปะตัะพะฝ)
- Cash only
- VPN/Tor ะดะปั ะฟะพัะปะตะดะฝะธั ัะพะพะฑัะตะฝะธะน
```

**4. ะคะธะทะธัะตัะบะฐั ะผะฐัะบะธัะพะฒะบะฐ:**
```
- ะะฑััะฝะฐั ะพะดะตะถะดะฐ (ะฝะต ะฟัะธะฒะปะตะบะฐัั ะฒะฝะธะผะฐะฝะธั)
- ะะตะฟะบะฐ/ัะฐะฟะบะฐ (ัะบัััั ะปะธัะพ ะพั ะบะฐะผะตั)
- ะกะพะปะฝัะตะทะฐัะธัะฝัะต ะพัะบะธ (ัะฐัะฟะพะทะฝะฐะฒะฐะฝะธะต ะปะธั)
- ะขะพะปะฟะฐ (ัะฐััะฒะพัะธัััั ััะตะดะธ ัััะธััะพะฒ)
```

**5. ะัะตะผั ะธ ะผะตััะพ:**
```
08:00 ัััะฐ ะฝะฐ ะัะฐัะฝะพะน ะฟะปะพัะฐะดะธ:
โ ะะฝะพะณะพ ัััะธััะพะฒ (ัะพะปะฟะฐ)
โ ะะฐะฝะฝะตะต ัััะพ (ะผะตะฝััะต ะฒะฝะธะผะฐะฝะธั)
โ ะัะฑะปะธัะฝะพะต ะผะตััะพ (ะฑะตะทะพะฟะฐัะฝะตะต)
โ ะะตัะบะพะปัะบะพ ะฒััะพะดะพะฒ (escape routes)
```

**6. ะัะพัะพะบะพะป ะฒัััะตัะธ:**
```c
// ะัะตะฒะดะพะบะพะด ะฒัััะตัะธ:
if (viktor_approaching) {
    // 1. ะะธะทัะฐะปัะฝะฐั ะฟัะพะฒะตัะบะฐ
    if (no_surveillance_detected) {
        // 2. ะะพัะพัะบะธะน ะพะฑะผะตะฝ
        receive_usb_drive();
        confirm_receipt();
        
        // 3. ะััััะพะต ัะฐัััะฐะฒะฐะฝะธะต
        separate_in_different_directions();
    } else {
        // Abort mission
        walk_away_casually();
    }
}
```

**7. ะะพัะปะต ะฒัััะตัะธ:**
```
ะะ ะฒะพะทะฒัะฐัะฐัััั ะฒ safe house!
โ Safe house ัะบะพะผะฟัะพะผะตัะธัะพะฒะฐะฝ (Episode 11)
โ ะะพะฒะฐั ะปะพะบะฐัะธั ะดะปั Season 4
```

**ะ ะผะธััะธะธ:**
```
"ะขั ะฟัะธััะป," โ Viktor.
ะัััััะน ะพะฑะผะตะฝ.
USB-ัะปะตัะบะฐ ะฟะตัะตะดะฐะฝะฐ.
"ะฃะฒะธะดะธะผัั ะฒ Season 4."
ะะฝ ัะฐััะฒะพััะตััั ะฒ ััะผะฐะฝะต.

โ ะัะพัะตััะธะพะฝะฐะปัะฝะพ: ะผะธะฝะธะผัะผ ะฒัะตะผะตะฝะธ, ะผะฐะบัะธะผัะผ ะฑะตะทะพะฟะฐัะฝะพััะธ
```

**ะฃัะพะบ:** ะ ัะธะทะธัะตัะบะพะผ ะผะธัะต OpSec = ะฝะฐะฑะปัะดะตะฝะธะต + ะบะพะฝัั-ะฝะฐะฑะปัะดะตะฝะธะต + ะผะฐัะบะธัะพะฒะบะฐ.
</details>

**10. Viktor ะฟะตัะตะดะฐะป USB-ัะปะตัะบั ั Season 4. ะะฐะบะธะต ะผะตัั ะฑะตะทะพะฟะฐัะฝะพััะธ ะฟะตัะตะด ะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ?**

<details>
<summary>ะัะฒะตั</summary>

**ะะะะะะะ ะฝะต ะดะพะฒะตััะนัะต ะฝะตะธะทะฒะตััะฝัะผ USB!**

**ะฃะณัะพะทั:**
1. **Malware** (ะฒะธัััั, ััะพัะฝั)
2. **USB Killer** (ัะธะทะธัะตัะบะพะต ะฟะพะฒัะตะถะดะตะฝะธะต)
3. **BadUSB** (firmware ะฐัะฐะบะฐ)
4. **Data exfiltration** (ะบัะฐะถะฐ ะดะฐะฝะฝัั)

**ะะตัั ะฑะตะทะพะฟะฐัะฝะพััะธ:**

**1. ะะทะพะปะธัะพะฒะฐะฝะฝะฐั ัะธััะตะผะฐ:**
```bash
# ะะ ะฒััะฐะฒะปัะนัะต ะฒ ะพัะฝะพะฒะฝะพะน ะบะพะผะฟัััะตั!

# ะัะฟะพะปัะทัะนัะต:
- ะะธัััะฐะปัะฝัั ะผะฐัะธะฝั (VM)
- ะัะดะตะปัะฝัะน ะบะพะผะฟัััะตั (air-gapped)
- Live USB Linux (Tails, Kali)
```

**2. ะัะพะฒะตัะบะฐ ะฟะตัะตะด ะผะพะฝัะธัะพะฒะฐะฝะธะตะผ:**
```bash
# ะ Linux:
$ dmesg | tail  # ะะพัะผะพััะตัั, ััะพ detected
$ lsblk         # ะกะฟะธัะพะบ ะฑะปะพัะฝัั ััััะพะนััะฒ

# ะะ auto-mount!
$ sudo mount -o ro,noexec /dev/sdb1 /mnt/usb
#            ^^^^^^^^^^^^^^ Read-only, No execute
```

**3. ะะฝัะธะฒะธััั ัะบะฐะฝะธัะพะฒะฐะฝะธะต:**
```bash
# ClamAV:
$ clamscan -r /mnt/usb

# VirusTotal (ะตัะปะธ ะตััั ะธะฝัะตัะฝะตั):
$ for file in /mnt/usb/*; do
    sha256sum "$file" | curl -X POST https://virustotal.com/...
  done
```

**4. ะัะพะฒะตัะบะฐ ัะพะดะตัะถะธะผะพะณะพ:**
```bash
$ ls -la /mnt/usb
$ file /mnt/usb/*  # ะะฟัะตะดะตะปะธัั ัะธะฟั ัะฐะนะปะพะฒ
$ strings /mnt/usb/binary  # ะะพัะผะพััะตัั ัััะพะบะธ

# ะัะบะฐัั ะฟะพะดะพะทัะธัะตะปัะฝะพะต:
$ grep -r "eval\|exec\|system" /mnt/usb/
```

**5. Hex dump ะบัะธัะธัะฝัั ัะฐะนะปะพะฒ:**
```bash
$ hexdump -C /mnt/usb/season4.dat | head -n 20
00000000  53 34 3a 20 43 52 59 50  54 4f 0a           |S4: CRYPTO.|

# ะัะพะฒะตัะธัั ะฝะฐ:
- Shellcode
- ะกััะฐะฝะฝัะต ะฑะฐะนัั
- Embedded executables
```

**6. ะัะพะฒะตัะบะฐ firmware (BadUSB):**
```bash
# ะัะตะฝั ัะปะพะถะฝะพ! BadUSB ะผะพะถะตั ะฟัะธัะฒะพัะธัััั ะบะปะฐะฒะธะฐัััะพะน

# ะะฐัะธัะฐ:
- ะัะฟะพะปัะทะพะฒะฐัั USB data blocker (ัะพะปัะบะพ ะฟะธัะฐะฝะธะต, ะฝะต ะดะฐะฝะฝัะต)
- USB firewall (USBGuard ะฒ Linux)
- ะคะธะทะธัะตัะบะฐั ะฟัะพะฒะตัะบะฐ (ัะฐะทะพะฑัะฐัั, ะฟะพัะผะพััะตัั ัะธะฟ)
```

**ะ ะผะธััะธะธ:**
```
Viktor โ ะดะพะฒะตัะตะฝะฝะพะต ะปะธัะพ.
ะะพ ะฒ ัะตะฐะปัะฝะพััะธ:
- ะัะตะณะดะฐ ะฟัะพะฒะตััะนัะต
- ะะฐะถะต ะพั ะดััะทะตะน
- ะะพะผะฟัะพะผะตัะฐัะธั ะฒะพะทะผะพะถะฝะฐ
```

**ะะธะฝะธะผะฐะปัะฝัะน ะฟัะพัะพะบะพะป:**
```c
// 1. ะะทะพะปะธัะพะฒะฐะฝะฝะฐั VM
boot_clean_vm();

// 2. Mount read-only
mount_usb_readonly();

// 3. Scan
antivirus_scan();

// 4. Manual inspection
inspect_files();

// 5. Only then: use
if (all_checks_passed) {
    start_season4();
}
```

**ะฃัะพะบ:** ะะพะฒะตััะน, ะฝะพ ะฟัะพะฒะตััะน. USB = ะฟะพัะตะฝัะธะฐะปัะฝะฐั ัะณัะพะทะฐ.
</details>

---

### ๐ด ะะฝะฐะปะธะท ะบะพะดะฐ (4 ะฒะพะฟัะพัะฐ)

**11. ะะฐะนะดะธัะต ะพัะธะฑะบั ะฒ ัะตะบะพะฝััััะบัะธะธ TCP ัะตััะธะธ:**

```c
Packet packets[100];
int count = 0;

// ะกะฑะพั ะฟะฐะบะตัะพะฒ
while (recv_packet()) {
    packets[count].seq = get_seq();
    packets[count].payload = get_payload();
    count++;
}

// ะกะพััะธัะพะฒะบะฐ
qsort(packets, count, sizeof(Packet), compare_seq);

// ะกะฑะพัะบะฐ
for (int i = 0; i < count; i++) {
    strcat(stream, packets[i].payload);  // โ ะะจะะะะ?
}
```

<details>
<summary>ะัะฒะตั</summary>

**ะัะธะฑะบะฐ: `strcat()` ะดะปั ะฑะธะฝะฐัะฝัั ะดะฐะฝะฝัั!**

**ะัะพะฑะปะตะผะฐ:**
```c
strcat(stream, packets[i].payload);  // โ
```

1. **`strcat()` ะธัะตั `\0`:**
   - Payload ะผะพะถะตั ัะพะดะตัะถะฐัั `\0` ะฒ ัะตัะตะดะธะฝะต
   - `strcat()` ะพััะฐะฝะพะฒะธััั ะฟัะตะถะดะตะฒัะตะผะตะฝะฝะพ
   - ะะพัะตัั ะดะฐะฝะฝัั!

2. **ะะฐัะธััะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต = ะฑะธะฝะฐัะฝัะต:**
   - XOR ะผะพะถะตั ัะพะทะดะฐัั ะปัะฑัะต ะฑะฐะนัั (ะฒะบะปััะฐั 0x00)
   - ะญัะพ ะฝะต C-ัััะพะบะฐ!

3. **Buffer overflow ัะธัะบ:**
   - `strcat()` ะฝะต ะฟัะพะฒะตััะตั ัะฐะทะผะตั
   - ะะตัะตะฟะพะปะฝะตะฝะธะต `stream`

**ะัะฟัะฐะฒะปะตะฝะธะต:**
```c
char stream[10000];
int stream_len = 0;

for (int i = 0; i < count; i++) {
    // ะัะฟะพะปัะทัะนัะต memcpy, ะะ strcat!
    memcpy(stream + stream_len, 
           packets[i].payload, 
           packets[i].payload_len);
    
    stream_len += packets[i].payload_len;
    
    // ะัะพะฒะตัะบะฐ overflow:
    if (stream_len >= sizeof(stream)) {
        fprintf(stderr, "Stream too large!\n");
        break;
    }
}
```

**ะ ะผะธััะธะธ:**
```c
// ะะฐัะธััะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต:
char encrypted[] = {0x42, 0x00, 0xFF, 0x1A, ...};
//                        ^^^^ NULL byte! strcat ะพััะฐะฝะพะฒะธััั ะทะดะตัั!

// ะัะฐะฒะธะปัะฝะพ:
memcpy(stream, encrypted, encrypted_len);  // โ ะะพะฟะธััะตั ะฒัะต ะฑะฐะนัั
```

**ะฃัะพะบ:** `strcat()`, `strlen()`, `strcpy()` โ ัะพะปัะบะพ ะดะปั C-ัััะพะบ! ะะปั ะฑะธะฝะฐัะฝัั ะดะฐะฝะฝัั โ `memcpy()`.
</details>

**12. ะะพัะตะผั ััะพั XOR ะดะตัะธัั ะผะพะถะตั ะดะฐัั ะฝะตะฟัะฐะฒะธะปัะฝัะน ัะตะทัะปััะฐั?**

```c
char encrypted[350];
char decrypted[350];
uint8_t key = 0x42;

for (int i = 0; i < sizeof(encrypted); i++) {  // โ ะะจะะะะ?
    decrypted[i] = encrypted[i] ^ key;
}
printf("%s\n", decrypted);  // โ ะะจะะะะ?
```

<details>
<summary>ะัะฒะตั</summary>

**ะะฒะต ะพัะธะฑะบะธ: `sizeof()` ะฝะฐ ะผะฐััะธะฒะต + `printf("%s")` ะดะปั ะฑะธะฝะฐัะฝัั ะดะฐะฝะฝัั!**

**ะัะธะฑะบะฐ 1: `sizeof(encrypted)`**
```c
for (int i = 0; i < sizeof(encrypted); i++) {  // โ
```

- `sizeof(encrypted)` = ัะฐะทะผะตั ะผะฐััะธะฒะฐ (350), ะะ
- ะะตะฐะปัะฝะฐั ะดะปะธะฝะฐ ะดะฐะฝะฝัั ะผะพะถะตั ะฑััั ะผะตะฝััะต!
- ะะฐััะธัััะตัะต ะผััะพั ะฟะพัะปะต ะบะพะฝัะฐ ะดะฐะฝะฝัั

**ะัะธะฑะบะฐ 2: `printf("%s")`**
```c
printf("%s\n", decrypted);  // โ
```

- ะะฐััะธััะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต ะผะพะณัั ัะพะดะตัะถะฐัั `\0`
- `%s` ะพััะฐะฝะพะฒะธััั ะฝะฐ ะฟะตัะฒะพะผ `\0`
- ะฃะฒะธะดะธัะต ัะพะปัะบะพ ัะฐััั ัะพะพะฑัะตะฝะธั!

**ะัะฟัะฐะฒะปะตะฝะธะต:**
```c
char encrypted[350];
char decrypted[350];
uint8_t key = 0x42;
int actual_len = get_actual_length();  // ะะตะฐะปัะฝะฐั ะดะปะธะฝะฐ!

// ะะฐััะธััะพะฒะบะฐ
for (int i = 0; i < actual_len; i++) {  // โ ะัะฟะพะปัะทัะตะผ ัะตะฐะปัะฝัั ะดะปะธะฝั
    decrypted[i] = encrypted[i] ^ key;
}

// ะัะฒะพะด
for (int i = 0; i < actual_len; i++) {  // โ ะะพะฑะฐะนัะพะฒะพ
    printf("%c", decrypted[i]);
}
printf("\n");

// ะะปะธ (ะตัะปะธ ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ัะตะบัั):
decrypted[actual_len] = '\0';  // ะะพะฑะฐะฒะธัั null-terminator
printf("%s\n", decrypted);     // ะขะตะฟะตัั OK
```

**ะ ะผะธััะธะธ:**
```
Encrypted data: 350 ะฑะฐะนั
Decrypted:
"ะะพะทะดัะฐะฒะปัั, ะฐะณะตะฝั.\n\nะขั ะฟัะพััะป Season 3..."

ะะพะถะตั ัะพะดะตัะถะฐัั \n, ะฝะพ ะะ ะดะพะปะถะตะฝ ัะพะดะตัะถะฐัั \0 ะฒ ัะตัะตะดะธะฝะต.
ะะพ ะฒัั ัะฐะฒะฝะพ ะปัััะต ะพะฑัะฐะฑะฐััะฒะฐัั ะบะฐะบ ะฑะธะฝะฐัะฝัะต ะดะฐะฝะฝัะต!
```

**ะฃัะพะบ:** ะัะตะณะดะฐ ะทะฝะฐะนัะต ัะตะฐะปัะฝัั ะดะปะธะฝั ะดะฐะฝะฝัั. ะะต ะฟะพะปะฐะณะฐะนัะตัั ะฝะฐ `sizeof()` ะดะปั ะดะธะฝะฐะผะธัะตัะบะธั ะดะฐะฝะฝัั.
</details>

**13. ะ ััะผ ะฟัะพะฑะปะตะผะฐ ััะพะณะพ ะดะตัะตะบัะพัะฐ FIN ัะปะฐะณะฐ?**

```c
if (tcp->fin == 1) {  // โ ะะะะะะะะ?
    printf("Last packet detected!\n");
    break;
}
```

<details>
<summary>ะัะฒะตั</summary>

**ะัะพะฑะปะตะผะฐ: FIN ะผะพะถะตั ะฑััั ัััะฐะฝะพะฒะปะตะฝ ะฒะผะตััะต ั PSH ะธะปะธ ACK!**

**TCP ัะปะฐะณะธ โ ะฑะธัะพะฒะฐั ะผะฐัะบะฐ:**
```c
struct tcphdr {
    uint8_t fin : 1;  // Bit 0
    uint8_t syn : 1;  // Bit 1
    uint8_t rst : 1;  // Bit 2
    uint8_t psh : 1;  // Bit 3
    uint8_t ack : 1;  // Bit 4
    uint8_t urg : 1;  // Bit 5
};
```

**ะะพะผะฑะธะฝะฐัะธะธ:**
```
FIN ัะพะปัะบะพ:          0b000001
FIN + ACK:           0b010001  โ ะงะฐัััะน ัะปััะฐะน!
FIN + PSH + ACK:     0b011001  โ ะะพัะปะตะดะฝะธะน ะฟะฐะบะตั ั ะดะฐะฝะฝัะผะธ!
```

**ะัะฐะฒะธะปัะฝะฐั ะฟัะพะฒะตัะบะฐ:**
```c
// ะะฐัะธะฐะฝั 1: ะัะพะฒะตัะบะฐ ะฑะธัะพะฒะพะณะพ ะฟะพะปั
if (tcp->fin) {  // โ ะัะพะฒะตััะตั ะฑะธั, ะฝะตะทะฐะฒะธัะธะผะพ ะพั ะดััะณะธั
    printf("FIN detected!\n");
    
    // ะะพะถะตั ัะฐะบะถะต ะฟัะพะฒะตัะธัั PSH:
    if (tcp->psh) {
        printf("FIN + PSH: ะฟะพัะปะตะดะฝะธะน ะฟะฐะบะตั ั ะดะฐะฝะฝัะผะธ\n");
    }
}

// ะะฐัะธะฐะฝั 2: ะัะพะฒะตัะบะฐ ัะตัะตะท ะผะฐัะบะธ
#define TH_FIN 0x01

uint8_t flags = tcp->th_flags;
if (flags & TH_FIN) {  // โ ะะธัะพะฒะฐั ะผะฐัะบะฐ
    printf("FIN detected!\n");
}
```

**ะ ะผะธััะธะธ:**
```
[Packet 8] SEQ=1365, Flags: FIN+ACK

// ะะตะฟัะฐะฒะธะปัะฝะพ:
if (tcp->fin == 1) {  // ะะพะถะตั ะฝะต ััะฐะฑะพัะฐัั!

// ะัะฐะฒะธะปัะฝะพ:
if (tcp->fin) {  // โ ะกัะฐะฑะพัะฐะตั!
```

**ะััะณะธะต ะบะพะผะฑะธะฝะฐัะธะธ:**
```c
// SYN (ัััะฐะฝะพะฒะบะฐ ัะพะตะดะธะฝะตะฝะธั):
if (tcp->syn && !tcp->ack) {
    printf("SYN: ะทะฐะฟัะพั ะฝะฐ ะฟะพะดะบะปััะตะฝะธะต\n");
}

// SYN-ACK (ะพัะฒะตั ัะตัะฒะตัะฐ):
if (tcp->syn && tcp->ack) {
    printf("SYN-ACK: ัะตัะฒะตั ัะพะณะปะฐัะตะฝ\n");
}

// FIN-ACK (ะฒะตะถะปะธะฒะพะต ะทะฐะฒะตััะตะฝะธะต):
if (tcp->fin && tcp->ack) {
    printf("FIN-ACK: ะทะฐะฒะตััะฐะตะผ ัะพะตะดะธะฝะตะฝะธะต\n");
}

// RST (ะฐะฒะฐัะธะนะฝะพะต ะทะฐะฒะตััะตะฝะธะต):
if (tcp->rst) {
    printf("RST: connection reset!\n");
}
```

**ะฃัะพะบ:** TCP ัะปะฐะณะธ โ ััะพ ะฑะธัะพะฒัะต ะฟะพะปั. ะัะตะณะดะฐ ะฟัะพะฒะตััะนัะต ัะตัะตะท ะฑะธัะพะฒัะต ะพะฟะตัะฐัะธะธ ะธะปะธ ะฟััะผะพ ะฝะฐ ะฟะพะปะต.
</details>

**14. ะะฐะบ ะฟัะพะฒะตัะธัั, ััะพ ะฒัะต ะฟะฐะบะตัั ัะตััะธะธ ะฟะพะปััะตะฝั (ะฝะตั ะฟัะพะฟััะบะพะฒ)?**

<details>
<summary>ะัะฒะตั</summary>

**ะัะพะฒะตัะธัั ะฝะตะฟัะตััะฒะฝะพััั sequence numbers!**

**ะะปะณะพัะธัะผ:**
```c
int verify_complete_session(Packet *packets, int count) {
    if (count == 0) return 0;
    
    // ะกะพััะธัะพะฒะบะฐ ะฟะพ SEQ (ัะถะต ัะดะตะปะฐะฝะพ)
    qsort(packets, count, sizeof(Packet), compare_seq);
    
    // ะัะพะฒะตัะบะฐ ะฝะตะฟัะตััะฒะฝะพััะธ
    uint32_t expected_seq = packets[0].seq + packets[0].payload_len;
    
    for (int i = 1; i < count; i++) {
        if (packets[i].seq != expected_seq) {
            fprintf(stderr, "Gap detected!\n");
            fprintf(stderr, "Expected SEQ: %u\n", expected_seq);
            fprintf(stderr, "Got SEQ: %u\n", packets[i].seq);
            fprintf(stderr, "Missing: %u bytes\n", 
                    packets[i].seq - expected_seq);
            return 0;  // ะะตะฟะพะปะฝะฐั ัะตััะธั!
        }
        
        expected_seq = packets[i].seq + packets[i].payload_len;
    }
    
    // ะัะพะฒะตัะบะฐ FIN
    if (!packets[count - 1].is_fin) {
        fprintf(stderr, "Warning: No FIN flag on last packet\n");
        return 0;
    }
    
    printf("โ Complete session: %d packets, %u bytes\n", 
           count, expected_seq - packets[0].seq);
    return 1;
}
```

**ะัะธะผะตั ะฟัะพะฒะตัะบะธ:**
```
[Packet 1] SEQ=1000, len=15
Expected next: 1000 + 15 = 1015

[Packet 2] SEQ=1015, len=50
โ Correct! Expected next: 1015 + 50 = 1065

[Packet 3] SEQ=1065, len=100
โ Correct! Expected next: 1065 + 100 = 1165

[Packet 4] SEQ=1200, len=75
โ GAP! Expected 1165, got 1200
Missing: 1200 - 1165 = 35 bytes!
```

**ะะฑัะฐะฑะพัะบะฐ ะฟัะพะฟััะบะพะฒ:**
```c
if (gap_detected) {
    // ะะฐัะธะฐะฝั 1: ะะดะฐัั retransmit
    wait_for_retransmit();
    
    // ะะฐัะธะฐะฝั 2: ะะฐะฟัะพัะธัั ะฟะพะฒัะพั (ะตัะปะธ ะฒั ัะตัะฒะตั)
    send_ack_with_expected_seq(expected_seq);
    
    // ะะฐัะธะฐะฝั 3: ะะฐะฟะพะปะฝะธัั ะฝัะปัะผะธ (ะดะปั ะฐะฝะฐะปะธะทะฐ)
    memset(stream + pos, 0, gap_size);
    
    // ะะฐัะธะฐะฝั 4: Abort (ะตัะปะธ ะบัะธัะธัะฝะพ)
    fprintf(stderr, "Incomplete session, aborting\n");
    return -1;
}
```

**ะ ะผะธััะธะธ:**
```c
// ะัะต 8 ะฟะฐะบะตัะพะฒ ะฟะพะปััะตะฝั:
SEQ: 1000, 1015, 1065, 1165, 1240, 1300, 1340, 1365
Gaps: NONE โ
Last packet: FIN โ
Total: 365 bytes (15 + 50 + 100 + 75 + 60 + 40 + 25 + 0)
```

**ะฃัะพะบ:** TCP ะณะฐัะฐะฝัะธััะตั ะดะพััะฐะฒะบั, ะฝะพ ะฟัะธ packet sniffing ะฒั ะผะพะถะตัะต ะฟัะพะฟัััะธัั ะฟะฐะบะตัั. ะัะตะณะดะฐ ะฟัะพะฒะตััะนัะต!
</details>

---

### ๐ฏ ะกัะถะตั (2 ะฒะพะฟัะพัะฐ)

**15. Viktor ะฟะตัะตะดะฐะป USB-ัะปะตัะบั ั ะฝะฐะดะฟะธััั "S4: CRYPTO & ALGORITHMS". ะงัะพ ััะพ ะณะพะฒะพัะธั ะพ ััััะบัััะต Operation MOONLIGHT?**

<details>
<summary>ะัะฒะตั</summary>

**Operation MOONLIGHT โ ััะพ ะดะพะปะณะพััะพัะฝะฐั ะพะฑััะฐััะฐั ะฟัะพะณัะฐะผะผะฐ ั ะผะฝะพะณะพััะพะฒะฝะตะฒะพะน ััััะบัััะพะน!**

**ะััะธัะตะบัััะฐ ะพะฟะตัะฐัะธะธ:**

```
OPERATION MOONLIGHT โ 10 Seasons, 42 Episodes

Season 1: FOUNDATIONS (4 episodes, ~10h)
โโ XOR encryption, variables, arrays
โโ Control flow, logic
โโ Loops, patterns
โโ Functions, structs, modularity

Season 2: MEMORY & POINTERS (4 episodes, ~7.75h)
โโ Arrays, strings, memory layout
โโ Pointers, addresses
โโ Dynamic memory (malloc/free)
โโ Memory leaks, debugging

Season 3: NETWORKS (4 episodes, ~8h)  โ ะะซ ะะะะกะฌ!
โโ IP addressing, network basics
โโ Socket programming (TCP/UDP)
โโ Packet sniffing, raw sockets
โโ Session reconstruction, encryption

Season 4: CRYPTO & ALGORITHMS (4 episodes)  โ ะกะะะะฃะฎะฉะะ!
โโ Symmetric encryption (AES, ChaCha20)
โโ Blockchain, hash functions (SHA-256)
โโ Sorting, searching algorithms
โโ Data structures for crypto

Season 5: FINANCIAL MARKETS (4 episodes)
Season 6: EMBEDDED & IOT (4 episodes)
Season 7: SYSTEM PROGRAMMING (4 episodes)
Season 8: AI & DATA (4 episodes)
Season 9: ADVANCED SYSTEMS (5 episodes)
Season 10: FINAL MISSION (5 episodes)
```

**ะะฐะถะดัะน Season:**
- ะกััะพะธััั ะฝะฐ ะฟัะตะดัะดััะธั
- ะะพะฒัะต ะฝะฐะฒัะบะธ + ะธะฝัะตะณัะฐัะธั ััะฐััั
- ะกัะถะตั ะฟัะพะดะพะปะถะฐะตััั (Viktor, ะฐะณะตะฝัั Z.)

**ะ ะผะธััะธะธ Viktor:**
```
"ะะฟะตัะฐัะธั MOONLIGHT ะฟัะพะดะพะปะถะฐะตััั.
 ะฃะฒะธะดะธะผัั ะฒ Season 4."
```

**ะะฝะฐัะตะฝะธะต ะดะปั ะฒะฐั:**
- ะั โ ะฐะณะตะฝั ะฒ ะดะปะธัะตะปัะฝะพะน ะพะฟะตัะฐัะธะธ
- ะะฐะถะดัะน Season = ะฝะพะฒะฐั ะผะธััะธั
- ะคะธะฝะฐะป Season 10 = ะฟะพะปะฝะพะต ัะฐัะบัััะธะต
- Viktor = mentor ะฝะฐ ะฟัะพััะถะตะฝะธะธ ะฒัะตะณะพ ะฟััะธ

**ะะตะดะฐะณะพะณะธัะตัะบะฐั ััััะบัััะฐ:**
```
C Programming Path:
โโ Basics โ Memory โ Networks โ Crypto
โโ Finance โ Embedded โ Systems โ AI
โโ Advanced โ Final Mission

Skills accumulate:
Season 1: XOR
Season 2: Pointers
Season 3: Networks + XOR (integration!)
Season 4: AES + Networks (integration!)
...
Season 10: ALL skills combined
```

**ะฃัะพะบ:** ะะฑััะตะฝะธะต โ ััะพ journey, ะฝะต destination. ะะฐะถะดัะน ะฝะฐะฒัะบ ัััะพะธััั ะฝะฐ ะฟัะตะดัะดััะธั.
</details>

**16. ะ 08:00 Viktor ัะฐััะฒะพััะตััั ะฒ ััะผะฐะฝะต. ะฃะฒะธะดะธัะต ะปะธ ะฒั ะตะณะพ ัะฝะพะฒะฐ?**

<details>
<summary>ะัะฒะตั</summary>

**ะะฐ! Viktor โ ะฒะฐั mentor ะฝะฐ ะฟัะพััะถะตะฝะธะธ ะฒัะตะน Operation MOONLIGHT!**

**ะะพัะฒะปะตะฝะธั Viktor:**

**Season 1:**
- Episode 01: "ะฟะพะณะธะฑ" (ะธะฝััะตะฝะธัะพะฒะบะฐ)
- Episode 03: TWIST โ ะฒัะพัะพะน "V" ะฟัะตะดัะฟัะตะถะดะฐะตั
- Episode 04: ะะฝััััะบัะธะธ ัะตัะตะท moonlight-decoder

**Season 2:**
- Episode 05: GPS-ะบะพะพัะดะธะฝะฐัั ะบะฒะฐััะธัั ัััะดะตะฝัะฐ
- Episode 06: ะะฒะต ัะตะฟะพัะบะธ ัะบะฐะทะฐัะตะปะตะน (V. vs Z.)
- Episode 07: ะฃะดะฐะปัะฝะฝะฐั ะฐัะฐะบะฐ, ะธะฝััััะบัะธะธ
- Episode 08: ะขัะพัะฝ ะพั Z., ะบะพะพัะดะธะฝะฐัั ะัะฐัะฝะพะน ะฟะปะพัะฐะดะธ

**Season 3:**
- Episode 09: IP ั GPS-ะบะพะพัะดะธะฝะฐัะฐะผะธ
- Episode 10: ะกะตัะฒะตั ะฝะฐ 203.0.113.42:31337
- Episode 11: SMS: "ะะฝัะพัะผะฐัะธะพะฝะฝะฐั ะฒะพะนะฝะฐ"
- Episode 12: **ะะะะะะฏ ะะะงะะะฏ ะะกะขะะะงะ!**

**Season 4 ะธ ะดะฐะปะตะต:**
- Viktor ะฑัะดะตั ะฟะพัะฒะปััััั
- ะะพะฒัะต ะธะฝััััะบัะธะธ
- ะะฐะทะฒะธัะธะต ััะถะตัะฐ ะฟัะพ ะฐะณะตะฝัะพะฒ Z.
- ะคะธะฝะฐะปัะฝะพะต ัะฐัะบัััะธะต ะฒ Season 10

**ะงัะพ ะธะทะฒะตััะฝะพ ะพ Viktor:**
```
ะะผั: Viktor (ัะฐะผะธะปะธั ะฝะตะธะทะฒะตััะฝะฐ)
ะัะพัะตััะธั: ???
ะกะฒัะทั ั Z.: ะัะพัะธะฒะฝะธะบะธ
ะฆะตะปั: ะะฑััะธัั ะฒะฐั ะฝะฐะฒัะบะฐะผ
ะะธัะฝะพััั: ะะฐะณะฐะดะพัะฝะฐั
```

**ะ ัะธะฝะฐะปะต Season 3:**
```
"ะขั ะฟัะธััะป," โ Viktor.
ะัััััะน ะพะฑะผะตะฝ.
"ะะฟะตัะฐัะธั MOONLIGHT ะฟัะพะดะพะปะถะฐะตััั.
 ะฃะฒะธะดะธะผัั ะฒ Season 4."
 
ะะฝ ัะฐััะฒะพััะตััั ะฒ ััะผะฐะฝะต.
```

**ะะพะฟัะพัั ะฑะตะท ะพัะฒะตัะพะฒ:**
- ะัะพ ัะฐะบะธะต ะฐะณะตะฝัั Z.?
- ะะพัะตะผั Viktor ะธะฝััะตะฝะธัะพะฒะฐะป ัะผะตััั?
- ะะฐะบะพะฒะฐ ะฝะฐััะพััะฐั ัะตะปั Operation MOONLIGHT?
- ะัะพ ะฒั ะฒ ััะพะน ะธััะพัะธะธ?

**ะัะฒะตัั ะฒ:**
- Season 4: ัะฐัะบัััะธะต ัะฐััะธ ััะถะตัะฐ
- Season 7-8: ะฑะพะปััะต ะพ Z.
- Season 10: ัะธะฝะฐะปัะฝะพะต ัะฐัะบัััะธะต

**ะฃัะพะบ:** Good story keeps you engaged. Season 3 โ ััะพ ัะพะปัะบะพ ะฝะฐัะฐะปะพ ะฟััะธ.
</details>

---

### ๐ ะัะพะดะฒะธะฝัััะต (2 ะฒะพะฟัะพัะฐ)

**17. ะะฐะบ ะฐะณะตะฝัั Z. ะผะพะณะปะธ ะฐัะฐะบะพะฒะฐัั ะทะฐัะธััะพะฒะฐะฝะฝัะน ะฟะพัะพะบ ะฝะฐ 10.0.0.1:4433?**

<details>
<summary>ะัะฒะตั</summary>

**ะะฝะพะถะตััะฒะพ ะฒะตะบัะพัะพะฒ ะฐัะฐะบ, ะดะฐะถะต ะฝะฐ ะทะฐัะธััะพะฒะฐะฝะฝัะน ััะฐัะธะบ!**

**1. Traffic Analysis (ะฐะฝะฐะปะธะท ะผะตัะฐะดะฐะฝะฝัั):**
```
ะะฐะถะต ะตัะปะธ payload ะทะฐัะธััะพะฒะฐะฝ, ะฒะธะดะฝั:
- Source IP, Dest IP
- ะะพัั 4433
- ะะฐะทะผะตั ะฟะฐะบะตัะพะฒ
- Timing (ะบะพะณะดะฐ ะพัะฟัะฐะฒะปะตะฝั)
- ะะพะปะธัะตััะฒะพ ะฟะฐะบะตัะพะฒ

ะะณะตะฝัั Z. ะผะพะณัั:
โ ะะพะฝััั, ััะพ ะธะดัั ะบะพะผะผัะฝะธะบะฐัะธั
โ ะััะธัะปะธัั ััะฐััะฝะธะบะพะฒ
โ Timing attack (ะบะพะณะดะฐ ะพัะฟัะฐะฒะปัะตััั ะบะปัั?)
```

**2. Man-in-the-Middle (MITM):**
```
ะัะปะธ ะฐะณะตะฝัั Z. ะบะพะฝััะพะปะธัััั ัะตัั:

ะั โ ะะณะตะฝั Z. โ 10.0.0.1:4433
     (ะฟัะพะบัะธ)

ะะณะตะฝั Z.:
1. ะะตัะตัะฒะฐััะฒะฐะตั ะฒัะต ะฟะฐะบะตัั
2. ะะฐะฟะธััะฒะฐะตั ะทะฐัะธััะพะฒะฐะฝะฝัะน ะฟะพัะพะบ
3. ะะพะทะถะต: ะฑััััะพัั ะบะปััะฐ (ะตัะปะธ ัะปะฐะฑัะน)
4. ะะปะธ: key capture (ะตัะปะธ ะฟะตัะตะดะฐัะฐ ะบะปััะฐ ะฝะตะทะฐัะธัะตะฝะฐ)
```

**3. ะัะฐะบะฐ ะฝะฐ ะบะปัั:**
```c
// ะ ะผะธััะธะธ ะบะปัั ะฒ first packet:
"KEY:0x42\n<encrypted>"

ะัะพะฑะปะตะผะฐ:
- ะะปัั ะฟะตัะตะดะฐะฝ ะฒ PLAINTEXT! (ะฝะต ะทะฐัะธััะพะฒะฐะฝ)
- ะะณะตะฝัั Z. ะฟะตัะตัะฒะฐััะฒะฐัั ะฟะตัะฒัะน ะฟะฐะบะตั
- ะะทะฒะปะตะบะฐัั 0x42
- ะะฐััะธััะพะฒัะฒะฐัั ะฒะตัั ะฟะพัะพะบ!

ะะฐัะธัะฐ (TLS/SSL):
- Key exchange (Diffie-Hellman)
- ะะปัั ะฝะต ะฟะตัะตะดะฐัััั ะฝะฐะฟััะผัั
- Perfect Forward Secrecy
```

**4. XOR weakness:**
```c
// XOR ั ะพะดะฝะธะผ ะฑะฐะนัะพะผ:
ciphertext = plaintext ^ 0x42

ะัะฐะบะฐ:
1. Known plaintext attack:
   ะัะปะธ ะทะฝะฐะตัะต ัะฐััั plaintext
   โ ะะพัััะฐะฝะพะฒะธัะต ะบะปัั
   
2. Frequency analysis:
   ะะฝะณะปะธะนัะบะธะน ัะตะบัั ะธะผะตะตั ะฟะฐััะตัะฝั
   โ XOR ะฝะต ัะบััะฒะฐะตั ััะฐัะธััะธะบั
   โ ะะพะถะฝะพ ัะณะฐะดะฐัั ะบะปัั

3. Brute force:
   ะะปัั = 1 ะฑะฐะนั = 256 ะฒะฐัะธะฐะฝัะพะฒ!
   โ ะะตัะตะฑะพั ะทะฐ ะผะธะปะปะธัะตะบัะฝะดั
```

**5. Replay attack:**
```bash
# ะะณะตะฝัั Z. ะฟะตัะตัะฒะฐััะฒะฐัั ะฒัะต ะฟะฐะบะตัั:
$ sudo tcpdump -i eth0 port 4433 -w captured.pcap

# ะะพะทะถะต ะฟะพะฒัะพัััั:
$ tcpreplay -i eth0 captured.pcap

# ะัะปะธ ะฝะตั ะทะฐัะธัั ะพั replay:
โ ะะพะณัั ะฟะพะฒัะพัะธัั ะฒะฐัั ัะตััะธั
โ ะะพะปััะธัั ัะต ะถะต ะดะฐะฝะฝัะต
```

**6. DoS attack:**
```bash
# ะัะปะธ ะฝะต ะผะพะณัั ัะฐััะธััะพะฒะฐัั:
# ะัะพััะพ ะฑะปะพะบะธัััั ะบะพะผะผัะฝะธะบะฐัะธั

$ hping3 -S -p 4433 --flood 10.0.0.1
โ SYN flood
โ ะกะตัะฒะตั ะฝะต ะผะพะถะตั ะพะฑัะฐะฑะฐััะฒะฐัั ะปะตะณะธัะธะผะฝัะต ะทะฐะฟัะพัั
โ ะะฐั ะฟะตัะตัะฒะฐั ะฟัะพะฒะฐะปะตะฝ
```

**ะะฐัะธัะฐ (ะดะปั Season 4):**
```
1. TLS/SSL:
   - Proper key exchange
   - Strong ciphers (AES-256-GCM)
   - Perfect Forward Secrecy
   
2. Steganography:
   - ะกะบัััั ัะฐะผ ัะฐะบั ะบะพะผะผัะฝะธะบะฐัะธะธ
   - ะะฐะฝะฝัะต ะฒ ะธะทะพะฑัะฐะถะตะฝะธัั, ะฐัะดะธะพ
   
3. Tor/VPN:
   - ะกะบัััั IP ะฐะดัะตัะฐ
   - Multiple layers
   
4. Physical security:
   - ะะพะฒัะน safe house
   - ะัะพะฒะตัะบะฐ ะฝะฐ surveillance
```

**ะฃัะพะบ:** Encryption is not enough. ะัะถะฝะฐ ะทะฐัะธัะฐ ะบะปััะตะน, ะผะตัะฐะดะฐะฝะฝัั, ะธ ัะธะทะธัะตัะบะพะน ะฑะตะทะพะฟะฐัะฝะพััะธ.
</details>

**18. ะคะธะฝะฐะปัะฝัะน ะฒะพะฟัะพั: ะะพัะพะฒั ะปะธ ะฒั ะบ Season 4?**

<details>
<summary>ะัะฒะตั</summary>

**ะกะฐะผะพะฟัะพะฒะตัะบะฐ ะฝะฐะฒัะบะพะฒ:**

**โ Season 1: FOUNDATIONS**
```
โก XOR encryption/decryption
โก Variables, arrays, sizeof
โก if/else/switch, loops
โก Functions, structs, typedef
โก Makefile, ะผะพะดัะปัะฝะพััั
```

**โ Season 2: MEMORY & POINTERS**
```
โก ะะฐััะธะฒั, ัััะพะบะธ, memory layout
โก ะฃะบะฐะทะฐัะตะปะธ, ะฐะดัะตัะฐ, ัะฐะทัะผะตะฝะพะฒะฐะฝะธะต
โก malloc/free/realloc
โก ะฃัะตัะบะธ ะฟะฐะผััะธ, valgrind/leaks
โก Stack vs Heap
```

**โ Season 3: NETWORKS** โ ะะะะะะะฌะขะ ะกะะะงะะก!
```
โก IP-ะฐะดัะตัะฐัะธั (private/public, RFC 1918)
โก ะะพััั, network byte order (htons/htonl)
โก Socket programming (socket, connect, send, recv)
โก TCP handshake (SYN-SYN/ACK-ACK)
โก Challenge-response ะฟัะพัะพะบะพะป
โก Raw sockets (SOCK_RAW, IPPROTO_TCP)
โก Packet parsing (struct iphdr, struct tcphdr)
โก Payload extraction
โก TCP session reconstruction (sequence numbers)
โก XOR encryption ะฝะฐ ัะตัะตะฒะพะผ ััะพะฒะฝะต
```

**ะัะฐะบัะธัะตัะบะธะต ะฝะฐะฒัะบะธ:**
```bash
# ะะพะถะตัะต ะปะธ ะฒั:
$ ./net_analyzer addresses.txt  # โ ะะฐะนัะธ IP
$ ./moonlight_client 203.0.113.42 31337  # โ ะะพะดะบะปััะธัััั
$ sudo ./packet_sniffer  # โ ะะตัะตัะฒะฐัะธัั
$ sudo ./comm_interceptor  # โ ะะฐััะธััะพะฒะฐัั
```

**ะะพะฝัะตะฟััะฐะปัะฝะพะต ะฟะพะฝะธะผะฐะฝะธะต:**
```
โก ะะพะฝะธะผะฐั ัะฐะทะฝะธัั TCP vs UDP
โก ะะฝะฐั, ะทะฐัะตะผ ะฝัะถะตะฝ NAT
โก ะะพะณั ะพะฑัััะฝะธัั byte order
โก ะะพะฝะธะผะฐั, ะบะฐะบ ัะฐะฑะพัะฐะตั packet sniffing
โก ะะฝะฐั ัะณัะพะทั ะฑะตะทะพะฟะฐัะฝะพััะธ (DDoS, MITM, replay)
```

**ะกัะถะตั:**
```
โก ะะฝะฐั, ะบัะพ ัะฐะบะพะน Viktor
โก ะะฝะฐั ะฟัะพ ะฐะณะตะฝัะพะฒ Z.
โก ะะพะฝะธะผะฐั Operation MOONLIGHT
โก ะะพะผะฝั ะบะพะพัะดะธะฝะฐัั ะัะฐัะฝะพะน ะฟะปะพัะฐะดะธ
โก ะะพัะพะฒ ะบ Season 4!
```

**Season 4 ะฟะพััะตะฑัะตั:**
```
โ ะัะต ะฝะฐะฒัะบะธ Season 1-3
โ ะะพะฒะพะต: ะัะธะฟัะพะณัะฐัะธั (AES, RSA, hashes)
โ ะะพะฒะพะต: ะะปะณะพัะธัะผั (sorting, searching, graphs)
โ ะะพะฒะพะต: Blockchain (mining, proof-of-work)
โ ะะฝัะตะณัะฐัะธั: Networks + Crypto
```

**ะคะธะฝะฐะปัะฝัะน ัะตะบะปะธัั:**
```
โก ะัะพััะป ะฒัะต 4 ัะฟะธะทะพะดะฐ Season 3
โก ะัะฟะพะปะฝะธะป ะฒัะต ะทะฐะดะฐัะธ (net_analyzer, moonlight_client, packet_sniffer, comm_interceptor)
โก ะัะฒะตัะธะป ะฝะฐ ะบะพะฝััะพะปัะฝัะต ะฒะพะฟัะพัั (12+15+15+18 = 60 ะฒะพะฟัะพัะพะฒ!)
โก ะะพะฝะธะผะฐั ััะถะตั ะธ ะผะพัะธะฒะฐัะธั
โก ะะพัะพะฒ ะบ ะฒัััะตัะต ั ะบัะธะฟัะพะณัะฐัะธะตะน

ะัะปะธ ะะกะ โ โ Season 4 ัะฐะทะฑะปะพะบะธัะพะฒะฐะฝ!
```

**Viktor ะณะพะฒะพัะธั:**
```
"ะขั ะณะพัะพะฒ. Season 4 ะถะดัั.
 
 ะขะฐะผ ัะตะฑั ะถะดัั:
 - AES encryption (ะฝะฐััะพััะตะต ัะธััะพะฒะฐะฝะธะต)
 - SHA-256 hashing (blockchain basics)
 - RSA, ECC (asymmetric crypto)
 - Sorting algorithms (efficiency matters)
 
 ะฃะฒะธะดะธะผัั ัะฐะผ."
```

**ะะฐั ะพัะฒะตั:** ___________________

**ะัะปะธ ะณะพัะพะฒั โ Welcome to Season 4: CRYPTO & ALGORITHMS! ๐**
</details>

---

**๐ ะัะตะฝะบะฐ:**
- **16-18 ะฟัะฐะฒะธะปัะฝัั** โ Season 3 MASTER! ะะพัะพะฒั ะบ Season 4! ๐
- **12-15 ะฟัะฐะฒะธะปัะฝัั** โ ะพัะปะธัะฝะพ, ะฝะพ ะฟะพะฒัะพัะธัะต session reconstruction ๐
- **< 12 ะฟัะฐะฒะธะปัะฝัั** โ ะฟะตัะตัะธัะฐะนัะต Episode 12, ะทะฐะฟัััะธัะต comm_interceptor ๐

---

## ๐ฅ Easter Eggs

<details>
<summary>๐ ะัััะปะบะธ ะธ ัะตะบัะตัั</summary>

1. **TCP Session Reconstruction** โ ัะดัะพ ััะฝะบัะธะธ "Follow TCP Stream" ะฒ Wireshark
2. **Port 4433** โ ะฐะปััะตัะฝะฐัะธะฒะฝัะน HTTPS ะฟะพัั (4+4=8, 3+3=6 โ 86 โ HTTP Security)
3. **10.0.0.1** โ ะบะปะฐััะธัะตัะบะธะน ะฐะดัะตั ะฒะฝัััะตะฝะฝะตะณะพ ะผะฐัััััะธะทะฐัะพัะฐ
4. **Sequence numbers** โ ะธะทะพะฑัะตัะตะฝั ะฒ 1974 ะณะพะดั ะดะปั TCP (Vint Cerf, Bob Kahn)
5. **XOR ัะธััะพะฒะฐะฝะธะต** โ ะธัะฟะพะปัะทะพะฒะฐะปะพัั ะฒ RC4 (ะพะดะธะฝ ะธะท ัะฐะผัั ะฑัััััั stream ciphers)
6. **FIN flag** โ graceful shutdown (ัะปะตะณะฐะฝัะฝะพะต ะทะฐะฒะตััะตะฝะธะต), ะฒ ะพัะปะธัะธะต ะพั RST (abort)
7. **V.'s timestamp 06:47** โ 0x0647 hex, ะพัััะปะบะฐ ะบ RFC 647 (early network protocols)
8. **KEY:0x42** โ ัะฝะพะฒะฐ 0x42 (Answer to Everything ะธะท Hitchhiker's Guide)

**ะคะธะปะพัะพัะธั Season 3**: *"ะกะตัั โ ััะพ ัะบะฐะฝั. ะะฐะบะตัั โ ะฝะธัะธ. ะัะพัะพะบะพะปั โ ัะทะพัั. ะขั ะฝะฐััะธะปัั ะฒะธะดะตัั ะฒัั ะบะฐััะธะฝั ัะตะปะธะบะพะผ."*

</details>

---

## ๐ ะงัะพ ะดะฐะปััะต?

**Season 4: Crypto & Algorithms** ะถะดัั ะฒะฐั!

ะขะฐะผ ะฒั ะธะทััะธัะต:
- ะกะธะผะผะตััะธัะฝะพะต ัะธััะพะฒะฐะฝะธะต (AES, ChaCha20)
- ะฅัั-ััะฝะบัะธะธ (SHA-256, MD5)
- Blockchain ะธ Merkle trees
- ะะปะณะพัะธัะผั ัะพััะธัะพะฒะบะธ (QuickSort, MergeSort)
- ะกัััะบัััั ะดะฐะฝะฝัั (ะดะตัะตะฒัั, ะณัะฐัั, hash tables)

**ะกะปะพะถะฝะพััั ะฒะพะทัะฐััะฐะตั. ะะพ ะฒั ะณะพัะพะฒั.** ๐

---

## ๐ ะะฐะฒะธะณะฐัะธั

- [โ Episode 11: Packet Analysis](../episode-11-packet-analysis/README.md)
- [โ Season 4: Crypto & Algorithms](../../season-4-crypto-and-algorithms/README.md)
- [๐ Season 3: Networks](../README.md)
- [๐ ะะปะฐะฒะฝะฐั ัััะฐะฝะธัะฐ](../../README.md)

---

> *"You've mastered the network. Now master the code within. Season 4 awaits."* โ V.