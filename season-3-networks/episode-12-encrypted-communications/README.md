# Episode 12: "Encrypted Communications" üîê

> *"The final piece of the puzzle lies in the encrypted stream."*

---

## üé¨ BRIEFING

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  –õ–û–ö–ê–¶–ò–Ø: –ö–≤–∞—Ä—Ç–∏—Ä–∞, —Ä–∞–π–æ–Ω –ê—Ä–±–∞—Ç, –ú–æ—Å–∫–≤–∞                 ‚ïë
‚ïë  –í–†–ï–ú–Ø:   02:15, —á–µ—Ç–≤–µ—Ä–≥, 2 –æ–∫—Ç—è–±—Ä—è                     ‚ïë
‚ïë  –°–¢–ê–¢–£–°:  üî¥ FINAL MISSION - SEASON 3                    ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

–í—ã –ø—Ä–æ—à–ª–∏ —Ç—Ä–∏ —ç—Ç–∞–ø–∞: **IP-–∞–¥—Ä–µ—Å–∞—Ü–∏—é**, **—Å–æ–∫–µ—Ç—ã**, **–ø–µ—Ä–µ—Ö–≤–∞—Ç –ø–∞–∫–µ—Ç–æ–≤**.  
–¢–µ–ø–µ—Ä—å ‚Äî **—Ñ–∏–Ω–∞–ª Season 3**.

–í 02:12 –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ V.:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  FROM: V. (ENCRYPTED CHANNEL)               ‚îÇ
‚îÇ  TIME: 02:12:58 UTC                         ‚îÇ
‚îÇ  PRIORITY: CRITICAL                         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                             ‚îÇ
‚îÇ  –≠—Ç–æ —Ñ–∏–Ω–∞–ª Season 3.                        ‚îÇ
‚îÇ  –í—Å—ë, —á–µ–º—É —Ç—ã –Ω–∞—É—á–∏–ª—Å—è, —Å–æ–±–µ—Ä—ë—Ç—Å—è –≤–æ–µ–¥–∏–Ω–æ.  ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  –°–ò–¢–£–ê–¶–ò–Ø:                                  ‚îÇ
‚îÇ  –î–≤–∞ –∞–≥–µ–Ω—Ç–∞ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏     ‚îÇ
‚îÇ  –¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ TCP.                         ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  –ê–¥—Ä–µ—Å: 10.0.0.1:4433                       ‚îÇ
‚îÇ  –ü—Ä–æ—Ç–æ–∫–æ–ª: TCP —Å XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º            ‚îÇ
‚îÇ  –ö–ª—é—á: –í—Å—Ç—Ä–æ–µ–Ω –≤ –ø–µ—Ä–≤—ã–π –ø–∞–∫–µ—Ç               ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  –ó–ê–î–ê–ß–ê:                                    ‚îÇ
‚îÇ  1. –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å TCP-–ø–æ—Ç–æ–∫ (Episode 11)      ‚îÇ
‚îÇ  2. –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Å—Å–∏—é –ø–æ seq          ‚îÇ
‚îÇ  3. –ò–∑–≤–ª–µ—á—å –∫–ª—é—á –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞          ‚îÇ
‚îÇ  4. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å XOR (Episode 01)           ‚îÇ
‚îÇ  5. –ü–æ–ª—É—á–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ            ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  –≠—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –í–°–ï–• —Ç–≤–æ–∏—Ö –Ω–∞–≤—ã–∫–æ–≤.           ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  –£–¥–∞—á–∏. –¢—ã –≥–æ—Ç–æ–≤.                           ‚îÇ
‚îÇ  ‚Äî V.                                       ‚îÇ
‚îÇ                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ß—Ç–æ –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ:**
- –≠—Ç–æ **–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –≤—Å–µ—Ö —ç–ø–∏–∑–æ–¥–æ–≤ Season 3
- –ù—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å **packet sniffing** + **TCP session tracking** + **XOR decryption**
- **Sequence numbers** –ø–æ–º–æ–≥—É—Ç —É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –ø–∞–∫–µ—Ç—ã
- **–ü–µ—Ä–≤—ã–π –ø–∞–∫–µ—Ç** —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **–§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** –æ—Ç–∫—Ä–æ–µ—Ç –ø—É—Ç—å –∫ Season 4

–≠—Ç–æ **–º–æ–º–µ–Ω—Ç –∏—Å—Ç–∏–Ω—ã**. –í—Å—ë, —á—Ç–æ –≤—ã –∏–∑—É—á–∏–ª–∏, –¥–æ–ª–∂–Ω–æ —Å—Ä–∞–±–æ—Ç–∞—Ç—å.

### üéØ –ó–ê–î–ê–ß–ê

–°–æ–∑–¥–∞—Ç—å **`comm_interceptor`** ‚Äî —Å–∏—Å—Ç–µ–º—É –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π:
1. ‚úÖ –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å TCP —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –ø–æ—Ä—Ç—É 4433 (raw sockets)
2. ‚úÖ –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å TCP —Å–µ—Å—Å–∏—é –ø–æ sequence numbers
3. ‚úÖ –£–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –ø–∞–∫–µ—Ç—ã –ø–æ seq
4. ‚úÖ –ò–∑–≤–ª–µ—á—å –∫–ª—é—á –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞
5. ‚úÖ –û–±—ä–µ–¥–∏–Ω–∏—Ç—å payload –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–æ–≤
6. ‚úÖ –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å XOR
7. ‚úÖ –ü–æ–ª—É—á–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ V.

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** üî¥ Hard (Finale)  
**–ù–æ–≤—ã–µ –Ω–∞–≤—ã–∫–∏:** TCP session reconstruction, packet ordering, stream assembly

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  [!] –§–ò–ù–ê–õ–¨–ù–ê–Ø –ú–ò–°–°–ò–Ø SEASON 3               ‚ïë
‚ïë  –í—Å–µ –Ω–∞–≤—ã–∫–∏ —Å–æ–±–µ—Ä—É—Ç—Å—è –≤–æ–µ–¥–∏–Ω–æ:               ‚ïë
‚ïë  - XOR (Episode 01)                          ‚ïë
‚ïë  - IP –∞–¥—Ä–µ—Å–∞—Ü–∏—è (Episode 09)                 ‚ïë
‚ïë  - –°–æ–∫–µ—Ç—ã (Episode 10)                       ‚ïë
‚ïë  - Packet sniffing (Episode 11)              ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## üìö –¢–µ–æ—Ä–∏—è: TCP Session Reconstruction

### üí° –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏?

**Session reconstruction** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:
- üîç **Network forensics**: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
- üõ°Ô∏è **IDS/IPS**: –∞–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìä **Traffic analysis**: –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- üîê **Malware analysis**: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ C&C –∫–æ–º–∞–Ω–¥
- üì° **Protocol reverse engineering**: –ø–æ–Ω–∏–º–∞–Ω–∏–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

**Wireshark –¥–µ–ª–∞–µ—Ç –∏–º–µ–Ω–Ω–æ —ç—Ç–æ: "Follow TCP Stream".**

---

### 1. TCP Sequence Numbers

**–ö–∞–∂–¥—ã–π TCP –ø–∞–∫–µ—Ç** –∏–º–µ–µ—Ç:
- **SEQ** (sequence number) ‚Äî –Ω–æ–º–µ—Ä –ø–µ—Ä–≤–æ–≥–æ –±–∞–π—Ç–∞ –≤ —ç—Ç–æ–º –ø–∞–∫–µ—Ç–µ
- **ACK** (acknowledgment) ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è

```c
struct tcphdr *tcp = ...;
uint32_t seq = ntohl(tcp->seq);
uint32_t ack = ntohl(tcp->ack_seq);

printf("SEQ: %u, ACK: %u\n", seq, ack);
```

**–ü—Ä–∏–º–µ—Ä —Å–µ—Å—Å–∏–∏**:
```
[Packet 1] SEQ=1000, len=100  ‚Üí –¥–∞–Ω–Ω—ã–µ —Å –±–∞–π—Ç–∞ 1000 –ø–æ 1099
[Packet 2] SEQ=1100, len=50   ‚Üí –¥–∞–Ω–Ω—ã–µ —Å –±–∞–π—Ç–∞ 1100 –ø–æ 1149
[Packet 3] SEQ=1150, len=200  ‚Üí –¥–∞–Ω–Ω—ã–µ —Å –±–∞–π—Ç–∞ 1150 –ø–æ 1349
```

**–ü–æ—Ä—è–¥–æ–∫ –ø–∞–∫–µ—Ç–æ–≤** –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∞—Ç—å—Å—è! –ù—É–∂–Ω–æ **—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ SEQ**.

---

### 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ TCP —Å–µ—Å—Å–∏–∏

**–°–µ—Å—Å–∏—è** –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è –ø–æ:
- Source IP
- Source Port
- Destination IP
- Destination Port

```c
typedef struct {
    uint32_t src_ip;
    uint32_t dst_ip;
    uint16_t src_port;
    uint16_t dst_port;
} SessionKey;

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π
int same_session(SessionKey *a, SessionKey *b) {
    return (a->src_ip == b->src_ip &&
            a->dst_ip == b->dst_ip &&
            a->src_port == b->src_port &&
            a->dst_port == b->dst_port);
}
```

---

### 3. –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ —Å–µ—Å—Å–∏–∏

```c
#define MAX_PACKETS 1000

typedef struct {
    uint32_t seq;
    unsigned char data[2048];
    int data_len;
} Packet;

typedef struct {
    SessionKey key;
    Packet packets[MAX_PACKETS];
    int packet_count;
} Session;

// –î–æ–±–∞–≤–∏—Ç—å –ø–∞–∫–µ—Ç –≤ —Å–µ—Å—Å–∏—é
void add_packet(Session *session, uint32_t seq, unsigned char *data, int len) {
    int idx = session->packet_count;
    session->packets[idx].seq = seq;
    memcpy(session->packets[idx].data, data, len);
    session->packets[idx].data_len = len;
    session->packet_count++;
}
```

---

### 4. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ SEQ

```c
int compare_packets(const void *a, const void *b) {
    Packet *p1 = (Packet*)a;
    Packet *p2 = (Packet*)b;
    return (p1->seq > p2->seq) - (p1->seq < p2->seq);
}

// –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã
qsort(session->packets, session->packet_count, sizeof(Packet), compare_packets);
```

---

### 5. –°–±–æ—Ä–∫–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```c
// –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ –ø–∞–∫–µ—Ç—ã –≤ –æ–¥–∏–Ω –±—É—Ñ–µ—Ä
unsigned char stream[65536];
int stream_len = 0;

for (int i = 0; i < session->packet_count; i++) {
    memcpy(stream + stream_len, 
           session->packets[i].data, 
           session->packets[i].data_len);
    stream_len += session->packets[i].data_len;
}

printf("Total stream size: %d bytes\n", stream_len);
```

---

### 6. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞

**–ü—Ä–æ—Ç–æ–∫–æ–ª V.**:
```
[Packet 1] (—Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º SEQ):
–§–æ—Ä–º–∞—Ç: "KEY:<hex_key>\n<encrypted_data>"
–ü—Ä–∏–º–µ—Ä: "KEY:0x42\nEncrypted message here"
```

```c
// –ü–∞—Ä—Å–∏–Ω–≥ –∫–ª—é—á–∞
unsigned char *first_packet = session->packets[0].data;
uint8_t key = 0;

if (sscanf((char*)first_packet, "KEY:0x%02hhx\n", &key) == 1) {
    printf("Encryption key: 0x%02X\n", key);
}

// –ù–∞–π—Ç–∏ –Ω–∞—á–∞–ª–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø–æ—Å–ª–µ "\n")
unsigned char *encrypted = (unsigned char*)strchr((char*)first_packet, '\n');
if (encrypted) {
    encrypted++;  // –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å '\n'
}
```

---

### 7. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ XOR (–∏–∑ Episode 01)

```c
void xor_decrypt(unsigned char *data, int len, uint8_t key) {
    for (int i = 0; i < len; i++) {
        data[i] ^= key;
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
xor_decrypt(encrypted, encrypted_len, key);
printf("Decrypted: %s\n", encrypted);
```

---

### 8. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Å—Å–∏–π (advanced)

```c
#define MAX_SESSIONS 10

Session sessions[MAX_SESSIONS];
int session_count = 0;

// –ù–∞–π—Ç–∏ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é
Session* find_or_create_session(SessionKey *key) {
    // –ò—Å–∫–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
    for (int i = 0; i < session_count; i++) {
        if (same_session(&sessions[i].key, key)) {
            return &sessions[i];
        }
    }
    
    // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é
    if (session_count < MAX_SESSIONS) {
        sessions[session_count].key = *key;
        sessions[session_count].packet_count = 0;
        return &sessions[session_count++];
    }
    
    return NULL;
}
```

---

## üéØ –ú–∏—Å—Å–∏—è: "Communication Interceptor"

### –õ–µ–≥–µ–Ω–¥–∞

–î–≤–∞ –∞–≥–µ–Ω—Ç–∞ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π TCP –∫–∞–Ω–∞–ª –Ω–∞ **10.0.0.1:4433**.

**–ü—Ä–æ—Ç–æ–∫–æ–ª –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏**:
1. **–ü–µ—Ä–≤—ã–π –ø–∞–∫–µ—Ç** (–Ω–∞–∏–º–µ–Ω—å—à–∏–π SEQ): —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª—é—á –≤ —Ñ–æ—Ä–º–∞—Ç–µ `KEY:0x??`
2. **–û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã**: –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (XOR)
3. **–ü–æ—Ä—è–¥–æ–∫ –ø–∞–∫–µ—Ç–æ–≤**: —Å–ª—É—á–∞–π–Ω—ã–π (–Ω—É–∂–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ SEQ)

**–í–∞—à–∞ –∑–∞–¥–∞—á–∞**: –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å, —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å.

---

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ—à–µ–Ω–∏—è

```
1. –°–æ–∑–¥–∞—Ç—å raw socket (SOCK_RAW, IPPROTO_TCP)
2. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã –≤ —Ü–∏–∫–ª–µ
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞:
   - –ü–∞—Ä—Å–∏—Ç—å IP –∏ TCP –∑–∞–≥–æ–ª–æ–≤–∫–∏
   - –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –ø–æ—Ä—Ç—É 4433
   - –ò–∑–≤–ª–µ—á—å SEQ –∏ payload
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –º–∞—Å—Å–∏–≤
4. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (FIN flag):
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã –ø–æ SEQ
   - –ò–∑–≤–ª–µ—á—å –∫–ª—é—á –∏–∑ –ø–µ—Ä–≤–æ–≥–æ
   - –û–±—ä–µ–¥–∏–Ω–∏—Ç—å payload –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–æ–≤
   - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å XOR
   - –í—ã–≤–µ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
```

---

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–ø–∏–∑–æ–¥–∞

```
episode-12-encrypted-communications/
‚îú‚îÄ‚îÄ README.md              ‚Üê –í—ã –∑–¥–µ—Å—å
‚îú‚îÄ‚îÄ mission.md
‚îú‚îÄ‚îÄ starter.c              ‚Üê –®–∞–±–ª–æ–Ω interceptor
‚îú‚îÄ‚îÄ artifacts/
‚îÇ   ‚îî‚îÄ‚îÄ comm_interceptor.c ‚Üê –°–æ–∑–¥–∞–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ solution/
‚îÇ   ‚îú‚îÄ‚îÄ comm_interceptor_solution.c
‚îÇ   ‚îú‚îÄ‚îÄ encrypted_sender.c    ‚Üê –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ encrypted_receiver.c
‚îî‚îÄ‚îÄ tests/
    ‚îî‚îÄ‚îÄ test.sh
```

### üí° –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å:

1. **–ò–∑—É—á–∏—Ç–µ** `starter.c` ‚Äî —Ç–∞–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Session, Packet —Å TODO
2. **–°–æ–∑–¥–∞–π—Ç–µ** —Ñ–∞–π–ª `artifacts/comm_interceptor.c`
3. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ** –ø–æ–ª–Ω—É—é —Ü–µ–ø–æ—á–∫—É:
   - Raw socket –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
   - –ü–∞—Ä—Å–∏–Ω–≥ IP/TCP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ –ø–æ —Å–µ—Å—Å–∏—è–º
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ sequence numbers
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–∞
   - XOR —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞
   - –í—ã–≤–æ–¥ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
4. **–°–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ**: `gcc -Wall -o comm_interceptor artifacts/comm_interceptor.c`
5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å sudo**: `sudo ./comm_interceptor`

> üí° **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `encrypted_sender/receiver` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞!

---

### –ü–æ–¥—Å–∫–∞–∑–∫–∏

<details>
<summary>–ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω–µ—Ü —Å–µ—Å—Å–∏–∏?</summary>

```c
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FIN flag
if (tcp->fin) {
    printf("Session closing (FIN received)\n");
    // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–µ—Å—Å–∏—é
}
```
</details>

<details>
<summary>–ö–∞–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã?</summary>

```c
#include <stdlib.h>

int compare_packets(const void *a, const void *b) {
    Packet *p1 = (Packet*)a;
    Packet *p2 = (Packet*)b;
    
    if (p1->seq < p2->seq) return -1;
    if (p1->seq > p2->seq) return 1;
    return 0;
}

qsort(session->packets, session->packet_count, sizeof(Packet), compare_packets);
```
</details>

<details>
<summary>–ö–∞–∫ –∏–∑–≤–ª–µ—á—å –∫–ª—é—á?</summary>

```c
// –ü–µ—Ä–≤—ã–π –ø–∞–∫–µ—Ç (–ø–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏)
Packet *first = &session->packets[0];

uint8_t key = 0;
if (sscanf((char*)first->data, "KEY:0x%02hhx", &key) == 1) {
    printf("Found key: 0x%02X\n", key);
}

// –î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ "KEY:0x??\n"
char *encrypted_start = strchr((char*)first->data, '\n');
if (encrypted_start) {
    encrypted_start++;  // Skip '\n'
}
```
</details>

<details>
<summary>–ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –≤–µ—Å—å –ø–æ—Ç–æ–∫?</summary>

```c
unsigned char stream[65536];
int stream_len = 0;

// –ù–∞—á–∞—Ç—å —Å–æ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞–∫–µ—Ç–∞ (–ø–µ—Ä–≤—ã–π - KEY)
for (int i = 1; i < session->packet_count; i++) {
    memcpy(stream + stream_len, 
           session->packets[i].data, 
           session->packets[i].data_len);
    stream_len += session->packets[i].data_len;
}

// –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å
xor_decrypt(stream, stream_len, key);
printf("Decrypted message:\n%s\n", stream);
```
</details>

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ö–æ–º–ø–∏–ª—è—Ü–∏—è
gcc -Wall -o comm_interceptor artifacts/comm_interceptor.c

# –í –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–µ–º–Ω–∏–∫
gcc -Wall -o receiver solution/encrypted_receiver.c
./receiver &

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
gcc -Wall -o sender solution/encrypted_sender.c
./sender &

# –í —Ç—Ä–µ—Ç—å–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ (—Å sudo!)
sudo ./comm_interceptor

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ç—Ä–∞—Ñ–∏–∫
pkill receiver
pkill sender
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç TCP –ø–∞–∫–µ—Ç—ã –Ω–∞ –ø–æ—Ä—Ç—É 4433
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–∞—Ä—Å–∏—Ç SEQ numbers
- –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–∞–∫–µ—Ç—ã –ø–æ –ø–æ—Ä—è–¥–∫—É
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–ª—é—á –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç payload
- –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç XOR
- –í—ã–≤–æ–¥–∏—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ V.

---

## üé¨ DEBRIEFING

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  –õ–û–ö–ê–¶–ò–Ø: –ö–≤–∞—Ä—Ç–∏—Ä–∞, —Ä–∞–π–æ–Ω –ê—Ä–±–∞—Ç, –ú–æ—Å–∫–≤–∞                 ‚ïë
‚ïë  –í–†–ï–ú–Ø:   06:47, —á–µ—Ç–≤–µ—Ä–≥, 2 –æ–∫—Ç—è–±—Ä—è                     ‚ïë
‚ïë  –°–¢–ê–¢–£–°:  üü¢ MISSION ACCOMPLISHED - SEASON 3 COMPLETE    ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

`comm_interceptor` –∑–∞–ø—É—â–µ–Ω. –ü–µ—Ä–µ—Ö–≤–∞—Ç –Ω–∞—á–∞—Ç. –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –†–µ–∑—É–ª—å—Ç–∞—Ç:

```
=== COMMUNICATION INTERCEPTOR ===
Listening for encrypted traffic on port 4433...

[Session detected]
10.0.0.1:54321 ‚Üî 10.0.0.1:4433

Captured 8 packets, reconstructing stream...

[Packet 1] SEQ=1000, len=15: "KEY:0x42\n..."
[Packet 2] SEQ=1015, len=50
[Packet 3] SEQ=1065, len=100
[Packet 4] SEQ=1165, len=75
[Packet 5] SEQ=1240, len=60
[Packet 6] SEQ=1300, len=40
[Packet 7] SEQ=1340, len=25
[Packet 8] SEQ=1365, FIN flag

Sorting by sequence number... ‚úì
Extracting key from first packet... ‚úì
Key: 0x42

Assembling stream... ‚úì
Total encrypted data: 350 bytes

Decrypting with XOR... ‚úì

üéØ DECRYPTED MESSAGE:
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                       ‚ïë
‚ïë  –ü–æ–∑–¥—Ä–∞–≤–ª—è—é, –∞–≥–µ–Ω—Ç.                                   ‚ïë
‚ïë                                                       ‚ïë
‚ïë  –¢—ã –ø—Ä–æ—à—ë–ª Season 3: NETWORKS.                        ‚ïë
‚ïë                                                       ‚ïë
‚ïë  –¢—ã –æ—Å–≤–æ–∏–ª:                                           ‚ïë
‚ïë  ‚úì IP-–∞–¥—Ä–µ—Å–∞—Ü–∏—é –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–µ—Ç–µ–π                     ‚ïë
‚ïë  ‚úì Socket programming (TCP/UDP)                       ‚ïë
‚ïë  ‚úì Raw sockets –∏ packet sniffing                      ‚ïë
‚ïë  ‚úì TCP session reconstruction                         ‚ïë
‚ïë  ‚úì XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∫—É                        ‚ïë
‚ïë                                                       ‚ïë
‚ïë  –°–µ—Ç—å –±–æ–ª—å—à–µ –Ω–µ —Ç–∞–π–Ω–∞. –¢—ã –≤–∏–¥–∏—à—å –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö.       ‚ïë
‚ïë  –¢—ã –ø–æ–Ω–∏–º–∞–µ—à—å –ø—Ä–æ—Ç–æ–∫–æ–ª—ã. –¢—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å –∫–∞–Ω–∞–ª.      ‚ïë
‚ïë                                                       ‚ïë
‚ïë  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê             ‚ïë
‚ïë                                                       ‚ïë
‚ïë  –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ö–†–ò–ü–¢–û–ì–†–ê–§–ò–Ø.                         ‚ïë
‚ïë                                                       ‚ïë
‚ïë  Season 4: Crypto & Algorithms                        ‚ïë
‚ïë  –¢–∞–º —Ç–µ–±—è –∂–¥—É—Ç –Ω–∞—Å—Ç–æ—è—â–∏–µ –≤—ã–∑–æ–≤—ã:                      ‚ïë
‚ïë  - –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ                            ‚ïë
‚ïë  - –•—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏ –∏ blockchain                           ‚ïë
‚ïë  - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –ø–æ–∏—Å–∫                                 ‚ïë
‚ïë  - –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö                                   ‚ïë
‚ïë                                                       ‚ïë
‚ïë  –ì–æ—Ç–æ–≤—å—Å—è. –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç.                      ‚ïë
‚ïë                                                       ‚ïë
‚ïë  –î–æ –≤—Å—Ç—Ä–µ—á–∏ –≤ Season 4.                               ‚ïë
‚ïë                                                       ‚ïë
‚ïë  ‚Äî V.                                                 ‚ïë
‚ïë                                                       ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

Session closed gracefully.
```

---

### üèÜ SEASON 3 COMPLETE!

**–í—ã –æ—Å–≤–æ–∏–ª–∏:**
- üåê **IP-–∞–¥—Ä–µ—Å–∞—Ü–∏—é** ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –∫–∏–±–µ—Ä–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
- üîå **–°–æ–∫–µ—Ç—ã** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ª—é–±–æ–º—É —Å–µ—Ä–≤–µ—Ä—É
- üì° **Packet sniffing** ‚Äî –≤–∏–¥–∏—Ç–µ –≤—Å—ë, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Å–µ—Ç–∏
- üîê **Session reconstruction** ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏

**–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø–æ–ª—É—á–µ–Ω—ã:**
- `net_analyzer` ‚Äî –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä IP-–∞–¥—Ä–µ—Å–æ–≤
- `moonlight_client` ‚Äî TCP –∫–ª–∏–µ–Ω—Ç
- `packet_sniffer` ‚Äî –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ –ø–∞–∫–µ—Ç–æ–≤
- `comm_interceptor` ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞

### üéñÔ∏è –§–∏–Ω–∞–ª—å–Ω—ã–π –Ω–∞–≤—ã–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω:
**"Network Wizard"** ‚Äî –í—ã –≤–ª–∞–¥–µ–µ—Ç–µ —Å–µ—Ç—è–º–∏ –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö: –æ—Ç IP –¥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

---

## ü•ö Easter Eggs

<details>
<summary>üîç –û—Ç—Å—ã–ª–∫–∏ –∏ —Å–µ–∫—Ä–µ—Ç—ã</summary>

1. **TCP Session Reconstruction** ‚Äî —è–¥—Ä–æ —Ñ—É–Ω–∫—Ü–∏–∏ "Follow TCP Stream" –≤ Wireshark
2. **Port 4433** ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π HTTPS –ø–æ—Ä—Ç (4+4=8, 3+3=6 ‚Üí 86 ‚Üí HTTP Security)
3. **10.0.0.1** ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞
4. **Sequence numbers** ‚Äî –∏–∑–æ–±—Ä–µ—Ç–µ–Ω—ã –≤ 1974 –≥–æ–¥—É –¥–ª—è TCP (Vint Cerf, Bob Kahn)
5. **XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –≤ RC4 (–æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö stream ciphers)
6. **FIN flag** ‚Äî graceful shutdown (—ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ), –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç RST (abort)
7. **V.'s timestamp 06:47** ‚Äî 0x0647 hex, –æ—Ç—Å—ã–ª–∫–∞ –∫ RFC 647 (early network protocols)
8. **KEY:0x42** ‚Äî —Å–Ω–æ–≤–∞ 0x42 (Answer to Everything –∏–∑ Hitchhiker's Guide)

**–§–∏–ª–æ—Å–æ—Ñ–∏—è Season 3**: *"–°–µ—Ç—å ‚Äî —ç—Ç–æ —Ç–∫–∞–Ω—å. –ü–∞–∫–µ—Ç—ã ‚Äî –Ω–∏—Ç–∏. –ü—Ä–æ—Ç–æ–∫–æ–ª—ã ‚Äî —É–∑–æ—Ä—ã. –¢—ã –Ω–∞—É—á–∏–ª—Å—è –≤–∏–¥–µ—Ç—å –≤—Å—é –∫–∞—Ä—Ç–∏–Ω—É —Ü–µ–ª–∏–∫–æ–º."*

</details>

---

## üéì –ß—Ç–æ –¥–∞–ª—å—à–µ?

**Season 4: Crypto & Algorithms** –∂–¥—ë—Ç –≤–∞—Å!

–¢–∞–º –≤—ã –∏–∑—É—á–∏—Ç–µ:
- –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (AES, ChaCha20)
- –•—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏ (SHA-256, MD5)
- Blockchain –∏ Merkle trees
- –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (QuickSort, MergeSort)
- –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (–¥–µ—Ä–µ–≤—å—è, –≥—Ä–∞—Ñ—ã, hash tables)

**–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç. –ù–æ –≤—ã –≥–æ—Ç–æ–≤—ã.** üöÄ

---

## üîó –ù–∞–≤–∏–≥–∞—Ü–∏—è

- [‚Üê Episode 11: Packet Analysis](../episode-11-packet-analysis/README.md)
- [‚Üí Season 4: Crypto & Algorithms](../../season-4-crypto-and-algorithms/README.md)
- [üìã Season 3: Networks](../README.md)
- [üè† –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞](../../README.md)

---

> *"You've mastered the network. Now master the code within. Season 4 awaits."* ‚Äî V.