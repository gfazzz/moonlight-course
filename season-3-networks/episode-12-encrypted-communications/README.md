# Episode 12: "Encrypted Communications" ğŸ”

> *"The final piece of the puzzle lies in the encrypted stream."*

---

## ğŸ¬ BRIEFING

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Ğ›ĞĞšĞĞ¦Ğ˜Ğ¯: ĞšĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğ°, Ñ€Ğ°Ğ¹Ğ¾Ğ½ ĞÑ€Ğ±Ğ°Ñ‚, ĞœĞ¾ÑĞºĞ²Ğ°                 â•‘
â•‘  Ğ’Ğ Ğ•ĞœĞ¯:   02:15, Ñ‡ĞµÑ‚Ğ²ĞµÑ€Ğ³, 2 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ                     â•‘
â•‘  Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡:  ğŸ”´ FINAL MISSION - SEASON 3                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

Ğ’Ñ‹ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¸ Ñ‚Ñ€Ğ¸ ÑÑ‚Ğ°Ğ¿Ğ°: **IP-Ğ°Ğ´Ñ€ĞµÑĞ°Ñ†Ğ¸Ñ**, **ÑĞ¾ĞºĞµÑ‚Ñ‹**, **Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚ Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²**.  
Ğ¢ĞµĞ¿ĞµÑ€ÑŒ â€” **Ñ„Ğ¸Ğ½Ğ°Ğ» Season 3**.

Ğ’ 02:12 Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ V.:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FROM: V. (ENCRYPTED CHANNEL)               â”‚
â”‚  TIME: 02:12:58 UTC                         â”‚
â”‚  PRIORITY: CRITICAL                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  Ğ­Ñ‚Ğ¾ Ñ„Ğ¸Ğ½Ğ°Ğ» Season 3.                        â”‚
â”‚  Ğ’ÑÑ‘, Ñ‡ĞµĞ¼Ñƒ Ñ‚Ñ‹ Ğ½Ğ°ÑƒÑ‡Ğ¸Ğ»ÑÑ, ÑĞ¾Ğ±ĞµÑ€Ñ‘Ñ‚ÑÑ Ğ²Ğ¾ĞµĞ´Ğ¸Ğ½Ğ¾.  â”‚
â”‚                                             â”‚
â”‚  Ğ¡Ğ˜Ğ¢Ğ£ĞĞ¦Ğ˜Ğ¯:                                  â”‚
â”‚  Ğ”Ğ²Ğ° Ğ°Ğ³ĞµĞ½Ñ‚Ğ° Ğ¾Ğ±Ğ¼ĞµĞ½Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸     â”‚
â”‚  Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ñ‡ĞµÑ€ĞµĞ· TCP.                         â”‚
â”‚                                             â”‚
â”‚  ĞĞ´Ñ€ĞµÑ: 10.0.0.1:4433                       â”‚
â”‚  ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»: TCP Ñ XOR ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼            â”‚
â”‚  ĞšĞ»ÑÑ‡: Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½ Ğ² Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¿Ğ°ĞºĞµÑ‚               â”‚
â”‚                                             â”‚
â”‚  Ğ—ĞĞ”ĞĞ§Ğ:                                    â”‚
â”‚  1. ĞŸĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ¸Ñ‚ÑŒ TCP-Ğ¿Ğ¾Ñ‚Ğ¾Ğº (Episode 11)      â”‚
â”‚  2. Ğ ĞµĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞµÑÑĞ¸Ñ Ğ¿Ğ¾ seq          â”‚
â”‚  3. Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ ĞºĞ»ÑÑ‡ Ğ¸Ğ· Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ°ĞºĞµÑ‚Ğ°          â”‚
â”‚  4. Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ XOR (Episode 01)           â”‚
â”‚  5. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ            â”‚
â”‚                                             â”‚
â”‚  Ğ­Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ’Ğ¡Ğ•Ğ¥ Ñ‚Ğ²Ğ¾Ğ¸Ñ… Ğ½Ğ°Ğ²Ñ‹ĞºĞ¾Ğ².           â”‚
â”‚                                             â”‚
â”‚  Ğ£Ğ´Ğ°Ñ‡Ğ¸. Ğ¢Ñ‹ Ğ³Ğ¾Ñ‚Ğ¾Ğ².                           â”‚
â”‚  â€” V.                                       â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ§Ñ‚Ğ¾ Ğ²Ñ‹ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚Ğµ:**
- Ğ­Ñ‚Ğ¾ **Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ** Ğ²ÑĞµÑ… ÑĞ¿Ğ¸Ğ·Ğ¾Ğ´Ğ¾Ğ² Season 3
- ĞÑƒĞ¶Ğ½Ğ¾ Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒ **packet sniffing** + **TCP session tracking** + **XOR decryption**
- **Sequence numbers** Ğ¿Ğ¾Ğ¼Ğ¾Ğ³ÑƒÑ‚ ÑƒĞ¿Ğ¾Ñ€ÑĞ´Ğ¾Ñ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹
- **ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¿Ğ°ĞºĞµÑ‚** ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ ĞºĞ»ÑÑ‡ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- **Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ** Ğ¾Ñ‚ĞºÑ€Ğ¾ĞµÑ‚ Ğ¿ÑƒÑ‚ÑŒ Ğº Season 4

Ğ­Ñ‚Ğ¾ **Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ¸ÑÑ‚Ğ¸Ğ½Ñ‹**. Ğ’ÑÑ‘, Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ Ğ¸Ğ·ÑƒÑ‡Ğ¸Ğ»Ğ¸, Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ.

### ğŸ¯ Ğ—ĞĞ”ĞĞ§Ğ

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ **`comm_interceptor`** â€” ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ° Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… ĞºĞ¾Ğ¼Ğ¼ÑƒĞ½Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¹:
1. âœ… ĞŸĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ¸Ñ‚ÑŒ TCP Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 4433 (raw sockets)
2. âœ… Ğ ĞµĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ TCP ÑĞµÑÑĞ¸Ñ Ğ¿Ğ¾ sequence numbers
3. âœ… Ğ£Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ñ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹ Ğ¿Ğ¾ seq
4. âœ… Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ ĞºĞ»ÑÑ‡ Ğ¸Ğ· Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ°ĞºĞµÑ‚Ğ°
5. âœ… ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒ payload Ğ²ÑĞµÑ… Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²
6. âœ… Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ XOR
7. âœ… ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ V.

**Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ:** ğŸ”´ Hard (Finale)  
**ĞĞ¾Ğ²Ñ‹Ğµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸:** TCP session reconstruction, packet ordering, stream assembly

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  [!] Ğ¤Ğ˜ĞĞĞ›Ğ¬ĞĞĞ¯ ĞœĞ˜Ğ¡Ğ¡Ğ˜Ğ¯ SEASON 3               â•‘
â•‘  Ğ’ÑĞµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸ ÑĞ¾Ğ±ĞµÑ€ÑƒÑ‚ÑÑ Ğ²Ğ¾ĞµĞ´Ğ¸Ğ½Ğ¾:               â•‘
â•‘  - XOR (Episode 01)                          â•‘
â•‘  - IP Ğ°Ğ´Ñ€ĞµÑĞ°Ñ†Ğ¸Ñ (Episode 09)                 â•‘
â•‘  - Ğ¡Ğ¾ĞºĞµÑ‚Ñ‹ (Episode 10)                       â•‘
â•‘  - Packet sniffing (Episode 11)              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ“š Ğ¢ĞµĞ¾Ñ€Ğ¸Ñ: TCP Session Reconstruction

### ğŸ’¡ Ğ—Ğ°Ñ‡ĞµĞ¼ ÑÑ‚Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸?

**Session reconstruction** Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ²:
- ğŸ” **Network forensics**: Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸Ğ½Ñ†Ğ¸Ğ´ĞµĞ½Ñ‚Ğ°
- ğŸ›¡ï¸ **IDS/IPS**: Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ°Ñ‚Ğ°Ğº Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
- ğŸ“Š **Traffic analysis**: Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ° ĞºĞ¾Ğ¼Ğ¼ÑƒĞ½Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
- ğŸ” **Malware analysis**: Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ C&C ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´
- ğŸ“¡ **Protocol reverse engineering**: Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ½ĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ¾Ğ²

**Wireshark Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ ÑÑ‚Ğ¾: "Follow TCP Stream".**

---

### 1. TCP Sequence Numbers

**ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ TCP Ğ¿Ğ°ĞºĞµÑ‚** Ğ¸Ğ¼ĞµĞµÑ‚:
- **SEQ** (sequence number) â€” Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ±Ğ°Ğ¹Ñ‚Ğ° Ğ² ÑÑ‚Ğ¾Ğ¼ Ğ¿Ğ°ĞºĞµÑ‚Ğµ
- **ACK** (acknowledgment) â€” Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ

```c
struct tcphdr *tcp = ...;
uint32_t seq = ntohl(tcp->seq);
uint32_t ack = ntohl(tcp->ack_seq);

printf("SEQ: %u, ACK: %u\n", seq, ack);
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ÑĞµÑÑĞ¸Ğ¸**:
```
[Packet 1] SEQ=1000, len=100  â†’ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ Ğ±Ğ°Ğ¹Ñ‚Ğ° 1000 Ğ¿Ğ¾ 1099
[Packet 2] SEQ=1100, len=50   â†’ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ Ğ±Ğ°Ğ¹Ñ‚Ğ° 1100 Ğ¿Ğ¾ 1149
[Packet 3] SEQ=1150, len=200  â†’ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ Ğ±Ğ°Ğ¹Ñ‚Ğ° 1150 Ğ¿Ğ¾ 1349
```

**ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²** Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ½Ğ°Ñ€ÑƒÑˆĞ°Ñ‚ÑŒÑÑ! ĞÑƒĞ¶Ğ½Ğ¾ **ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ SEQ**.

---

### 2. ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ TCP ÑĞµÑÑĞ¸Ğ¸

**Ğ¡ĞµÑÑĞ¸Ñ** Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ¿Ğ¾:
- Source IP
- Source Port
- Destination IP
- Destination Port

```c
typedef struct {
    uint32_t src_ip;
    uint32_t dst_ip;
    uint16_t src_port;
    uint16_t dst_port;
} SessionKey;

// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ ÑĞµÑÑĞ¸Ğ¹
int same_session(SessionKey *a, SessionKey *b) {
    return (a->src_ip == b->src_ip &&
            a->dst_ip == b->dst_ip &&
            a->src_port == b->src_port &&
            a->dst_port == b->dst_port);
}
```

---

### 3. Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ² ÑĞµÑÑĞ¸Ğ¸

```c
#define MAX_PACKETS 1000

typedef struct {
    uint32_t seq;
    unsigned char data[2048];
    int data_len;
} Packet;

typedef struct {
    SessionKey key;
    Packet packets[MAX_PACKETS];
    int packet_count;
} Session;

// Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚ Ğ² ÑĞµÑÑĞ¸Ñ
void add_packet(Session *session, uint32_t seq, unsigned char *data, int len) {
    int idx = session->packet_count;
    session->packets[idx].seq = seq;
    memcpy(session->packets[idx].data, data, len);
    session->packets[idx].data_len = len;
    session->packet_count++;
}
```

---

### 4. Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ SEQ

```c
int compare_packets(const void *a, const void *b) {
    Packet *p1 = (Packet*)a;
    Packet *p2 = (Packet*)b;
    return (p1->seq > p2->seq) - (p1->seq < p2->seq);
}

// Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹
qsort(session->packets, session->packet_count, sizeof(Packet), compare_packets);
```

---

### 5. Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```c
// ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹ Ğ² Ğ¾Ğ´Ğ¸Ğ½ Ğ±ÑƒÑ„ĞµÑ€
unsigned char stream[65536];
int stream_len = 0;

for (int i = 0; i < session->packet_count; i++) {
    memcpy(stream + stream_len, 
           session->packets[i].data, 
           session->packets[i].data_len);
    stream_len += session->packets[i].data_len;
}

printf("Total stream size: %d bytes\n", stream_len);
```

---

### 6. Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ»ÑÑ‡Ğ° Ğ¸Ğ· Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ°ĞºĞµÑ‚Ğ°

**ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» V.**:
```
[Packet 1] (Ñ Ğ½Ğ°Ğ¸Ğ¼ĞµĞ½ÑŒÑˆĞ¸Ğ¼ SEQ):
Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: "KEY:<hex_key>\n<encrypted_data>"
ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: "KEY:0x42\nEncrypted message here"
```

```c
// ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ ĞºĞ»ÑÑ‡Ğ°
unsigned char *first_packet = session->packets[0].data;
uint8_t key = 0;

if (sscanf((char*)first_packet, "KEY:0x%02hhx\n", &key) == 1) {
    printf("Encryption key: 0x%02X\n", key);
}

// ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾ Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Ğ¿Ğ¾ÑĞ»Ğµ "\n")
unsigned char *encrypted = (unsigned char*)strchr((char*)first_packet, '\n');
if (encrypted) {
    encrypted++;  // ĞŸÑ€Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ '\n'
}
```

---

### 7. Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²ĞºĞ° XOR (Ğ¸Ğ· Episode 01)

```c
void xor_decrypt(unsigned char *data, int len, uint8_t key) {
    for (int i = 0; i < len; i++) {
        data[i] ^= key;
    }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
xor_decrypt(encrypted, encrypted_len, key);
printf("Decrypted: %s\n", encrypted);
```

---

### 8. ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… ÑĞµÑÑĞ¸Ğ¹ (advanced)

```c
#define MAX_SESSIONS 10

Session sessions[MAX_SESSIONS];
int session_count = 0;

// ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¸Ğ»Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑĞµÑÑĞ¸Ñ
Session* find_or_create_session(SessionKey *key) {
    // Ğ˜ÑĞºĞ°Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ
    for (int i = 0; i < session_count; i++) {
        if (same_session(&sessions[i].key, key)) {
            return &sessions[i];
        }
    }
    
    // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²ÑƒÑ
    if (session_count < MAX_SESSIONS) {
        sessions[session_count].key = *key;
        sessions[session_count].packet_count = 0;
        return &sessions[session_count++];
    }
    
    return NULL;
}
```

---

## ğŸ¯ ĞœĞ¸ÑÑĞ¸Ñ: "Communication Interceptor"

### Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°

Ğ”Ğ²Ğ° Ğ°Ğ³ĞµĞ½Ñ‚Ğ° Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ²Ğ½Ğ¸ĞºĞ° Ğ¾Ğ±Ğ¼ĞµĞ½Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸ĞµĞ¹ Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ TCP ĞºĞ°Ğ½Ğ°Ğ» Ğ½Ğ° **10.0.0.1:4433**.

**ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» ĞºĞ¾Ğ¼Ğ¼ÑƒĞ½Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸**:
1. **ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¿Ğ°ĞºĞµÑ‚** (Ğ½Ğ°Ğ¸Ğ¼ĞµĞ½ÑŒÑˆĞ¸Ğ¹ SEQ): ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ ĞºĞ»ÑÑ‡ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ `KEY:0x??`
2. **ĞÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹**: Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (XOR)
3. **ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²**: ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹ (Ğ½ÑƒĞ¶Ğ½Ğ° ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ SEQ)

**Ğ’Ğ°ÑˆĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°**: Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ¸Ñ‚ÑŒ, Ñ€ĞµĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ, Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ.

---

### ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ

```
1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ raw socket (SOCK_RAW, IPPROTO_TCP)
2. ĞŸĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹ Ğ² Ñ†Ğ¸ĞºĞ»Ğµ
3. Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¿Ğ°ĞºĞµÑ‚Ğ°:
   - ĞŸĞ°Ñ€ÑĞ¸Ñ‚ÑŒ IP Ğ¸ TCP Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
   - Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 4433
   - Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ SEQ Ğ¸ payload
   - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ²
4. ĞŸĞ¾ÑĞ»Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ (FIN flag):
   - Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹ Ğ¿Ğ¾ SEQ
   - Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ ĞºĞ»ÑÑ‡ Ğ¸Ğ· Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾
   - ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒ payload Ğ²ÑĞµÑ… Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²
   - Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ XOR
   - Ğ’Ñ‹Ğ²ĞµÑÑ‚Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
```

---

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ÑĞ¿Ğ¸Ğ·Ğ¾Ğ´Ğ°

```
episode-12-encrypted-communications/
â”œâ”€â”€ README.md              â† Ğ’Ñ‹ Ğ·Ğ´ĞµÑÑŒ
â”œâ”€â”€ mission.md
â”œâ”€â”€ starter.c              â† Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½ interceptor
â”œâ”€â”€ artifacts/
â”‚   â””â”€â”€ comm_interceptor.c â† Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ ÑÑ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ»
â”œâ”€â”€ solution/
â”‚   â”œâ”€â”€ comm_interceptor_solution.c
â”‚   â”œâ”€â”€ encrypted_sender.c    â† Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
â”‚   â””â”€â”€ encrypted_receiver.c
â””â”€â”€ tests/
    â””â”€â”€ test.sh
```

### ğŸ’¡ ĞšĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ:

1. **Ğ˜Ğ·ÑƒÑ‡Ğ¸Ñ‚Ğµ** `starter.c` â€” Ñ‚Ğ°Ğ¼ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ Session, Packet Ñ TODO
2. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ** Ñ„Ğ°Ğ¹Ğ» `artifacts/comm_interceptor.c`
3. **Ğ ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞ¹Ñ‚Ğµ** Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºÑƒ:
   - Raw socket Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ°
   - ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ IP/TCP Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¾Ğ²
   - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ² Ğ¿Ğ¾ ÑĞµÑÑĞ¸ÑĞ¼
   - Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ sequence numbers
   - Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ»ÑÑ‡Ğ°
   - XOR Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²ĞºĞ°
   - Ğ’Ñ‹Ğ²Ğ¾Ğ´ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
4. **Ğ¡ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ**: `gcc -Wall -o comm_interceptor artifacts/comm_interceptor.c`
5. **Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ñ sudo**: `sudo ./comm_interceptor`

> ğŸ’¡ **Ğ”Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ**: Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ `encrypted_sender/receiver` Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°!

---

### ĞŸĞ¾Ğ´ÑĞºĞ°Ğ·ĞºĞ¸

<details>
<summary>ĞšĞ°Ğº Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½ĞµÑ† ÑĞµÑÑĞ¸Ğ¸?</summary>

```c
// ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ FIN flag
if (tcp->fin) {
    printf("Session closing (FIN received)\n");
    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ¸ Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞµÑÑĞ¸Ñ
}
```
</details>

<details>
<summary>ĞšĞ°Ğº ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹?</summary>

```c
#include <stdlib.h>

int compare_packets(const void *a, const void *b) {
    Packet *p1 = (Packet*)a;
    Packet *p2 = (Packet*)b;
    
    if (p1->seq < p2->seq) return -1;
    if (p1->seq > p2->seq) return 1;
    return 0;
}

qsort(session->packets, session->packet_count, sizeof(Packet), compare_packets);
```
</details>

<details>
<summary>ĞšĞ°Ğº Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ ĞºĞ»ÑÑ‡?</summary>

```c
// ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¿Ğ°ĞºĞµÑ‚ (Ğ¿Ğ¾ÑĞ»Ğµ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸)
Packet *first = &session->packets[0];

uint8_t key = 0;
if (sscanf((char*)first->data, "KEY:0x%02hhx", &key) == 1) {
    printf("Found key: 0x%02X\n", key);
}

// Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾ÑĞ»Ğµ "KEY:0x??\n"
char *encrypted_start = strchr((char*)first->data, '\n');
if (encrypted_start) {
    encrypted_start++;  // Skip '\n'
}
```
</details>

<details>
<summary>ĞšĞ°Ğº ÑĞ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ²ĞµÑÑŒ Ğ¿Ğ¾Ñ‚Ğ¾Ğº?</summary>

```c
unsigned char stream[65536];
int stream_len = 0;

// ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞ¾ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ğ°ĞºĞµÑ‚Ğ° (Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ - KEY)
for (int i = 1; i < session->packet_count; i++) {
    memcpy(stream + stream_len, 
           session->packets[i].data, 
           session->packets[i].data_len);
    stream_len += session->packets[i].data_len;
}

// Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
xor_decrypt(stream, stream_len, key);
printf("Decrypted message:\n%s\n", stream);
```
</details>

---

## âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°

```bash
# ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ
gcc -Wall -o comm_interceptor artifacts/comm_interceptor.c

# Ğ’ Ğ¾Ğ´Ğ½Ğ¾Ğ¼ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ: Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸ĞµĞ¼Ğ½Ğ¸Ğº
gcc -Wall -o receiver solution/encrypted_receiver.c
./receiver &

# Ğ’ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¼ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ: Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ĞµĞ»Ñ
gcc -Wall -o sender solution/encrypted_sender.c
./sender &

# Ğ’ Ñ‚Ñ€ĞµÑ‚ÑŒĞµĞ¼ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ: Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‡Ğ¸Ğº (Ñ sudo!)
sudo ./comm_interceptor

# ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº
pkill receiver
pkill sender
```

**ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸ ÑƒÑĞ¿ĞµÑ…Ğ°**:
- ĞŸĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ TCP Ğ¿Ğ°ĞºĞµÑ‚Ñ‹ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 4433
- ĞšĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ Ğ¿Ğ°Ñ€ÑĞ¸Ñ‚ SEQ numbers
- Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹ Ğ¿Ğ¾ Ğ¿Ğ¾Ñ€ÑĞ´ĞºÑƒ
- Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ ĞºĞ»ÑÑ‡ Ğ¸Ğ· Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ°ĞºĞµÑ‚Ğ°
- ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½ÑĞµÑ‚ payload
- Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ñ‹Ğ²Ğ°ĞµÑ‚ XOR
- Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ñ‚ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ V.

---

## ğŸ¬ DEBRIEFING

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Ğ›ĞĞšĞĞ¦Ğ˜Ğ¯: ĞšĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğ°, Ñ€Ğ°Ğ¹Ğ¾Ğ½ ĞÑ€Ğ±Ğ°Ñ‚, ĞœĞ¾ÑĞºĞ²Ğ°                 â•‘
â•‘  Ğ’Ğ Ğ•ĞœĞ¯:   06:47, Ñ‡ĞµÑ‚Ğ²ĞµÑ€Ğ³, 2 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ                     â•‘
â•‘  Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡:  ğŸŸ¢ MISSION ACCOMPLISHED - SEASON 3 COMPLETE    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

`comm_interceptor` Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½. ĞŸĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚ Ğ½Ğ°Ñ‡Ğ°Ñ‚. Ğ ĞµĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°. Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:

```
=== COMMUNICATION INTERCEPTOR ===
Listening for encrypted traffic on port 4433...

[Session detected]
10.0.0.1:54321 â†” 10.0.0.1:4433

Captured 8 packets, reconstructing stream...

[Packet 1] SEQ=1000, len=15: "KEY:0x42\n..."
[Packet 2] SEQ=1015, len=50
[Packet 3] SEQ=1065, len=100
[Packet 4] SEQ=1165, len=75
[Packet 5] SEQ=1240, len=60
[Packet 6] SEQ=1300, len=40
[Packet 7] SEQ=1340, len=25
[Packet 8] SEQ=1365, FIN flag

Sorting by sequence number... âœ“
Extracting key from first packet... âœ“
Key: 0x42

Assembling stream... âœ“
Total encrypted data: 350 bytes

Decrypting with XOR... âœ“

ğŸ¯ DECRYPTED MESSAGE:
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                       â•‘
â•‘  ĞŸĞ¾Ğ·Ğ´Ñ€Ğ°Ğ²Ğ»ÑÑ, Ğ°Ğ³ĞµĞ½Ñ‚.                                   â•‘
â•‘                                                       â•‘
â•‘  Ğ¢Ñ‹ Ğ¿Ñ€Ğ¾ÑˆÑ‘Ğ» Season 3: NETWORKS.                        â•‘
â•‘                                                       â•‘
â•‘  Ğ¢Ñ‹ Ğ¾ÑĞ²Ğ¾Ğ¸Ğ»:                                           â•‘
â•‘  âœ“ IP-Ğ°Ğ´Ñ€ĞµÑĞ°Ñ†Ğ¸Ñ Ğ¸ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ ÑĞµÑ‚ĞµĞ¹                     â•‘
â•‘  âœ“ Socket programming (TCP/UDP)                       â•‘
â•‘  âœ“ Raw sockets Ğ¸ packet sniffing                      â•‘
â•‘  âœ“ TCP session reconstruction                         â•‘
â•‘  âœ“ XOR ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ´ĞµÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²ĞºÑƒ                        â•‘
â•‘                                                       â•‘
â•‘  Ğ¡ĞµÑ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ½Ğµ Ñ‚Ğ°Ğ¹Ğ½Ğ°. Ğ¢Ñ‹ Ğ²Ğ¸Ğ´Ğ¸ÑˆÑŒ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….       â•‘
â•‘  Ğ¢Ñ‹ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµÑˆÑŒ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ñ‹. Ğ¢Ñ‹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¸Ñ€ÑƒĞµÑˆÑŒ ĞºĞ°Ğ½Ğ°Ğ».      â•‘
â•‘                                                       â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•             â•‘
â•‘                                                       â•‘
â•‘  Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³: ĞšĞ Ğ˜ĞŸĞ¢ĞĞ“Ğ ĞĞ¤Ğ˜Ğ¯.                         â•‘
â•‘                                                       â•‘
â•‘  Season 4: Crypto & Algorithms                        â•‘
â•‘  Ğ¢Ğ°Ğ¼ Ñ‚ĞµĞ±Ñ Ğ¶Ğ´ÑƒÑ‚ Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğµ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹:                      â•‘
â•‘  - Ğ¡Ğ¸Ğ¼Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡Ğ½Ğ¾Ğµ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ                            â•‘
â•‘  - Ğ¥ÑÑˆ-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¸ blockchain                           â•‘
â•‘  - Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ¿Ğ¾Ğ¸ÑĞº                                 â•‘
â•‘  - Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…                                   â•‘
â•‘                                                       â•‘
â•‘  Ğ“Ğ¾Ñ‚Ğ¾Ğ²ÑŒÑÑ. Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ°ĞµÑ‚.                      â•‘
â•‘                                                       â•‘
â•‘  Ğ”Ğ¾ Ğ²ÑÑ‚Ñ€ĞµÑ‡Ğ¸ Ğ² Season 4.                               â•‘
â•‘                                                       â•‘
â•‘  â€” V.                                                 â•‘
â•‘                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Session closed gracefully.
```

---

### ğŸ† SEASON 3 COMPLETE!

**Ğ’Ñ‹ Ğ¾ÑĞ²Ğ¾Ğ¸Ğ»Ğ¸:**
- ğŸŒ **IP-Ğ°Ğ´Ñ€ĞµÑĞ°Ñ†Ğ¸Ñ** â€” ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ñ‹ Ğ² ĞºĞ¸Ğ±ĞµÑ€Ğ¿Ñ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ÑÑ‚Ğ²Ğµ
- ğŸ”Œ **Ğ¡Ğ¾ĞºĞµÑ‚Ñ‹** â€” Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ»ÑĞ±Ğ¾Ğ¼Ñƒ ÑĞµÑ€Ğ²ĞµÑ€Ñƒ
- ğŸ“¡ **Packet sniffing** â€” Ğ²Ğ¸Ğ´Ğ¸Ñ‚Ğµ Ğ²ÑÑ‘, Ñ‡Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² ÑĞµÑ‚Ğ¸
- ğŸ” **Session reconstruction** â€” Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚Ğµ Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½Ñƒ ĞºĞ¾Ğ¼Ğ¼ÑƒĞ½Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸

**ĞÑ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ñ‹:**
- `net_analyzer` â€” Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ‚Ğ¾Ñ€ IP-Ğ°Ğ´Ñ€ĞµÑĞ¾Ğ²
- `moonlight_client` â€” TCP ĞºĞ»Ğ¸ĞµĞ½Ñ‚
- `packet_sniffer` â€” Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‡Ğ¸Ğº Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²
- `comm_interceptor` â€” ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ°

### ğŸ–ï¸ Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ½Ğ°Ğ²Ñ‹Ğº Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½:
**"Network Wizard"** â€” Ğ’Ñ‹ Ğ²Ğ»Ğ°Ğ´ĞµĞµÑ‚Ğµ ÑĞµÑ‚ÑĞ¼Ğ¸ Ğ½Ğ° Ğ²ÑĞµÑ… ÑƒÑ€Ğ¾Ğ²Ğ½ÑÑ…: Ğ¾Ñ‚ IP Ğ´Ğ¾ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹.

---

## ğŸ¥š Easter Eggs

<details>
<summary>ğŸ” ĞÑ‚ÑÑ‹Ğ»ĞºĞ¸ Ğ¸ ÑĞµĞºÑ€ĞµÑ‚Ñ‹</summary>

1. **TCP Session Reconstruction** â€” ÑĞ´Ñ€Ğ¾ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ "Follow TCP Stream" Ğ² Wireshark
2. **Port 4433** â€” Ğ°Ğ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ HTTPS Ğ¿Ğ¾Ñ€Ñ‚ (4+4=8, 3+3=6 â†’ 86 â†’ HTTP Security)
3. **10.0.0.1** â€” ĞºĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ´Ñ€ĞµÑ Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½ĞµĞ³Ğ¾ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ‚Ğ¾Ñ€Ğ°
4. **Sequence numbers** â€” Ğ¸Ğ·Ğ¾Ğ±Ñ€ĞµÑ‚ĞµĞ½Ñ‹ Ğ² 1974 Ğ³Ğ¾Ğ´Ñƒ Ğ´Ğ»Ñ TCP (Vint Cerf, Bob Kahn)
5. **XOR ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ** â€” Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ»Ğ¾ÑÑŒ Ğ² RC4 (Ğ¾Ğ´Ğ¸Ğ½ Ğ¸Ğ· ÑĞ°Ğ¼Ñ‹Ñ… Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ñ… stream ciphers)
6. **FIN flag** â€” graceful shutdown (ÑĞ»ĞµĞ³Ğ°Ğ½Ñ‚Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ), Ğ² Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¾Ñ‚ RST (abort)
7. **V.'s timestamp 06:47** â€” 0x0647 hex, Ğ¾Ñ‚ÑÑ‹Ğ»ĞºĞ° Ğº RFC 647 (early network protocols)
8. **KEY:0x42** â€” ÑĞ½Ğ¾Ğ²Ğ° 0x42 (Answer to Everything Ğ¸Ğ· Hitchhiker's Guide)

**Ğ¤Ğ¸Ğ»Ğ¾ÑĞ¾Ñ„Ğ¸Ñ Season 3**: *"Ğ¡ĞµÑ‚ÑŒ â€” ÑÑ‚Ğ¾ Ñ‚ĞºĞ°Ğ½ÑŒ. ĞŸĞ°ĞºĞµÑ‚Ñ‹ â€” Ğ½Ğ¸Ñ‚Ğ¸. ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ñ‹ â€” ÑƒĞ·Ğ¾Ñ€Ñ‹. Ğ¢Ñ‹ Ğ½Ğ°ÑƒÑ‡Ğ¸Ğ»ÑÑ Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ²ÑÑ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½Ñƒ Ñ†ĞµĞ»Ğ¸ĞºĞ¾Ğ¼."*

</details>

---

## ğŸ“ Ğ§Ñ‚Ğ¾ Ğ´Ğ°Ğ»ÑŒÑˆĞµ?

**Season 4: Crypto & Algorithms** Ğ¶Ğ´Ñ‘Ñ‚ Ğ²Ğ°Ñ!

Ğ¢Ğ°Ğ¼ Ğ²Ñ‹ Ğ¸Ğ·ÑƒÑ‡Ğ¸Ñ‚Ğµ:
- Ğ¡Ğ¸Ğ¼Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡Ğ½Ğ¾Ğµ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (AES, ChaCha20)
- Ğ¥ÑÑˆ-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ (SHA-256, MD5)
- Blockchain Ğ¸ Merkle trees
- ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸ (QuickSort, MergeSort)
- Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Ğ´ĞµÑ€ĞµĞ²ÑŒÑ, Ğ³Ñ€Ğ°Ñ„Ñ‹, hash tables)

**Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ°ĞµÑ‚. ĞĞ¾ Ğ²Ñ‹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹.** ğŸš€

---

## ğŸ”— ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ

- [â† Episode 11: Packet Analysis](../episode-11-packet-analysis/README.md)
- [â†’ Season 4: Crypto & Algorithms](../../season-4-crypto-and-algorithms/README.md)
- [ğŸ“‹ Season 3: Networks](../README.md)
- [ğŸ  Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°](../../README.md)

---

> *"You've mastered the network. Now master the code within. Season 4 awaits."* â€” V.