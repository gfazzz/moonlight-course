# Season 3: Season Project â€” network_interceptor

> *"Ğ¡Ğ¾Ğ±ĞµÑ€Ğ¸ ÑĞ²Ğ¾Ğ¹ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ ÑĞµÑ‚ĞµĞ²Ğ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¸Ğ· ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ² Ğ¼Ğ¸ÑÑĞ¸Ğ¹"*

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            SEASON PROJECT - NETWORK INTERCEPTOR          â•‘
â•‘                  OPERATION MOONLIGHT                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                          â•‘
â•‘  Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡:    ğŸ¯ FINAL MISSION                             â•‘
â•‘  Ğ¡Ğ›ĞĞ–ĞĞĞ¡Ğ¢Ğ¬: ğŸ”´ğŸ”´ğŸ”´ğŸ”´ Very Hard                            â•‘
â•‘  Ğ’Ğ Ğ•ĞœĞ¯:     ~3-5 Ñ‡Ğ°ÑĞ¾Ğ²                                   â•‘
â•‘  Ğ¦Ğ•Ğ›Ğ¬:      Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ network interceptor    â•‘
â•‘                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ¬ BRIEFING ĞĞ¢ VIKTOR

**Ğ”Ğ°Ñ‚Ğ°:** ĞŸÑÑ‚Ğ½Ğ¸Ñ†Ğ°, 3 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ  
**Ğ’Ñ€ĞµĞ¼Ñ:** 08:05  
**ĞœĞµÑÑ‚Ğ¾:** ĞœĞµÑ‚Ñ€Ğ¾ "ĞÑ…Ğ¾Ñ‚Ğ½Ñ‹Ğ¹ Ñ€ÑĞ´", Ğ¿Ğ¾ÑĞ»Ğµ ÑĞ²Ğ°ĞºÑƒĞ°Ñ†Ğ¸Ğ¸

ĞŸĞ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ¹ Ğ²ÑÑ‚Ñ€ĞµÑ‡Ğ¸ Ğ½Ğ° ĞšÑ€Ğ°ÑĞ½Ğ¾Ğ¹ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´Ğ¸ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ USB "S4: CRYPTO & ALGORITHMS", Ğ²Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚Ğµ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ Viktor Ñ‡ĞµÑ€ĞµĞ· Signal:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ĞĞ¢: Viktor Petrov                                        â•‘
â•‘  Ğ¢Ğ•ĞœĞ: Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ Season 3                        â•‘
â•‘  ĞŸĞ Ğ˜ĞĞ Ğ˜Ğ¢Ğ•Ğ¢: â­â­â­â­â­ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ™                          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘  "Morpheus. Ğ¢Ñ‹ Ğ² Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸. ĞšÑ€Ñ‹Ğ»Ğ¾Ğ² Ğ¾Ñ‚Ğ²Ğ»ĞµÑ‡Ñ‘Ğ½ Ghost'Ğ¾Ğ¼. â•‘
â•‘                                                           â•‘
â•‘   Ğ¢Ñ‹ Ğ¿Ñ€Ğ¾ÑˆÑ‘Ğ» Season 3. Ğ§ĞµÑ‚Ñ‹Ñ€Ğµ Ğ¼Ğ¸ÑÑĞ¸Ğ¸:                     â•‘
â•‘   - Episode 09: IP-Ğ°Ğ´Ñ€ĞµÑĞ°Ñ†Ğ¸Ñ Ğ¸ GPS (203.0.113.42)        â•‘
â•‘   - Episode 10: TCP ÑĞ¾ĞºĞµÑ‚Ñ‹ Ğ¿Ğ¾Ğ´ DDoS-Ğ°Ñ‚Ğ°ĞºĞ¾Ğ¹               â•‘
â•‘   - Episode 11: Packet sniffing (safe house Ñ€Ğ°ÑĞºÑ€Ñ‹Ñ‚!)    â•‘
â•‘   - Episode 12: Session reconstruction + Ğ²ÑÑ‚Ñ€ĞµÑ‡Ğ° ÑĞ¾ Ğ¼Ğ½Ğ¾Ğ¹  â•‘
â•‘                                                           â•‘
â•‘   Ğ¢Ñ‹ Ğ¾ÑĞ²Ğ¾Ğ¸Ğ» ÑĞµÑ‚Ğ¸. Ğ¢ĞµĞ¿ĞµÑ€ÑŒ â€” Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½:            â•‘
â•‘   Ğ¡Ğ¾Ğ±ĞµÑ€Ğ¸ Ğ’Ğ¡Ğ• ÑĞ²Ğ¾Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ² Ğ•Ğ”Ğ˜ĞĞ£Ğ® Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ£.          â•‘
â•‘                                                           â•‘
â•‘   network_interceptor â€” ÑÑ‚Ğ¾ ĞĞ• Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ ÑƒÑ‡ĞµĞ±Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚.    â•‘
â•‘   Ğ­Ñ‚Ğ¾ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜ Ğ’ĞĞ–ĞĞ«Ğ™ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹:         â•‘
â•‘   - Season 5: Financial (Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· HFT Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°)             â•‘
â•‘   - Season 6: Embedded/IoT (Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ Ğ´Ñ€Ğ¾Ğ½Ğ¾Ğ²)      â•‘
â•‘   - Season 7: System (Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ stealth Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹)       â•‘
â•‘   - Season 10: Ğ¤Ğ˜ĞĞĞ› (satellite tracking + intercept)    â•‘
â•‘                                                           â•‘
â•‘   Ğ¢Ğ²Ğ¾Ğ¹ ĞºĞ¾Ğ´ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ:                                  â•‘
â•‘   âœ… ĞœĞ¾Ğ´ÑƒĞ»ÑŒĞ½Ñ‹Ğ¼ (4 ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ° = 4 Ğ¿Ğ°Ñ€Ñ‹ .h/.c)             â•‘
â•‘   âœ… ĞŸĞµÑ€ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğ¼ (#include Ğ² Ğ±ÑƒĞ´ÑƒÑ‰Ğ¸Ñ… ÑĞµĞ·Ğ¾Ğ½Ğ°Ñ…)       â•‘
â•‘   âœ… Ğ§Ğ¸ÑÑ‚Ñ‹Ğ¼ (valgrind/leaks Ğ±ĞµĞ· Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº)                  â•‘
â•‘   âœ… ĞŸÑ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼ (production-ready code)            â•‘
â•‘                                                           â•‘
â•‘   Ğ’Ñ€ĞµĞ¼Ñ Ğ½Ğ° Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ: 3-5 Ñ‡Ğ°ÑĞ¾Ğ².                        â•‘
â•‘                                                           â•‘
â•‘   Ğ•ÑĞ»Ğ¸ ÑĞ¿Ñ€Ğ°Ğ²Ğ¸ÑˆÑŒÑÑ â€” Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ÑˆÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Season 4.          â•‘
â•‘   USB "CRYPTO & ALGORITHMS" Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ÑÑ.              â•‘
â•‘                                                           â•‘
â•‘   Ğ£Ğ´Ğ°Ñ‡Ğ¸, Ğ°Ğ³ĞµĞ½Ñ‚. ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ²ĞµÑ€Ğ¸Ñ‚ Ğ² Ñ‚ĞµĞ±Ñ.                    â•‘
â•‘                                                           â•‘
â•‘   Ghost (ĞĞ»ĞµĞºÑ), Ğ”Ğ¼Ğ¸Ñ‚Ñ€Ğ¸Ğ¹, ĞĞ½Ğ½Ğ° â€” Ğ²ÑĞµ Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ğ»Ğ¸.           â•‘
â•‘   Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ñ‚Ğ²Ğ¾Ñ Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ ÑĞ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚.      â•‘
â•‘                                                           â•‘
â•‘                                              â€” Viktor"    â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ¯ Ğ—ĞĞ”ĞĞĞ˜Ğ•

### Ğ¦ĞµĞ»ÑŒ
Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ **network_interceptor** â€” ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ ÑĞµÑ‚ĞµĞ²Ğ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹:

1. âœ… **ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ IP Ğ°Ğ´Ñ€ĞµÑĞ°** â€” Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° Ğ½Ğ°Ğ´ inet_pton/inet_ntop
2. âœ… **Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ TCP ÑĞ¾ĞºĞµÑ‚Ğ°Ğ¼Ğ¸** â€” Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° Ğ½Ğ°Ğ´ socket/connect/send/recv
3. âœ… **ĞŸĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹** â€” raw sockets + parsing (IP/TCP headers)
4. âœ… **Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ TCP ÑĞµÑÑĞ¸Ğ¸** â€” ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ SEQ + stream reassembly
5. âœ… **ĞŸÑ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ĞµĞ½** â€” Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒĞ½Ñ‹Ğ¹ ĞºĞ¾Ğ´, error handling, Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
Ğ¢Ñ‹ Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑˆÑŒ ĞºĞ¾Ğ´ Ğ¸Ğ· ÑĞ²Ğ¾Ğ¸Ñ… Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹ Episodes 09-12 Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ñ‘ÑˆÑŒ 4 Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ:

```
Episode 09: Network Basics
   â†“
ip_tools.c / ip_tools.h
   - inet_pton_safe() â€” ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ IP (Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº)
   - inet_ntop_safe() â€” Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ
   - ip_to_gps() â€” Ğ´ĞµĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚ (ĞºĞ°Ğº Ğ² Episode 09!)
   - validate_ip() â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸ IP

Episode 10: Socket Programming
   â†“
tcp_client.c / tcp_client.h
   - tcp_connect() â€” Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° socket() + connect()
   - tcp_send_safe() â€” Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° send() Ñ retry
   - tcp_recv_safe() â€” Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° recv() Ñ timeout
   - tcp_close() â€” graceful shutdown
   - challenge_response() â€” Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ auth Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ°

Episode 11: Packet Analysis
   â†“
packet_sniffer.c / packet_sniffer.h
   - create_raw_socket() â€” SOCK_RAW + promiscuous mode
   - capture_packet() â€” recvfrom() + parsing
   - parse_ip_header() â€” Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ IP Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
   - parse_tcp_header() â€” Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ TCP Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
   - extract_payload() â€” Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾ÑĞ»Ğµ headers
   - hex_dump() â€” Ğ²Ñ‹Ğ²Ğ¾Ğ´ Ğ² HEX + ASCII

Episode 12: Encrypted Communications
   â†“
session_reconstructor.c / session_reconstructor.h
   - packet_sorter() â€” ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ SEQ
   - detect_gaps() â€” Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ¾Ğ²
   - reassemble_stream() â€” ÑĞ±Ğ¾Ñ€ĞºĞ° Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
   - xor_decrypt() â€” Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²ĞºĞ° XOR (Ğ¸Ğ· Season 1!)
   - extract_key() â€” Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ»ÑÑ‡Ğ° Ğ¸Ğ· Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ°ĞºĞµÑ‚Ğ°
```

### Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚: network_interceptor

```c
// Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° (ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ²ÑĞµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸):

#include "ip_tools.h"
#include "tcp_client.h"
#include "packet_sniffer.h"
#include "session_reconstructor.h"

int main(int argc, char *argv[]) {
    // 1. ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ IP (Episode 09)
    uint32_t ip = ip_string_to_int("203.0.113.42");
    
    // 2. Ğ”ĞµĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ GPS (Episode 09)
    double lat, lon;
    ip_to_gps(ip, &lat, &lon);
    
    // 3. TCP Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ (Episode 10)
    int sockfd = tcp_connect("203.0.113.42", 31337);
    
    // 4. Challenge-Response auth (Episode 10)
    challenge_response(sockfd, "MOONLIGHT2024");
    
    // 5. Packet sniffing (Episode 11)
    int raw_fd = create_raw_socket(9999);  // Port Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ² Z.
    
    Packet packets[100];
    int count = 0;
    
    while (count < 8) {
        capture_packet(raw_fd, &packets[count]);
        count++;
    }
    
    // 6. Session reconstruction (Episode 12)
    packet_sorter(packets, count);
    detect_gaps(packets, count);
    
    char stream[10000];
    int stream_len = reassemble_stream(packets, count, stream);
    
    // 7. XOR decryption (Episode 01 + 12!)
    uint8_t key = extract_key(stream);
    xor_decrypt(stream, stream_len, key);
    
    printf("DECRYPTED: %s\n", stream);
    
    return 0;
}
```

---

## ğŸ“‹ Ğ¡Ğ¢Ğ Ğ£ĞšĞ¢Ğ£Ğ Ğ ĞŸĞ ĞĞ•ĞšĞ¢Ğ

```
season-3-networks/
â”œâ”€â”€ season_project_mission.md    â† Ğ­Ñ‚Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
â”œâ”€â”€ season_project_starter.c     â† Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½ Ñ TODO
â”œâ”€â”€ Makefile                      â† ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° ÑĞ±Ğ¾Ñ€ĞºĞ¸ (Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»Ñ‘Ğ½!)
â”‚
â””â”€â”€ season-project/               â† Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚ ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ ÑÑ‚Ñƒ Ğ¿Ğ°Ğ¿ĞºÑƒ!
    â”œâ”€â”€ ip_tools.h
    â”œâ”€â”€ ip_tools.c
    â”œâ”€â”€ tcp_client.h
    â”œâ”€â”€ tcp_client.c
    â”œâ”€â”€ packet_sniffer.h
    â”œâ”€â”€ packet_sniffer.c
    â”œâ”€â”€ session_reconstructor.h
    â”œâ”€â”€ session_reconstructor.c
    â””â”€â”€ network_interceptor.c     â† Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°
```

**ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ ĞĞºĞºĞ°Ğ¼Ğ°:** ĞĞ• ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ¸Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½ÑƒÑ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ! `season-project/` ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹.

---

## ğŸ”§ ĞŸĞĞ¨ĞĞ“ĞĞ’ĞĞ¯ Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞšĞ¦Ğ˜Ğ¯

### Ğ¨ĞĞ“ 1: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ

```bash
cd season-3-networks/
mkdir season-project
cd season-project
```

### Ğ¨ĞĞ“ 2: Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ¸Ğ· Episodes

**Ğ˜Ğ· Episode 09 (ip_converter.c):**
```bash
# Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ğ¸ IP
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ip_tools.h + ip_tools.c
```

**Ğ˜Ğ· Episode 10 (moonlight_client):**
```bash
# Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ TCP socket ĞºĞ¾Ğ´
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ tcp_client.h + tcp_client.c
```

**Ğ˜Ğ· Episode 11 (packet_sniffer):**
```bash
# Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ raw socket + parsing
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ packet_sniffer.h + packet_sniffer.c
```

**Ğ˜Ğ· Episode 12 (comm_interceptor):**
```bash
# Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ session reconstruction
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ session_reconstructor.h + session_reconstructor.c
```

### Ğ¨ĞĞ“ 3: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ .h Ñ„Ğ°Ğ¹Ğ»Ñ‹ (headers)

**ip_tools.h:**
```c
#ifndef IP_TOOLS_H
#define IP_TOOLS_H

#include <stdint.h>
#include <arpa/inet.h>

// ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ IP string â†’ uint32_t
uint32_t ip_string_to_int(const char *ip_str);

// ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ uint32_t â†’ GPS ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ñ‹
void ip_to_gps(uint32_t ip, double *lat, double *lon);

// Safe Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ¸
int inet_pton_safe(const char *ip_str, struct in_addr *addr);
int inet_ntop_safe(struct in_addr *addr, char *buf, size_t len);

#endif
```

**tcp_client.h:**
```c
#ifndef TCP_CLIENT_H
#define TCP_CLIENT_H

#include <stdint.h>

// TCP ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ
int tcp_connect(const char *host, uint16_t port);

// ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ°/Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ
int tcp_send_safe(int sockfd, const void *buf, size_t len);
int tcp_recv_safe(int sockfd, void *buf, size_t len, int timeout_sec);

// Challenge-Response
int challenge_response(int sockfd, const char *key);

// Graceful close
void tcp_close(int sockfd);

#endif
```

**packet_sniffer.h:**
```c
#ifndef PACKET_SNIFFER_H
#define PACKET_SNIFFER_H

#include <stdint.h>
#include <netinet/ip.h>
#include <netinet/tcp.h>

typedef struct {
    uint32_t src_ip;
    uint32_t dst_ip;
    uint16_t src_port;
    uint16_t dst_port;
    uint32_t seq;
    uint16_t payload_len;
    unsigned char payload[1500];
} Packet;

// Raw socket
int create_raw_socket(uint16_t filter_port);

// Capture
int capture_packet(int raw_fd, Packet *pkt);

// Parsing
int parse_ip_header(unsigned char *buffer, struct iphdr **ip);
int parse_tcp_header(unsigned char *buffer, int ip_len, struct tcphdr **tcp);
int extract_payload(unsigned char *buffer, int ip_len, int tcp_len, 
                    unsigned char **payload, int *payload_len);

// Hex dump
void hex_dump(unsigned char *data, int len);

#endif
```

**session_reconstructor.h:**
```c
#ifndef SESSION_RECONSTRUCTOR_H
#define SESSION_RECONSTRUCTOR_H

#include "packet_sniffer.h"

// Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°
void packet_sorter(Packet *packets, int count);

// Gap detection
int detect_gaps(Packet *packets, int count);

// Stream reassembly
int reassemble_stream(Packet *packets, int count, char *stream);

// XOR decryption (Ğ¸Ğ· Season 1!)
void xor_decrypt(unsigned char *data, int len, uint8_t key);

// Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ»ÑÑ‡Ğ°
uint8_t extract_key(const char *stream);

#endif
```

### Ğ¨ĞĞ“ 4: Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ .c Ñ„Ğ°Ğ¹Ğ»Ñ‹

Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµÑ‚ ĞºĞ¾Ğ´ Ğ¸Ğ· ÑĞ²Ğ¾Ğ¸Ñ… Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹ Episodes 09-12 Ğ¸ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ´ API Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹.

### Ğ¨ĞĞ“ 5: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ³Ğ»Ğ°Ğ²Ğ½ÑƒÑ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñƒ

**network_interceptor.c:**
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "ip_tools.h"
#include "tcp_client.h"
#include "packet_sniffer.h"
#include "session_reconstructor.h"

int main(int argc, char *argv[]) {
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘    NETWORK INTERCEPTOR v1.0               â•‘\n");
    printf("â•‘    Operation MOONLIGHT - Season 3         â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n");
    
    // TODO: Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹
    // ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:
    // 1. Ğ”ĞµĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ IP â†’ GPS
    // 2. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ñ‡ĞµÑ€ĞµĞ· TCP
    // 3. ĞŸĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ¸Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚Ñ‹
    // 4. Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞµÑÑĞ¸Ñ
    // 5. Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ XOR
    
    return 0;
}
```

### Ğ¨ĞĞ“ 6: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Makefile

```makefile
# Ğ’ ĞºĞ¾Ñ€Ğ½Ğµ season-3-networks/Makefile Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ:

# Season Project
PROJECT_SRC = season-project/ip_tools.c \
              season-project/tcp_client.c \
              season-project/packet_sniffer.c \
              season-project/session_reconstructor.c \
              season-project/network_interceptor.c

season_project: $(PROJECT_SRC)
	$(CC) $(CFLAGS) -o network_interceptor $(PROJECT_SRC)
	@echo "âœ… Season Project: network_interceptor built!"

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² all:
all: episodes season_project
```

### Ğ¨ĞĞ“ 7: ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ Ğ¸ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```bash
cd season-3-networks/
make season_project

# Ğ—Ğ°Ğ¿ÑƒÑĞº:
sudo ./network_interceptor  # ĞÑƒĞ¶ĞµĞ½ root Ğ´Ğ»Ñ raw sockets!

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒÑ‚ĞµÑ‡ĞµĞº:
sudo valgrind --leak-check=full ./network_interceptor
```

---

## âœ… ĞšĞ Ğ˜Ğ¢Ğ•Ğ Ğ˜Ğ˜ Ğ£Ğ¡ĞŸĞ•Ğ¥Ğ

### ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:

1. **ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ Ğ±ĞµĞ· Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº:**
```bash
gcc -Wall -Wextra -Werror *.c -o network_interceptor
# Ğ‘ĞµĞ· warnings!
```

2. **Valgrind Ğ±ĞµĞ· ÑƒÑ‚ĞµÑ‡ĞµĞº:**
```bash
valgrind --leak-check=full ./network_interceptor
# "All heap blocks were freed -- no leaks are possible"
```

3. **ĞœĞ¾Ğ´ÑƒĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:**
   - 4 Ğ¿Ğ°Ñ€Ñ‹ .h/.c Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
   - ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ header Ñ include guards
   - API Ñ‡Ğ¸ÑÑ‚Ñ‹Ğ¹ Ğ¸ Ğ¿Ğ¾Ğ½ÑÑ‚Ğ½Ñ‹Ğ¹

4. **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:**
   - âœ… IP ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
   - âœ… TCP Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾
   - âœ… Packet capture Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (Ñ sudo)
   - âœ… Session reconstruction ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
   - âœ… XOR decryption Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ñ‹Ğ²Ğ°ĞµÑ‚

5. **Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:**
   - ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ Ğ² .h Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…
   - README.md Ğ² season-project/

### Ğ‘Ğ¾Ğ½ÑƒÑÑ‹ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾):

- ğŸŒŸ **GPS Ğ´ĞµĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ** Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (203.0.113.42 â†’ ĞšÑ€Ğ°ÑĞ½Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ)
- ğŸŒŸ **Challenge-Response** Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½ (ĞºĞ°Ğº Ğ² Episode 10)
- ğŸŒŸ **Gap detection** Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ¸
- ğŸŒŸ **Promiscuous mode** Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ (ioctl)
- ğŸŒŸ **Error handling** Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ (errno, perror)
- ğŸŒŸ **CLI Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹** (--help, --host, --port, --filter)

---

## ğŸ“Š ĞĞ¦Ğ•ĞĞšĞ Ğ’Ğ Ğ•ĞœĞ•ĞĞ˜

```
Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ´Ğ°:        1-1.5 Ñ‡Ğ°ÑĞ°
Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ .h/.c:         1-1.5 Ñ‡Ğ°ÑĞ°
Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ:             0.5-1 Ñ‡Ğ°Ñ
Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:           0.5-1 Ñ‡Ğ°Ñ
Debugging + Ğ´Ğ¾Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°:  0.5-1 Ñ‡Ğ°Ñ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ğ˜Ğ¢ĞĞ“Ğ:                  3-5 Ñ‡Ğ°ÑĞ¾Ğ²
```

---

## ğŸ“ Ğ§Ğ¢Ğ Ğ’Ğ« Ğ˜Ğ—Ğ£Ğ§Ğ˜Ğ¢Ğ•

### Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸:
- âœ… **ĞœĞ¾Ğ´ÑƒĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ** â€” Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
- âœ… **API design** â€” Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ¾Ğ²
- âœ… **ĞŸĞµÑ€ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ´Ğ°** â€” Ğ¸Ğ· Episodes â†’ Ğ² Season Project
- âœ… **Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ** â€” ÑĞ±Ğ¾Ñ€ĞºĞ° Ğ¸Ğ· Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹
- âœ… **Professional workflow** â€” ĞºĞ°Ğº Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°Ñ…

### Ğ¡ĞµÑ‚ĞµĞ²Ñ‹Ğµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸:
- âœ… **TCP/IP stack** â€” Ğ¾Ñ‚ IP Ğ´Ğ¾ Application layer
- âœ… **Raw sockets** â€” Ğ½Ğ¸Ğ·ĞºĞ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ¿Ğ°ĞºĞµÑ‚Ğ°Ğ¼
- âœ… **Session reconstruction** â€” Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ TCP Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ²
- âœ… **Network forensics** â€” Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‡ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°

### ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸:
- âœ… **Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¾Ğ¹** â€” Ghost, Ğ”Ğ¼Ğ¸Ñ‚Ñ€Ğ¸Ğ¹, ĞĞ½Ğ½Ğ° Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ğ»Ğ¸
- âœ… **Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²** â€” ĞºĞ°Ğº Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸ÑÑ…
- âœ… **OpSec** â€” Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ ÑĞµÑ‚ĞµĞ²Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹

---

## ğŸ’¡ ĞŸĞĞ”Ğ¡ĞšĞĞ—ĞšĞ˜

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: "ĞĞµ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ ip_tools.c"
```bash
# Ğ£Ğ±ĞµĞ´Ğ¸ÑÑŒ Ñ‡Ñ‚Ğ¾ include guards Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ:
#ifndef IP_TOOLS_H
#define IP_TOOLS_H
...
#endif

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ñ‡Ñ‚Ğ¾ Ğ²ÑĞµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ñ‹ Ğ² .h Ğ¸ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ² .c
```

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: "Raw socket: Permission denied"
```bash
# ĞÑƒĞ¶ĞµĞ½ root!
sudo ./network_interceptor

# Ğ˜Ğ»Ğ¸ Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ° Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğµ:
sudo setcap cap_net_raw+ep ./network_interceptor
./network_interceptor  # Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ±ĞµĞ· sudo
```

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: "Valgrind Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ÑƒÑ‚ĞµÑ‡ĞºĞ¸"
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ñ‡Ñ‚Ğ¾ Ğ²ÑĞµ malloc/calloc Ğ¸Ğ¼ĞµÑÑ‚ free:
valgrind --leak-check=full --show-leak-kinds=all ./network_interceptor

# Ğ§Ğ°ÑÑ‚Ñ‹Ğµ ÑƒÑ‚ĞµÑ‡ĞºĞ¸:
# - Ğ—Ğ°Ğ±Ñ‹Ğ»Ğ¸ close(sockfd)
# - Ğ—Ğ°Ğ±Ñ‹Ğ»Ğ¸ free() Ğ¿Ğ¾ÑĞ»Ğµ malloc
# - ĞĞµ Ğ¾ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ¸Ğ»Ğ¸ Ğ±ÑƒÑ„ĞµÑ€Ñ‹
```

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: "ĞĞµ Ğ¼Ğ¾Ğ³Ñƒ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ ĞºĞ¾Ğ´ Ğ¸Ğ· Episodes"
```bash
# Ğ¡Ğ¼Ğ¾Ñ‚Ñ€Ğ¸ Ğ½Ğ° solution/ Ñ„Ğ°Ğ¹Ğ»Ñ‹:
cat episode-09-network-basics/solution/ip_converter_solution.c
cat episode-10-socket-programming/solution/moonlight_client_solution.c
# Ğ˜ Ñ‚.Ğ´.

# ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹ Ğ½ÑƒĞ¶Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸, Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€ÑƒĞ¹ Ğ¿Ğ¾Ğ´ API
```

---

## ğŸš€ ĞŸĞĞ¡Ğ›Ğ• Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ˜Ğ¯

ĞŸĞ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ¹ ÑĞ±Ğ¾Ñ€ĞºĞ¸ `network_interceptor` Ğ²Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ:

1. **Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Season 4** â€” USB "CRYPTO & ALGORITHMS" Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½
2. **Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰Ğ¸Ñ… ÑĞµĞ·Ğ¾Ğ½Ğ¾Ğ²** â€” Ğ±ÑƒĞ´ĞµÑ‚Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² S5-S10
3. **ĞŸÑ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ğ¿Ñ‹Ñ‚** â€” Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒĞ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ĞºĞ°Ğº Ğ² production
4. **ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ ÑĞµÑ‚ĞµĞ¹** â€” Ğ¾Ñ‚ Ğ±Ğ°Ğ¹Ñ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Ğ´Ğ¾ application layer

**Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ Viktor:**
```
"network_interceptor Ğ³Ğ¾Ñ‚Ğ¾Ğ². 

Season 4 Ğ¶Ğ´Ñ‘Ñ‚ Ñ‚ĞµĞ±Ñ. ĞšÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ, Ñ…ÑÑˆĞ¸, blockchain, Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹.

ĞĞ¾ Ğ¿Ğ¾Ğ¼Ğ½Ğ¸: Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Season 3 Ğ¿Ğ¾Ğ½Ğ°Ğ´Ğ¾Ğ±ÑÑ‚ÑÑ Ğ² Season 5 (Financial),
Season 6 (Embedded/IoT), Season 7 (System Programming).

Ğ¥Ñ€Ğ°Ğ½Ğ¸ ĞºĞ¾Ğ´. Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€ÑƒĞ¹. Ğ£Ğ»ÑƒÑ‡ÑˆĞ°Ğ¹.

Ğ£Ğ´Ğ°Ñ‡Ğ¸ Ğ² Season 4, Ğ°Ğ³ĞµĞ½Ñ‚.

â€” Viktor Petrov"
```

---

## ğŸ“ ĞŸĞĞ”Ğ”Ğ•Ğ Ğ–ĞšĞ ĞšĞĞœĞĞĞ”Ğ«

```
Ghost (ĞĞ»ĞµĞºÑ Ğ¡Ğ¾ĞºĞ¾Ğ»Ğ¾Ğ²):
"Ğ•ÑĞ»Ğ¸ Ğ·Ğ°ÑÑ‚Ñ€ÑĞ½ĞµÑˆÑŒ Ñ raw sockets â€” Ğ¿Ğ¸ÑˆĞ¸. 
 Ğ¯ 12 Ğ»ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ» Ñ Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ğ¾Ğ¼ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ° Ğ² Ğ¤Ğ¡Ğ‘."

Ğ”Ğ¼Ğ¸Ñ‚Ñ€Ğ¸Ğ¹ ĞÑ€Ğ»Ğ¾Ğ²:
"TCP â€” Ğ¼Ğ¾Ñ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (Ğ°Ğ²Ğ¸Ğ¾Ğ½Ğ¸ĞºĞ° ĞÑÑ€Ğ¾Ñ„Ğ»Ğ¾Ñ‚).
 Ğ•ÑĞ»Ğ¸ connect() Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ â€” Ğ¾Ğ±Ñ€Ğ°Ñ‰Ğ°Ğ¹ÑÑ."

ĞĞ½Ğ½Ğ° ĞšĞ¾Ğ²Ğ°Ğ»Ñ‘Ğ²Ğ°:
"Forensics â€” Ğ¼Ğ¾Ñ‘. Ğ•ÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞµÑÑĞ¸Ñ
 Ğ¸Ğ· Ñ„Ñ€Ğ°Ğ³Ğ¼ĞµĞ½Ñ‚Ğ¾Ğ² â€” Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ñƒ Ñ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ¼."

Viktor:
"Ğ¯ Ğ²ĞµÑ€Ñ Ğ² Ñ‚ĞµĞ±Ñ. ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ²ĞµÑ€Ğ¸Ñ‚. Ğ¢Ñ‹ ÑĞ¿Ñ€Ğ°Ğ²Ğ¸ÑˆÑŒÑÑ."
```

---

**Ğ­Ğ¢Ğ Ğ¢Ğ’ĞĞ™ ĞœĞĞœĞ•ĞĞ¢. ĞŸĞĞšĞĞ–Ğ˜ Ğ§Ğ¢Ğ Ğ¢Ğ« Ğ“ĞĞ¢ĞĞ’ Ğš SEASON 4!** ğŸš€

